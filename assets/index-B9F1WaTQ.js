var Dt=Object.defineProperty;var _t=(t,s,r)=>s in t?Dt(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Ae=(t,s,r)=>_t(t,typeof s!="symbol"?s+"":s,r);import{r as c,j as e,R as ve,c as Ot}from"./vendor-react--UE8qFvL.js";import{G as $e,T as xe}from"./vendor-genai-C0GBL7S7.js";import"./vendor-BhE6lIor.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=r(i);fetch(i.href,n)}})();const $t={name:"ISO 9001:2015 (QMS)",description:"Quality Management System",groups:[{id:"PLAN_9001",title:"Plan (4-6) Context & Leadership",icon:"FileShield",clauses:[{id:"4",code:"4",title:"Context of organization",description:"Internal and external issues that affect its ability to achieve intended results.",subClauses:[{id:"4.1",code:"4.1",title:"Understanding the organization",description:"Determining internal and external issues relevant to its purpose."},{id:"4.2",code:"4.2",title:"Interested parties",description:"Understanding the needs and expectations of stakeholders."},{id:"4.3",code:"4.3",title:"Scope of QMS",description:"Determining the boundaries and applicability of the quality system."},{id:"4.4",code:"4.4",title:"QMS processes",description:"Establishing, implementing, and maintaining processes."}]},{id:"5",code:"5",title:"Leadership",description:"Top management commitment, policy and roles.",subClauses:[{id:"5.1",code:"5.1",title:"Leadership commitment",description:"Demonstrating leadership and commitment to customer focus."},{id:"5.2",code:"5.2",title:"Policy",description:"Establishing and communicating the quality policy."},{id:"5.3",code:"5.3",title:"Roles & Authorities",description:"Ensuring responsibilities and authorities are assigned."}]},{id:"6",code:"6",title:"Planning",description:"Risks, opportunities and quality objectives.",subClauses:[{id:"6.1",code:"6.1",title:"Risks & Opportunities",description:"Actions to address risks and opportunities."},{id:"6.2",code:"6.2",title:"Quality objectives",description:"Establishing objectives and planning to achieve them."},{id:"6.3",code:"6.3",title:"Planning of changes",description:"Carrying out changes in a planned manner."}]}]},{id:"SUPPORT_9001",title:"Support (7) Resources",icon:"LayoutList",clauses:[{id:"7.1",code:"7.1",title:"Resources",description:"Providing necessary resources for the QMS.",subClauses:[{id:"7.1.1",code:"7.1.1",title:"General",description:"Determining and providing resources for QMS."},{id:"7.1.2",code:"7.1.2",title:"People",description:"Providing persons necessary for effective implementation."},{id:"7.1.3",code:"7.1.3",title:"Infrastructure",description:"Maintenance of buildings, equipment, and transport."},{id:"7.1.4",code:"7.1.4",title:"Process Environment",description:"Managing social (non-discriminatory), psychological (stress-reducing), and physical (temperature, hygiene) factors."},{id:"7.1.5",code:"7.1.5",title:"Monitoring resources",description:"Calibration and measurement traceability."},{id:"7.1.6",code:"7.1.6",title:"Knowledge",description:"Maintaining organizational knowledge and lessons learned."}]},{id:"7.2",code:"7.2",title:"Competence",description:"Ensuring workers are competent based on education/training."},{id:"7.3",code:"7.3",title:"Awareness",description:"Ensuring persons are aware of quality policy and objectives."},{id:"7.4",code:"7.4",title:"Communication",description:"Determining internal and external communications."},{id:"7.5",code:"7.5",title:"Documented info",description:"Control of information required by the standard.",subClauses:[{id:"7.5.1",code:"7.5.1",title:"General",description:"Determining necessary documented information for QMS."},{id:"7.5.2",code:"7.5.2",title:"Creating & Updating",description:"Ensuring proper identification, format, and review."},{id:"7.5.3",code:"7.5.3",title:"Control of info",description:"Ensuring availability, protection, and storage control.",subClauses:[{id:"7.5.3.1",code:"7.5.3.1",title:"Availability",description:"Ensuring info is available where needed."},{id:"7.5.3.2",code:"7.5.3.2",title:"Control",description:"Distribution, access, retrieval and use."}]}]}]},{id:"DO_9001",title:"Do (8) Operation",icon:"Cpu",clauses:[{id:"8.1",code:"8.1",title:"Operational planning",description:"Control of processes to meet P/S requirements."},{id:"8.2",code:"8.2",title:"Requirements for P/S",description:"Determining requirements and communicating with customers."},{id:"8.3",code:"8.3",title:"Design and development",description:"D&D of products and services.",subClauses:[{id:"8.3.1",code:"8.3.1",title:"General",description:"Establishing a D&D process."},{id:"8.3.2",code:"8.3.2",title:"Planning",description:"Determining D&D stages and controls."},{id:"8.3.3",code:"8.3.3",title:"Inputs",description:"Requirements essential for D&D."},{id:"8.3.4",code:"8.3.4",title:"Controls",description:"Ensuring reviews, verification, and validation."},{id:"8.3.5",code:"8.3.5",title:"Outputs",description:"Meeting input requirements."},{id:"8.3.6",code:"8.3.6",title:"Changes",description:"Controlling modifications to D&D."}]},{id:"8.4",code:"8.4",title:"External Providers",description:"Control of externally provided P/S.",subClauses:[{id:"8.4.1",code:"8.4.1",title:"General",description:"Evaluating and selecting external providers."},{id:"8.4.2",code:"8.4.2",title:"Type & Extent",description:"Controlling the impact of providers on results."},{id:"8.4.3",code:"8.4.3",title:"Information",description:"Communicating requirements to providers clearly."}]},{id:"8.5",code:"8.5",title:"Production & Delivery",description:"Control of production and service provision.",subClauses:[{id:"8.5.1",code:"8.5.1",title:"Control",description:"Availability of info, equipment and monitoring."},{id:"8.5.2",code:"8.5.2",title:"Identification",description:"Ensuring traceability throughout provision."},{id:"8.5.3",code:"8.5.3",title:"Property",description:"Safeguarding customer or provider assets."},{id:"8.5.4",code:"8.5.4",title:"Preservation",description:"Ensuring conformity during processing."},{id:"8.5.5",code:"8.5.5",title:"Post-delivery",description:"Statutory, regulatory, and warranty duties."},{id:"8.5.6",code:"8.5.6",title:"Control of changes",description:"Reviewing and controlling changes for production."}]},{id:"8.6",code:"8.6",title:"Release of P/S",description:"Verification that requirements have been met."},{id:"8.7",code:"8.7",title:"Nonconforming outputs",description:"Ensuring unintended use is prevented."}]},{id:"CHECK_ACT_9001",title:"Check & Act (9-10)",icon:"CheckThick",clauses:[{id:"9.1",code:"9.1",title:"Monitoring & Evaluation",description:"Determining what needs to be monitored."},{id:"9.2",code:"9.2",title:"Internal audit",description:"Scheduled review of QMS performance."},{id:"9.3",code:"9.3",title:"Management review",description:"Top management review of system suitability."},{id:"10.1",code:"10.1",title:"Improvement",description:"Determining opportunities for improvement."},{id:"10.2",code:"10.2",title:"NC & Corrective action",description:"Managing nonconformities and root causes."},{id:"10.3",code:"10.3",title:"Continual improvement",description:"Continually improving QMS effectiveness."}]}]},zt={name:"ISO/IEC 27001:2022 (ISMS)",description:"Information Security Management System",groups:[{id:"PLAN_27001",title:"Plan (4-6) Context & Leadership",icon:"FileShield",clauses:[{id:"4",code:"4",title:"Context of organization",description:"Internal/external issues and scope.",subClauses:[{id:"4.1",code:"4.1",title:"Context",description:"Identifying security issues."},{id:"4.2",code:"4.2",title:"Interested parties",description:"Needs and expectations."},{id:"4.3",code:"4.3",title:"Scope",description:"Determining ISMS boundaries."},{id:"4.4",code:"4.4",title:"ISMS System",description:"Establishing processes."}]},{id:"5",code:"5",title:"Leadership",description:"Commitment and Policy.",subClauses:[{id:"5.1",code:"5.1",title:"Leadership & Commitment",description:"Accountability."},{id:"5.2",code:"5.2",title:"Policy",description:"InfoSec policy."},{id:"5.3",code:"5.3",title:"Roles & Authorities",description:"Assigning responsibilities."}]},{id:"6",code:"6",title:"Planning",description:"Risk treatment.",subClauses:[{id:"6.1.1",code:"6.1.1",title:"General",description:"Risk actions."},{id:"6.1.2",code:"6.1.2",title:"Risk assessment",description:"Information security risk process."},{id:"6.1.3",code:"6.1.3",title:"Risk treatment",description:"SoA and planning."},{id:"6.2",code:"6.2",title:"Security objectives",description:"Achievement planning."}]}]},{id:"SUPPORT_27001",title:"Support (7) Resources",icon:"LayoutList",clauses:[{id:"7.1",code:"7.1",title:"Resources",description:"Availability."},{id:"7.2",code:"7.2",title:"Competence",description:"Training requirements."},{id:"7.3",code:"7.3",title:"Awareness",description:"Understanding policy."},{id:"7.4",code:"7.4",title:"Communication",description:"Info flow rules."},{id:"7.5",code:"7.5",title:"Documented info",description:"Control of records."}]},{id:"DO_27001",title:"Do (8) Operation",icon:"Cpu",clauses:[{id:"8.1",code:"8.1",title:"Operational planning",description:"Securing processes."},{id:"8.2",code:"8.2",title:"Risk assessment",description:"Execution at intervals."},{id:"8.3",code:"8.3",title:"Risk treatment",description:"Implementing treatments."}]},{id:"CHECK_ACT_27001",title:"Check & Act (9-10)",icon:"CheckThick",clauses:[{id:"9.1",code:"9.1",title:"Monitoring",description:"Measuring effectiveness."},{id:"9.2",code:"9.2",title:"Internal audit",description:"Periodic checks."},{id:"9.3",code:"9.3",title:"Management review",description:"Strategic eval."},{id:"10.1",code:"10.1",title:"Continual improvement",description:"Growth."},{id:"10.2",code:"10.2",title:"Nonconformity",description:"Corrective actions."}]},{id:"ANNEX_A_5",title:"Annex A.5 Organizational (37 Controls)",icon:"Lock",clauses:[{id:"A.5.1",code:"A.5.1",title:"Policies for information security",description:"Reviewed for suitability."},{id:"A.5.2",code:"A.5.2",title:"InfoSec roles",description:"Defined responsibilities."},{id:"A.5.3",code:"A.5.3",title:"Segregation of duties",description:"Conflict reduction."},{id:"A.5.4",code:"A.5.4",title:"Management responsibilities",description:"Committing to security."},{id:"A.5.5",code:"A.5.5",title:"Contact with authorities",description:"Regulation flow."},{id:"A.5.6",code:"A.5.6",title:"Special interest groups",description:"Trend tracking."},{id:"A.5.7",code:"A.5.7",title:"Threat intelligence",description:"Info collection."},{id:"A.5.8",code:"A.5.8",title:"IS in project mgmt",description:"Lifecycle inclusion."},{id:"A.5.9",code:"A.5.9",title:"Inventory of assets",description:"Critical asset list."},{id:"A.5.10",code:"A.5.10",title:"Acceptable use of assets",description:"Usage rules."},{id:"A.5.11",code:"A.5.11",title:"Return of assets",description:"Termination retrieval."},{id:"A.5.12",code:"A.5.12",title:"Classification of info",description:"Labeling based on value."},{id:"A.5.13",code:"A.5.13",title:"Labeling of info",description:"Visual markers."},{id:"A.5.14",code:"A.5.14",title:"Information transfer",description:"Securing transit."},{id:"A.5.15",code:"A.5.15",title:"Access control",description:"Authorization rules."},{id:"A.5.16",code:"A.5.16",title:"Identity management",description:"User ID lifecycle."},{id:"A.5.17",code:"A.5.17",title:"Authentication info",description:"Secrets management."},{id:"A.5.18",code:"A.5.18",title:"Access rights",description:"Provisioning/revoking."},{id:"A.5.19",code:"A.5.19",title:"IS in supplier relationships",description:"Agreements."},{id:"A.5.20",code:"A.5.20",title:"Supplier agreements",description:"Addressing security."},{id:"A.5.21",code:"A.5.21",title:"ICT supply chain",description:"Sourcing risks."},{id:"A.5.22",code:"A.5.22",title:"Monitoring suppliers",description:"Auditing delivery."},{id:"A.5.23",code:"A.5.23",title:"Cloud services",description:"SaaS security."},{id:"A.5.24",code:"A.5.24",title:"Incident management",description:"Planning response."},{id:"A.5.25",code:"A.5.25",title:"Incident assessment",description:"Severity eval."},{id:"A.5.26",code:"A.5.26",title:"Incident response",description:"Action taken."},{id:"A.5.27",code:"A.5.27",title:"Incident learning",description:"Root cause."},{id:"A.5.28",code:"A.5.28",title:"Evidence collection",description:"Forensics."},{id:"A.5.29",code:"A.5.29",title:"IS during disruption",description:"BCP security."},{id:"A.5.30",code:"A.5.30",title:"ICT readiness",description:"DR planning."},{id:"A.5.31",code:"A.5.31",title:"Legal compliance",description:"Regulatory requirements."},{id:"A.5.32",code:"A.5.32",title:"IP Rights",description:"Copyright protection."},{id:"A.5.33",code:"A.5.33",title:"Protection of records",description:"Integrity."},{id:"A.5.34",code:"A.5.34",title:"Privacy of PII",description:"GDPR/Data protection."},{id:"A.5.35",code:"A.5.35",title:"Independent review",description:"External auditing."},{id:"A.5.36",code:"A.5.36",title:"Policy compliance",description:"Adherence."},{id:"A.5.37",code:"A.5.37",title:"Operating procedures",description:"Standard documentation."}]},{id:"ANNEX_A_6",title:"Annex A.6 People (8 Controls)",icon:"Users",clauses:[{id:"A.6.1",code:"A.6.1",title:"Screening",description:"Background checks."},{id:"A.6.2",code:"A.6.2",title:"Terms of employment",description:"HR contracts."},{id:"A.6.3",code:"A.6.3",title:"Awareness",description:"InfoSec education."},{id:"A.6.4",code:"A.6.4",title:"Disciplinary process",description:"Breach handling."},{id:"A.6.5",code:"A.6.5",title:"Termination responsibilities",description:"Post-exit."},{id:"A.6.6",code:"A.6.6",title:"Confidentiality",description:"NDAs."},{id:"A.6.7",code:"A.6.7",title:"Remote working",description:"Teleworking rules."},{id:"A.6.8",code:"A.6.8",title:"Event reporting",description:"Anomaly reporting."}]},{id:"ANNEX_A_7",title:"Annex A.7 Physical (14 Controls)",icon:"Building",clauses:[{id:"A.7.1",code:"A.7.1",title:"Physical perimeters",description:"Barriers."},{id:"A.7.2",code:"A.7.2",title:"Physical entry",description:"Access systems."},{id:"A.7.3",code:"A.7.3",title:"Securing offices",description:"Locks."},{id:"A.7.4",code:"A.7.4",title:"Security monitoring",description:"CCTV."},{id:"A.7.5",code:"A.7.5",title:"Physical protection",description:"Disaster proofing."},{id:"A.7.6",code:"A.7.6",title:"Secure areas",description:"Restricted protocols."},{id:"A.7.7",code:"A.7.7",title:"Clear desk/screen",description:"Clean policy."},{id:"A.7.8",code:"A.7.8",title:"Equipment siting",description:"Safe placement."},{id:"A.7.9",code:"A.7.9",title:"Assets off-premises",description:"Mobile security."},{id:"A.7.10",code:"A.7.10",title:"Storage media",description:"Drive handling."},{id:"A.7.11",code:"A.7.11",title:"Utilities",description:"Power/Water safety."},{id:"A.7.12",code:"A.7.12",title:"Cabling security",description:"Line protection."},{id:"A.7.13",code:"A.7.13",title:"Equipment maintenance",description:"Care logs."},{id:"A.7.14",code:"A.7.14",title:"Secure disposal",description:"Data wiping."}]},{id:"ANNEX_A_8",title:"Annex A.8 Technological (34 Controls)",icon:"Cpu",clauses:[{id:"A.8.1",code:"A.8.1",title:"Endpoint devices",description:"Device agents."},{id:"A.8.2",code:"A.8.2",title:"Privileged access",description:"Admin rights."},{id:"A.8.3",code:"A.8.3",title:"Information access",description:"Need-to-know."},{id:"A.8.4",code:"A.8.4",title:"Source code access",description:"IP security."},{id:"A.8.5",code:"A.8.5",title:"Authentication",description:"MFA usage."},{id:"A.8.6",code:"A.8.6",title:"Capacity mgmt",description:"Resources."},{id:"A.8.7",code:"A.8.7",title:"Malware protection",description:"AV/EDR."},{id:"A.8.8",code:"A.8.8",title:"Vulnerabilities",description:"Patching."},{id:"A.8.9",code:"A.8.9",title:"Configuration",description:"Hardening."},{id:"A.8.10",code:"A.8.10",title:"Deletion",description:"Erasure."},{id:"A.8.11",code:"A.8.11",title:"Data masking",description:"Privacy."},{id:"A.8.12",code:"A.8.12",title:"DLP",description:"Leakage prevention."},{id:"A.8.13",code:"A.8.13",title:"Backup",description:"Redundancy."},{id:"A.8.14",code:"A.8.14",title:"Redundancy ICT",description:"HA systems."},{id:"A.8.15",code:"A.8.15",title:"Logging",description:"Audit trails."},{id:"A.8.16",code:"A.8.16",title:"Monitoring",description:"Health alerts."},{id:"A.8.17",code:"A.8.17",title:"Clock sync",description:"NTP."},{id:"A.8.18",code:"A.8.18",title:"Privileged utilities",description:"Restrict tools."},{id:"A.8.19",code:"A.8.19",title:"Software install",description:"Whitelisting."},{id:"A.8.20",code:"A.8.20",title:"Network security",description:"Firewalls."},{id:"A.8.21",code:"A.8.21",title:"Network services",description:"VPN/Gateways."},{id:"A.8.22",code:"A.8.22",title:"Segregation",description:"VLANs."},{id:"A.8.23",code:"A.8.23",title:"Web filtering",description:"Proxy."},{id:"A.8.24",code:"A.8.24",title:"Cryptography",description:"Encryption."},{id:"A.8.25",code:"A.8.25",title:"Secure SDLC",description:"Dev security."},{id:"A.8.26",code:"A.8.26",title:"Application security",description:"Design."},{id:"A.8.27",code:"A.8.27",title:"Architecture",description:"Engineering."},{id:"A.8.28",code:"A.8.28",title:"Secure coding",description:"OWASP."},{id:"A.8.29",code:"A.8.29",title:"Security testing",description:"VAPT."},{id:"A.8.30",code:"A.8.30",title:"Outsourced dev",description:"Contractor code."},{id:"A.8.31",code:"A.8.31",title:"Separation envs",description:"Dev/Prod."},{id:"A.8.32",code:"A.8.32",title:"Change mgmt",description:"RFCs."},{id:"A.8.33",code:"A.8.33",title:"Test info",description:"Protect data."},{id:"A.8.34",code:"A.8.34",title:"IS during audit",description:"Auditor access."}]}]},Ft={name:"ISO 14001:2015 (EMS)",description:"Environmental Management System",groups:[{id:"PLAN_14001",title:"Plan (4-6) Context & Leadership",icon:"FileShield",clauses:[{id:"4",code:"4",title:"Context",description:"Org Context.",subClauses:[{id:"4.1",code:"4.1",title:"Org Context",description:"Env issues."},{id:"4.2",code:"4.2",title:"Interested parties",description:"Expectations."},{id:"4.3",code:"4.3",title:"Scope",description:"Boundaries."},{id:"4.4",code:"4.4",title:"EMS System",description:"Processes."}]},{id:"5",code:"5",title:"Leadership",description:"Commitment.",subClauses:[{id:"5.1",code:"5.1",title:"Leadership & Commitment",description:"Duty."},{id:"5.2",code:"5.2",title:"Environmental Policy",description:"Goals."},{id:"5.3",code:"5.3",title:"Org Roles & Responsibilities",description:"Authorities."}]},{id:"6",code:"6",title:"Planning",description:"Aspects.",subClauses:[{id:"6.1.1",code:"6.1.1",title:"General",description:"Actions."},{id:"6.1.2",code:"6.1.2",title:"Environmental aspects",description:"Impacts."},{id:"6.1.3",code:"6.1.3",title:"Compliance obligations",description:"Legal."},{id:"6.1.4",code:"6.1.4",title:"Planning action",description:"Achievement."},{id:"6.2",code:"6.2",title:"Environmental objectives",description:"Plans."}]}]},{id:"SUPPORT_14001",title:"Support (7) Resources",icon:"LayoutList",clauses:[{id:"7.1",code:"7.1",title:"Resources",description:"Supply."},{id:"7.2",code:"7.2",title:"Competence",description:"Training."},{id:"7.3",code:"7.3",title:"Awareness",description:"EMS awareness."},{id:"7.4",code:"7.4",title:"Communication",description:"Internal/External.",subClauses:[{id:"7.4.1",code:"7.4.1",title:"General",description:"Criteria."},{id:"7.4.2",code:"7.4.2",title:"Internal",description:"Staff."},{id:"7.4.3",code:"7.4.3",title:"External",description:"Parties."}]},{id:"7.5",code:"7.5",title:"Documented info",description:"Control."}]},{id:"DO_14001",title:"Do (8) Operation",icon:"Cpu",clauses:[{id:"8.1",code:"8.1",title:"Operational control",description:"Lifecycle."},{id:"8.2",code:"8.2",title:"Emergency preparedness",description:"Response."}]},{id:"CHECK_ACT_14001",title:"Check & Act (9-10)",icon:"CheckThick",clauses:[{id:"9.1.1",code:"9.1.1",title:"General",description:"Measurement."},{id:"9.1.2",code:"9.1.2",title:"Compliance evaluation",description:"Audit."},{id:"9.2",code:"9.2",title:"Internal audit",description:"Scheduled review."},{id:"9.3",code:"9.3",title:"Management review",description:"Review outputs."},{id:"10.1",code:"10.1",title:"General",description:"Performance."},{id:"10.2",code:"10.2",title:"Nonconformity",description:"Corrective action."},{id:"10.3",code:"10.3",title:"Continual improvement",description:"Suitability."}]}]},Bt={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var Ut={};const Kt="5.1.0-SMART-ROUTING",Vt="2026-03-01 12:00:00 (GMT+7)",Ye="gemini-3-pro-preview",Wt="gemini-2.5-flash-image",Te={company:"",address:"",scope:"",soa:"",smo:"",auditor:"",type:""},Gt=()=>{try{if(typeof import.meta<"u"&&Bt)return}catch{}try{if(typeof process<"u"&&Ut)return""}catch{}return""},qt=Gt(),De=[qt,"AIzaSyC_yJCcSrU5eiKm_0MmMq1vwK-xyB72i4U"].filter(t=>t&&t.trim()!==""),Ht=["gemini-3-pro-preview","gemini-2.0-flash","gemini-2.0-flash-lite-preview-02-05","gemini-3-flash-preview"],ue=[{id:"planning",label:"1. Planning",icon:"LayoutList",colorClass:"bg-orange-500",textClass:"text-orange-600",borderClass:"border-orange-500",bgSoft:"bg-orange-50 dark:bg-orange-950/30"},{id:"evidence",label:"2. Audit",icon:"ScanText",colorClass:"bg-blue-500",textClass:"text-blue-600",borderClass:"border-blue-500",bgSoft:"bg-blue-50 dark:bg-blue-950/30"},{id:"findings",label:"3. Findings",icon:"Wand2",colorClass:"bg-purple-500",textClass:"text-purple-600",borderClass:"border-purple-500",bgSoft:"bg-purple-50 dark:bg-purple-950/30"},{id:"report",label:"4. Report",icon:"FileText",colorClass:"bg-emerald-500",textClass:"text-emerald-600",borderClass:"border-emerald-500",bgSoft:"bg-emerald-50 dark:bg-emerald-950/30"}],Jt={"Stage 1":"Initial review of documentation and readiness.","Stage 2":"Evaluation of implementation and effectiveness.",Internal:"First-party audit to check own system.","PRE ASSESSMENT":"Gap analysis assessment.","PRE TRANSFER REVIEW":"Check valid certification for transfer.","TRANSITION AUDIT":"Ensure transition to new standard version.",CAV:"Surveillance assessment.",RAV:"Re-assessment of existing certification."},Ze={"ISO 9001:2015":$t,"ISO 27001:2022":zt,"ISO 14001:2015":Ft},Xt=[{version:"5.1.0-SMART-ROUTING",date:"2026-03-01",features:["CORE: Added Smart Model Rotator. Automatically switches to Flash/Lite models when Pro quota is exceeded.","QUOTA: Integrated Gemini 2.0 Flash Lite for maximum availability."]},{version:"5.0.2-HOTFIX",date:"2026-03-01",features:["CRITICAL: Removed Gemini 1.5 models causing 404 errors.","CORE: Upgraded all synthesis tasks to Gemini 3.0 Pro/Flash."]},{version:"5.0.0-PERFORMANCE",date:"2026-03-01",features:["CORE: Major Refactoring & Code Cleanup. Tech debt cleared.","UI/UX: Modern 'Glassmorphism' Interface with depth and smooth motion.","PERF: Optimized Rendering Engine for Matrix & Findings views."]}],Yt=[{icon:"ScanText",title:"Smart OCR",desc:"Extracts text from Images, PDFs & TXT."},{icon:"Wand2",title:"AI Analysis",desc:"Expert compliance evaluation."},{icon:"FileText",title:"Auto Report",desc:"Synthesizes final audit findings."},{icon:"LayoutList",title:"Matrix View",desc:"Structured Evidence Mapping."}],Zt="",Qt="ISO_AUDIT_DB",pe="knowledge_files",es=1;class ts{constructor(){Ae(this,"dbPromise",null)}openDB(){return this.dbPromise?this.dbPromise:(this.dbPromise=new Promise((s,r)=>{const a=indexedDB.open(Qt,es);a.onupgradeneeded=i=>{const n=i.target.result;n.objectStoreNames.contains(pe)||n.createObjectStore(pe,{keyPath:"standardKey"})},a.onsuccess=i=>{s(i.target.result)},a.onerror=i=>{console.error("KnowledgeStore: DB Open Error",i),r(i.target.error)}}),this.dbPromise)}async saveDocument(s,r,a){try{const i=await this.openDB();return new Promise((n,l)=>{const o=i.transaction([pe],"readwrite").objectStore(pe),d={standardKey:s,fileName:r,content:a,timestamp:Date.now()},x=o.put(d);x.onsuccess=()=>n(),x.onerror=()=>l(x.error)})}catch(i){throw console.error("KnowledgeStore: Save Error",i),i}}async getDocument(s){try{const r=await this.openDB();return new Promise((a,i)=>{const u=r.transaction([pe],"readonly").objectStore(pe).get(s);u.onsuccess=()=>{a(u.result?u.result:null)},u.onerror=()=>i(u.error)})}catch(r){return console.error("KnowledgeStore: Get Error",r),null}}async deleteDocument(s){try{const r=await this.openDB();return new Promise((a,i)=>{const u=r.transaction([pe],"readwrite").objectStore(pe).delete(s);u.onsuccess=()=>a(),u.onerror=()=>i(u.error)})}catch(r){throw console.error("KnowledgeStore: Delete Error",r),r}}async migrateFromLocalStorage(s){const r=`iso_kb_content_${s}`,a=`iso_kb_name_${s}`,i=localStorage.getItem(r),n=localStorage.getItem(a);return i&&n?(console.log(`KnowledgeStore: Migrating ${s} from LocalStorage to IndexedDB...`),await this.saveDocument(s,n,i),localStorage.removeItem(r),localStorage.removeItem(a),!0):!1}}const _e=new ts,Qe=c.createContext(void 0),Ke={maskCompany:!0,maskSmo:!0,maskPeople:!0,maskEmail:!0,maskPhone:!0,maskAddress:!0,maskIP:!0},ss=({children:t})=>{const[s,r]=c.useState({}),[a,i]=c.useState(""),[n,l]=c.useState(Te),[u,o]=c.useState(Ke),[d,x]=c.useState([]),[h,k]=c.useState(null),[g,w]=c.useState(Zt),[j,y]=c.useState({}),[C,p]=c.useState([]),[m,N]=c.useState([]),[A,L]=c.useState(null),[E,_]=c.useState(null),[Z,W]=c.useState(null),[q,D]=c.useState({}),[F,U]=c.useState(null),K={...Ze,...s},Y=d.find(T=>T.id===h);c.useEffect(()=>{h&&x(T=>T.map(b=>b.id===h&&(b.evidence!==g||b.matrixData!==j||b.evidenceTags!==C)?{...b,evidence:g,matrixData:j,evidenceTags:C}:b))},[g,j,C,h]),c.useEffect(()=>{if(!h){w(""),y({}),p([]);return}const T=d.find(b=>b.id===h);T&&(w(T.evidence||""),y(T.matrixData||{}),p(T.evidenceTags||[]))},[h]);const Q=(T,b)=>{r(B=>({...B,[T]:b}))},se=T=>{r(b=>({...b,[a]:T}))},R=T=>{r(b=>{const B={...b};return delete B[T],B}),a===T&&i("")},O=T=>{const b=`proc_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,B={id:b,name:T,evidence:"",interviewees:[],matrixData:{},evidenceTags:[],uploadedFiles:[]};x(G=>[...G,B]),k(b)},V=(T,b)=>{x(B=>B.map(G=>G.id===T?{...G,name:b}:G))},v=T=>{if(h===T){const b=d.filter(G=>G.id!==T),B=b.length>0?b[0].id:null;k(B)}x(b=>b.filter(B=>B.id!==T))},S=(T,b)=>{if(!b)return null;const B=b.groups.flatMap(J=>J.clauses),G=(J,ee)=>{for(const ie of ee){if(ie.id===J)return ie;if(ie.subClauses){const ne=G(J,ie.subClauses);if(ne)return ne}}return null};return G(T,B)},I=T=>{x(B=>B.map(G=>{const J=T.find(ee=>ee.processId===G.id);if(J){const ee={...G.matrixData},ie=K[a];return J.clauses.forEach(ne=>{if(!ee[ne]){const fe=S(ne,ie),je=(fe==null?void 0:fe.description)||"Requirement";ee[ne]=[{id:`${ne}_req_0`,requirement:je,evidenceInput:"",status:"pending"}]}}),{...G,matrixData:ee}}return G}));const b=T.find(B=>B.processId===h);b&&y(B=>{const G={...B},J=K[a];return b.clauses.forEach(ee=>{if(!G[ee]){const ie=S(ee,J),ne=(ie==null?void 0:ie.description)||"Requirement";G[ee]=[{id:`${ee}_req_0`,requirement:ne,evidenceInput:"",status:"pending"}]}}),G})},P=(T,b)=>{x(B=>B.map(G=>{if(G.id!==T)return G;const J={...G.matrixData};if(J[b])delete J[b];else{const ee=K[a],ie=S(b,ee),ne=(ie==null?void 0:ie.description)||"Requirement";J[b]=[{id:`${b}_req_0`,requirement:ne,evidenceInput:"",status:"pending"}]}return{...G,matrixData:J}})),h===T&&y(B=>{const G={...B};if(G[b])delete G[b];else{const J=K[a],ee=S(b,J),ie=(ee==null?void 0:ee.description)||"Requirement";G[b]=[{id:`${b}_req_0`,requirement:ie,evidenceInput:"",status:"pending"}]}return G})},M=T=>{x(b=>b.map(B=>B.id===h&&!B.interviewees.includes(T)?{...B,interviewees:[...B.interviewees,T]}:B))},$=T=>{x(b=>b.map(B=>B.id===h?{...B,interviewees:B.interviewees.filter(G=>G!==T)}:B))},H=T=>{p(b=>[...b,T])},z=async T=>{try{const b=await _e.getDocument(T);b?(L(b.content),_(b.fileName)):(L(null),_(null))}catch(b){console.error(b)}},X=async()=>{L(null),_(null),a&&await _e.deleteDocument(a)},re=(T,b)=>{L(T),_(b)},ae=()=>{i(""),l(Te),x([]),k(null),w(""),y({}),p([]),N([]),W(null),D({}),U(null),L(null),_(null),o(Ke)},Ne=T=>{if(T.standardKey&&i(T.standardKey),T.auditInfo&&l({...Te,...T.auditInfo}),T.selectedClauses&&N(T.selectedClauses),T.privacySettings&&o(T.privacySettings),T.processes&&T.processes.length>0)x(T.processes),T.activeProcessId&&k(T.activeProcessId);else if(T.scopes&&T.scopes.length>0){const b=T.scopes.map(B=>({...B,interviewees:[]}));x(b),T.activeScopeId&&k(T.activeScopeId)}T.analysisResult&&W(T.analysisResult),T.selectedFindings&&D(T.selectedFindings),T.finalReportText&&U(T.finalReportText),T.standardKey&&z(T.standardKey)};return e.jsx(Qe.Provider,{value:{standards:K,standardKey:a,setStandardKey:i,customStandards:s,addCustomStandard:Q,updateStandard:se,resetStandard:R,auditInfo:n,setAuditInfo:l,privacySettings:u,setPrivacySettings:o,processes:d,activeProcessId:h,activeProcess:Y,setActiveProcessId:k,addProcess:O,renameProcess:V,deleteProcess:v,batchUpdateProcessClauses:I,toggleProcessClause:P,addInterviewee:M,removeInterviewee:$,evidence:g,setEvidence:w,matrixData:j,setMatrixData:y,evidenceTags:C,addEvidenceTag:H,selectedClauses:m,setSelectedClauses:N,knowledgeBase:A,knowledgeFileName:E,loadKnowledgeForStandard:z,clearKnowledge:X,setKnowledgeData:re,analysisResult:Z,setAnalysisResult:W,selectedFindings:q,setSelectedFindings:D,finalReportText:F,setFinalReportText:U,resetSession:ae,restoreSession:Ne},children:t})},oe=()=>{const t=c.useContext(Qe);if(!t)throw new Error("useAudit must be used within AuditProvider");return t},et=c.createContext(void 0),rs=({children:t})=>{const[s,r]=c.useState(!0);c.useEffect(()=>{s?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[s]);const[a,i]=c.useState(1);c.useEffect(()=>{document.documentElement.style.setProperty("--font-scale",a.toString())},[a]);const[n,l]=c.useState(!0),[u,o]=c.useState(420),[d,x]=c.useState({settings:!1,about:!1,integrity:!1,recall:!1,addStandard:!1,privacy:!1}),h=(j,y)=>{x(C=>({...C,[j]:y??!C[j]}))},[k,g]=c.useState(null),w=j=>g(j);return e.jsx(et.Provider,{value:{isDarkMode:s,toggleDarkMode:()=>r(j=>!j),fontSizeScale:a,setFontSizeScale:i,isSidebarOpen:n,setSidebarOpen:l,sidebarWidth:u,setSidebarWidth:o,modals:d,toggleModal:h,toastMsg:k,showToast:w},children:t})},de=()=>{const t=c.useContext(et);if(!t)throw new Error("useUI must be used within UIProvider");return t},tt=c.createContext(void 0),is=({children:t})=>{const[s,r]=c.useState([]),[a,i]=c.useState(""),n=c.useRef([]);c.useEffect(()=>{n.current=s},[s]),c.useEffect(()=>{try{const k=localStorage.getItem("iso_api_keys"),g=k?JSON.parse(k):[],w=new Set(g.map(C=>C.key));let j=!1;De.forEach((C,p)=>{C&&!w.has(C)&&(g.push({id:`env_key_${p}`,label:`Default Key ${p+1}`,key:C,status:"valid",latency:0,lastChecked:new Date().toISOString()}),j=!0)}),g.forEach(C=>{C.activeModel==="gemini-1.5-flash"&&(C.activeModel="gemini-2.0-flash-exp",j=!0)}),r(g),j&&localStorage.setItem("iso_api_keys",JSON.stringify(g));const y=localStorage.getItem("iso_active_key_id");y&&g.some(C=>C.id===y)?i(y):g.length>0&&i(g[0].id)}catch(k){console.error("Key Load Error",k)}},[]);const l=async(k,g)=>{if(!k.trim())return"empty";if(s.some(y=>y.key===k.trim()))return"duplicate";const w={id:Date.now().toString(),label:g||`Key ${s.length+1}`,key:k.trim(),status:"valid",activeModel:"gemini-2.0-flash-exp",latency:0,lastChecked:new Date().toISOString()},j=[...s,w];return r(j),localStorage.setItem("iso_api_keys",JSON.stringify(j)),s.length===0&&(i(w.id),localStorage.setItem("iso_active_key_id",w.id)),"valid"},u=k=>{const g=s.filter(w=>w.id!==k);if(r(g),localStorage.setItem("iso_api_keys",JSON.stringify(g)),a===k){const w=g[0],j=w?w.id:"";i(j),j?localStorage.setItem("iso_active_key_id",j):localStorage.removeItem("iso_active_key_id")}},o=async()=>{},d=async()=>{},x=()=>{},h=c.useCallback(()=>s.find(k=>k.id===a),[s,a]);return e.jsx(tt.Provider,{value:{apiKeys:s,activeKeyId:a,isCheckingKey:!1,addKey:l,deleteKey:u,refreshKeyStatus:o,checkAllKeys:d,getActiveKey:h,isAutoCheckEnabled:!1,toggleAutoCheck:x,setActiveKeyId:i},children:t})},ke=()=>{const t=c.useContext(tt);if(!t)throw new Error("useKeyPool must be used within KeyPoolProvider");return t},Ve={BookOpen:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),e.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),Quote:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2H4c-1.25 0-2 .75-2 2v6c0 7 4 8 7 8Z"}),e.jsx("path",{d:"M14 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2h-4c-1.25 0-2 .75-2 2v6c0 7 4 8 7 8Z"})]}),TDLogo:e.jsxs("svg",{viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"tealNeonGrad",x1:"100%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#00f2c3",stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:"#0098f0",stopOpacity:"1"})]})}),e.jsx("path",{d:"M 20 20 H 65 L 55 30 H 30 V 65 L 20 75 V 20 Z",fill:"url(#tealNeonGrad)"}),e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 40 40 H 60 C 75 40, 85 50, 85 65 C 85 80, 75 90, 60 90 H 35 L 45 80 H 60 C 70 80, 75 75, 75 65 C 75 55, 70 50, 60 50 H 50 V 40 Z",fill:"url(#tealNeonGrad)"}),e.jsx("path",{d:"M 30 65 L 60 35",stroke:"white",strokeWidth:"0.5",strokeOpacity:"0.3"})]}),TDSolidLink:e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"future_td_grad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#06b6d4"})," ",e.jsx("stop",{offset:"50%",stopColor:"#6366f1"})," ",e.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})," "]}),e.jsxs("filter",{id:"glow_td",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[e.jsx("feGaussianBlur",{stdDeviation:"0.6",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("path",{d:"M5 6H11V18H14C17.866 18 21 15.3137 21 12C21 8.68629 17.866 6 14 6H11",stroke:"url(#future_td_grad)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow_td)"})]}),Grid:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"})]}),Session1_SparklePlus:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 3v18"}),e.jsx("path",{d:"M3 12h18"}),e.jsx("path",{d:"m15 9-6 6"}),e.jsx("path",{d:"m9 9 6 6"}),e.jsx("path",{d:"M12 2v4"}),e.jsx("path",{d:"m4.93 4.93 2.83 2.83"}),e.jsx("path",{d:"M2 12h4"}),e.jsx("path",{d:"m4.93 19.07 2.83-2.83"}),e.jsx("path",{d:"M12 22v-4"}),e.jsx("path",{d:"m19.07 19.07-2.83-2.83"}),e.jsx("path",{d:"M22 12h-4"}),e.jsx("path",{d:"m19.07 4.93-2.83 2.83"})]}),Session2_PlayCircle:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polygon",{points:"10 8 16 12 10 16 10 8"})]}),Session3_Rocket:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"}),e.jsx("path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"}),e.jsx("path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.1 4-1 4-1"}),e.jsx("path",{d:"M12 15v5s3.03-.55 4-2c1.1-1.62 1-4 1-4"})]}),Session4_FilePlus:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),e.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]}),Session5_RefreshCircle:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),e.jsx("path",{d:"M3 3v5h5"}),e.jsx("path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"}),e.jsx("path",{d:"M16 21h5v-5"})]}),Session6_Zap:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),Session7_Compass:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"})]}),Session8_Flag:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),e.jsx("line",{x1:"4",y1:"22",x2:"4",y2:"15"})]}),Session9_DoorOpen:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M13 4h3a2 2 0 0 1 2 2v14"}),e.jsx("path",{d:"M2 20h3"}),e.jsx("path",{d:"M13 20h9"}),e.jsx("path",{d:"M10 12v.01"}),e.jsx("path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z"})]}),Session10_Pulse:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})}),Session11_GridAdd:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}),e.jsx("path",{d:"M3 17.5h7"}),e.jsx("path",{d:"M6.5 14v7"})]}),Session12_CleanSheet:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),e.jsx("path",{d:"M3 9h18"})]}),Session13_PowerBtn:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0"}),e.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"12"})]}),Demo1_MultiFiles:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M3 15h6"}),e.jsx("path",{d:"M6 12v6"}),e.jsx("path",{d:"M16 18l2-2 2 2"}),e.jsx("path",{d:"M18 16v6"})]}),Demo2_CloudAdd:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 13v8"}),e.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),e.jsx("path",{d:"M16 17l-4-4-4 4"})]}),Demo3_FolderUp:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"}),e.jsx("path",{d:"M12 10v6"}),e.jsx("path",{d:"m9 13 3-3 3 3"})]}),Demo4_ImgStack:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"}),e.jsx("line",{x1:"16",y1:"5",x2:"22",y2:"5"}),e.jsx("line",{x1:"19",y1:"2",x2:"19",y2:"8"}),e.jsx("circle",{cx:"9",cy:"9",r:"2"}),e.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),Demo5_Clip:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"}),e.jsx("path",{d:"M12 12h.01"})]}),Demo6_BoxUp:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"}),e.jsx("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),e.jsx("line",{x1:"12",y1:"12.01",x2:"12",y2:"22.08"}),e.jsx("polyline",{points:"16 12 12 8 8 12"})]}),Demo7_PlusCircle:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M8 12h8"}),e.jsx("path",{d:"M12 8v8"})]}),Demo8_GridPlus:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"}),e.jsx("path",{d:"M14 17h7"}),e.jsx("path",{d:"M17.5 13.5v7"})]}),Demo9_DocUp:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M12 18v-6"}),e.jsx("path",{d:"m9 15 3-3 3 3"})]}),Demo10_Layers:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"}),e.jsx("path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"}),e.jsx("path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"}),e.jsx("path",{d:"M12 8v4"})]}),Demo11_Scan:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),e.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),e.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),e.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),e.jsx("path",{d:"M7 12h10"}),e.jsx("path",{d:"M12 8v8"})]}),Demo12_Attach:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m4.5 16.5 7-7"}),e.jsx("path",{d:"m2 2 20 20"}),e.jsx("path",{d:"m12 12 7-7"}),e.jsx("path",{d:"M17 17v5"}),e.jsx("path",{d:"M22 12h-5"})]}),Demo13_Meteor:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m13 4 8.2 2.5a2 2 0 0 1 1.3 2.5L20 17.5"}),e.jsx("path",{d:"m8.5 7.5 10 10"}),e.jsx("path",{d:"M2 13.5V19a2 2 0 0 0 2 2h5.5"}),e.jsx("path",{d:"m13.5 8.5-5 5"}),e.jsx("path",{d:"M7 15c-1.5 1-2 2.5-2 2.5s1.5.5 2.5-2"}),e.jsx("path",{d:"M12 4V2"}),e.jsx("path",{d:"m16 6 2-2"}),e.jsx("path",{d:"M8 6 6 4"})]}),Sparkle:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",className:"text-amber-400 drop-shadow-[0_0_4px_rgba(252,211,77,0.7)] animate-pulse-slow",children:e.jsx("path",{d:"M12 2L14.4 9.6L22 12L14.4 14.4L12 22L9.6 14.4L2 12L9.6 9.6L12 2Z"})}),FilePlus2:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M3 15h6"}),e.jsx("path",{d:"M6 12v6"})]}),History:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),e.jsx("path",{d:"M3 3v5h5"}),e.jsx("path",{d:"M12 7v5l4 2"})]}),LayoutList:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}),e.jsx("rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"}),e.jsx("path",{d:"M14 4h7"}),e.jsx("path",{d:"M14 9h7"}),e.jsx("path",{d:"M14 15h7"}),e.jsx("path",{d:"M14 20h7"})]}),Tag:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}),e.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})]}),FileEdit:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l1-3.95 5.42-5.44Z"})]}),Book:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),FileShield:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("path",{d:"M12 13v7"}),e.jsx("path",{d:"M8.5 16.5c2 1 5 1 7 0"})]}),Users:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),Lock:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),Cpu:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e.jsx("rect",{x:"9",y:"9",width:"6",height:"6"}),e.jsx("path",{d:"M15 2v2"}),e.jsx("path",{d:"M15 20v2"}),e.jsx("path",{d:"M2 15h2"}),e.jsx("path",{d:"M2 9h2"}),e.jsx("path",{d:"M20 15h2"}),e.jsx("path",{d:"M20 9h2"}),e.jsx("path",{d:"M9 2v2"}),e.jsx("path",{d:"M9 20v2"})]}),CheckThick:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),CheckSquare:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"9 11 12 14 22 4"}),e.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-3-2V5a2 2 0 0 1 2-2h11"})]}),Square:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"})}),FileText:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),Search:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),Trash2:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),e.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.jsx("path",{d:"M14 11v6"})]}),ChevronDown:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"6 9 12 15 18 9"})}),ChevronUp:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"18 15 12 9 6 15"})}),ChevronLeft:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})}),ChevronRight:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),Wand2:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z"}),e.jsx("path",{d:"m14 7 3 3"}),e.jsx("path",{d:"M5 6v4"}),e.jsx("path",{d:"M19 14v4"}),e.jsx("path",{d:"M10 2v2"}),e.jsx("path",{d:"M7 8H3"}),e.jsx("path",{d:"M21 16h-4"}),e.jsx("path",{d:"M11 3H9"})]}),AlertCircle:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),CheckCircle2:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]}),Save:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]}),ExpandPanel:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"15 3 21 3 21 9"}),e.jsx("polyline",{points:"9 21 3 21 3 15"}),e.jsx("line",{x1:"21",y1:"3",x2:"14",y2:"10"}),e.jsx("line",{x1:"3",y1:"21",x2:"10",y2:"14"})]}),CollapsePanel:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"4 14 10 14 10 20"}),e.jsx("polyline",{points:"20 10 14 10 14 4"}),e.jsx("line",{x1:"14",y1:"10",x2:"21",y2:"3"}),e.jsx("line",{x1:"3",y1:"21",x2:"10",y2:"14"})]}),X:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Copy:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),e.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]}),Download:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-3-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),Sun:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),Moon:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),RefreshCw:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 2v6h-6"}),e.jsx("path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8"}),e.jsx("path",{d:"M3 22v-6h6"}),e.jsx("path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16"})]}),Lightbulb:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 18h6"}),e.jsx("path",{d:"M10 22h4"}),e.jsx("path",{d:"M12 2v2"}),e.jsx("path",{d:"M12 16a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}),e.jsx("path",{d:"M9 10a3 3 0 0 1 3-3 3 3 0 0 1 3 3v2H9z"})]}),AIIndicator:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:e.jsx("path",{d:"M12 2L14.4 9.6L22 12L14.4 14.4L12 22L9.6 14.4L2 12L9.6 9.6L12 2Z"})}),UploadCloud:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"}),e.jsx("path",{d:"M12 12v9"}),e.jsx("path",{d:"m16 16-4-4-4 4"})]}),Image:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),e.jsx("circle",{cx:"9",cy:"9",r:"2"}),e.jsx("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})]}),Info:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Settings:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Plus:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Minus:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})}),Key:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"m21 2-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0 3 3L22 7l-3-3m-3.5 3.5L19 4"})}),Loader:e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-spin",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})}),Keyboard:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",ry:"2"}),e.jsx("path",{d:"M6 8h.01"}),e.jsx("path",{d:"M10 8h.01"}),e.jsx("path",{d:"M14 8h.01"}),e.jsx("path",{d:"M18 8h.01"}),e.jsx("path",{d:"M6 12h.01"}),e.jsx("path",{d:"M10 12h.01"}),e.jsx("path",{d:"M14 12h.01"}),e.jsx("path",{d:"M18 12h.01"}),e.jsx("path",{d:"M7 16h10"})]}),TextSize:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 7V5h7v2"}),e.jsx("path",{d:"M6.5 5v14"}),e.jsx("path",{d:"M14 13v-2h7v2"}),e.jsx("path",{d:"M17.5 11v8"})]}),AuditUser:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"}),e.jsx("path",{d:"M22 22 18 18 16 20 20 24 24 20Z"})]}),ScanText:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 7V5c0-1.1.9-2 2-2h2"}),e.jsx("path",{d:"M17 3h2c1.1 0 2 .9 2 2v2"}),e.jsx("path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2"}),e.jsx("path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2"}),e.jsx("path",{d:"M7 12h.01"}),e.jsx("path",{d:"M10 12h4"}),e.jsx("path",{d:"M17 12h.01"}),e.jsx("path",{d:"M12 7v10"})]}),Building:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2"}),e.jsx("path",{d:"M9 22v-4c0-1.1.9-2 2-2h2c1.1 0 2 .9 2 2v4"}),e.jsx("path",{d:"M8 6h.01"}),e.jsx("path",{d:"M16 6h.01"}),e.jsx("path",{d:"M12 6h.01"}),e.jsx("path",{d:"M12 10h.01"}),e.jsx("path",{d:"M12 14h.01"}),e.jsx("path",{d:"M12 18h.01"})]}),User:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Snowflake:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"2",x2:"22",y1:"12",y2:"12"}),e.jsx("line",{x1:"12",x2:"12",y1:"2",y2:"22"}),e.jsx("path",{d:"m20 16-4-4 4-4"}),e.jsx("path",{d:"m4 8 4 4-4 4"}),e.jsx("path",{d:"m16 4-4 4-4-4"}),e.jsx("path",{d:"m8 20 4-4 4 4"})]}),CheckLineart:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Mic:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),e.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),ShieldEye:e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),e.jsx("path",{d:"M12 8c-2.5 0-4.5 1.5-6 4 1.5 2.5 3.5 4 6 4s4.5-1.5 6-4c-1.5-2.5-3.5-4-6-4z"}),e.jsx("circle",{cx:"12",cy:"12",r:"1.5"})]}),MapPin:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),Fence:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 6v14"}),e.jsx("path",{d:"M12 6v14"}),e.jsx("path",{d:"M20 6v14"}),e.jsx("path",{d:"M2 10h20"}),e.jsx("path",{d:"M2 16h20"})]})},f=({name:t,size:s=18,className:r="",onClick:a})=>{const i=Ve[t]||Ve.AlertCircle;if(ve.isValidElement(i)){const n=i;return ve.cloneElement(n,{width:s,height:s,className:`${r} ${n.props.className||""}`,onClick:a})}return e.jsx("span",{className:r,onClick:a,children:i})},We=({icon:t,iconColor:s,value:r,onChange:a,options:i,defaultText:n,onIconClick:l,iconTitle:u,id:o})=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:`absolute left-3 top-1/2 -translate-y-1/2 transition-all duration-300 z-10 flex items-center justify-center ${l?"cursor-pointer pointer-events-auto hover:scale-110 active:scale-95":"pointer-events-none"}`,onClick:d=>{l&&(d.stopPropagation(),l(d))},title:u,children:e.jsx("div",{className:s,children:e.jsx(f,{name:t,size:16})})}),e.jsxs("select",{id:o,value:r,onChange:a,className:`w-full appearance-none pl-10 pr-8 py-3 bg-gray-50 dark:bg-slate-950 border border-gray-100 dark:border-slate-800 rounded-xl text-xs font-normal outline-none focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 transition-all cursor-pointer shadow-sm hover:border-indigo-200 dark:hover:border-slate-600 hover:shadow-md dark:shadow-[inset_0_2px_4px_rgba(0,0,0,0.5)] ${r?"text-slate-700 dark:text-slate-300":"text-gray-400"}`,children:[e.jsx("option",{value:"",disabled:!0,children:n}),i.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400 group-hover:text-indigo-500 transition-colors duration-300",children:e.jsx(f,{name:"ChevronDown",size:14})})]}),Ee=({icon:t,iconColor:s,placeholder:r,value:a,onChange:i,className:n=""})=>e.jsxs("div",{className:`relative group ${n}`,children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none transition-colors duration-300",children:e.jsx("div",{className:s,children:e.jsx(f,{name:t,size:16})})}),e.jsx("input",{type:"text",placeholder:r,value:a,onChange:i,className:"w-full pl-10 pr-3 py-3 bg-gray-50 dark:bg-slate-950 border border-gray-100 dark:border-slate-800 rounded-xl text-xs font-normal text-slate-700 dark:text-slate-300 placeholder-gray-400 outline-none focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 transition-all shadow-sm hover:border-indigo-200 dark:hover:border-slate-600 hover:shadow-md dark:shadow-[inset_0_2px_4px_rgba(0,0,0,0.5)]"})]}),Ce=({isOpen:t,title:s,onClose:r,children:a})=>t?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md z-[300] flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:r,children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-lg rounded-3xl shadow-2xl border border-gray-100 dark:border-slate-800 transform transition-all animate-zoom-in-spring duration-300 overflow-hidden dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05),0_10px_15px_-3px_rgba(0,0,0,0.5)]",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-900",children:[e.jsx("h3",{className:"text-lg font-black text-slate-800 dark:text-white tracking-tight",children:s}),e.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-red-50 hover:text-red-500 dark:hover:bg-red-900/20 transition-all duration-300 text-slate-400 hover:rotate-90",children:e.jsx(f,{name:"X",size:20})})]}),e.jsx("div",{className:"p-6 max-h-[70vh] overflow-y-auto custom-scrollbar",children:a})]})}):null,as=({message:t,onClose:s})=>{const[r,a]=c.useState(!1),[i,n]=c.useState(!1),l=()=>{a(!0),setTimeout(()=>s(),400)};return c.useEffect(()=>{n(!0);const h=setTimeout(l,4e3);return()=>clearTimeout(h)},[s]),e.jsx("div",{className:`fixed z-[9999] w-[90vw] max-w-sm md:w-auto md:max-w-md top-20 left-1/2 -translate-x-1/2 md:top-auto md:left-auto md:bottom-10 md:right-10 md:translate-x-0 transition-all duration-500 ease-spring ${i?r?"opacity-0 scale-95 md:translate-x-4 -translate-y-4 md:translate-y-0":"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-4 md:translate-y-0 md:translate-x-4"}`,children:e.jsxs("div",{className:"bg-slate-900/95 dark:bg-white/95 backdrop-blur-md text-white dark:text-slate-900 px-4 py-3 md:px-5 md:py-4 rounded-2xl shadow-2xl flex items-start gap-3 md:gap-4 border border-slate-700/50 dark:border-slate-200/50",children:[e.jsx("div",{className:"flex-shrink-0 p-1.5 bg-emerald-500 rounded-full text-white shadow-lg shadow-emerald-500/30 mt-0.5",children:e.jsx(f,{name:"CheckLineart",size:14})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60 leading-none mb-1",children:"System Notification"}),e.jsx("span",{className:"text-xs md:text-sm font-bold leading-snug break-words",children:t})]}),e.jsx("button",{onClick:l,className:"flex-shrink-0 -mr-2 -mt-2 p-2 text-slate-500 hover:text-white dark:hover:text-slate-900 transition-colors rounded-full hover:bg-white/10 dark:hover:bg-black/5",children:e.jsx(f,{name:"X",size:16})})]})})},ns=({className:t})=>e.jsxs("div",{className:`flex items-center justify-center gap-1 ${t}`,children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-3 w-3 rounded-full bg-indigo-400 opacity-75"}),e.jsx(f,{name:"Sparkle",size:16,className:"animate-spin-slow text-yellow-300"})]}),os=({fontSizeScale:t,adjustFontSize:s})=>{const[r,a]=c.useState(!1),[i,n]=c.useState(null),l=c.useRef(null),u=o=>{if(o.stopPropagation(),!r&&l.current){const d=l.current.getBoundingClientRect(),x=window.innerWidth-d.right;n({top:d.bottom+8,right:x}),a(!0)}else a(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:l,onClick:u,className:`p-2 rounded-xl transition-all duration-300 shadow-sm ${r?"bg-indigo-100 text-indigo-700 dark:bg-slate-700 dark:text-indigo-400 scale-105":"bg-gray-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 hover:bg-indigo-50 hover:text-indigo-600"}`,title:"Adjust Font Size",children:e.jsx(f,{name:"TextSize",size:18})}),r&&i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[99] cursor-default",onClick:()=>a(!1)}),e.jsxs("div",{className:"fixed z-[100] flex items-center bg-white dark:bg-slate-900 rounded-full p-1.5 shadow-2xl border border-gray-200 dark:border-slate-700 animate-zoom-in-spring min-w-[140px] justify-between",style:{top:`${i.top}px`,right:`${i.right}px`},onClick:o=>o.stopPropagation(),children:[e.jsx("button",{onClick:()=>s("decrease"),className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-800 rounded-full text-slate-500 hover:text-indigo-600 transition-all duration-200 flex-shrink-0 active:scale-90",children:e.jsx(f,{name:"Minus",size:16})}),e.jsxs("span",{className:"text-sm font-black text-slate-800 dark:text-white select-none px-2 w-12 text-center",children:[(t*100).toFixed(0),"%"]}),e.jsx("button",{onClick:()=>s("increase"),className:"p-2 hover:bg-gray-100 dark:hover:bg-slate-800 rounded-full text-slate-500 hover:text-indigo-600 transition-all duration-200 flex-shrink-0 active:scale-90",children:e.jsx(f,{name:"Plus",size:16})})]})]})]})},ls=()=>{const{isSidebarOpen:t,setSidebarOpen:s,toggleModal:r,fontSizeScale:a,setFontSizeScale:i,isDarkMode:n,toggleDarkMode:l}=de(),{standards:u,standardKey:o,privacySettings:d}=oe(),{getActiveKey:x}=ke(),h=x(),k=c.useMemo(()=>Object.values(d).some(p=>p===!0),[d]),g="flex items-center gap-2 px-3 py-1.5 rounded-full border shadow-sm backdrop-blur-md transition-all duration-300",w="text-[10px] font-black uppercase tracking-widest leading-none",j=c.useMemo(()=>{if(!h)return{status:"offline",dotColor:"bg-slate-300 dark:bg-slate-600",borderColor:"border-slate-200 dark:border-slate-700 text-slate-500",tooltip:"AI Offline: No API Key Configured"};const p=h.activeModel||"Unknown";let m="GEMINI";return p.includes("2.0-flash")?m="Flash 2.0":p.includes("3-pro")?m="Pro 3.0":p.includes("lite")&&(m="Flash Lite"),h.status==="valid"?{status:"online",dotColor:"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.6)] animate-pulse",borderColor:"border-emerald-200 dark:border-emerald-800/50 bg-emerald-50/50 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400",tooltip:`AI Ready: ${m}`}:h.status==="quota_exceeded"?{status:"warning",dotColor:"bg-orange-500",borderColor:"border-orange-200 dark:border-orange-800 bg-orange-50/50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400",tooltip:"Quota Exceeded: Switching to backup model..."}:{status:"error",dotColor:"bg-red-500",borderColor:"border-red-200 dark:border-red-800 bg-red-50/50 dark:bg-red-900/20 text-red-600 dark:text-red-400",tooltip:"Connection Error: Check API Key"}},[h]),y=c.useMemo(()=>{var N;const p=((N=u[o])==null?void 0:N.name)||"",m=p.match(/\((.*?)\)/);return m?m[1]:p.split(" ")[0]||"ISO"},[o,u]),C=c.useMemo(()=>{const p=y.toUpperCase();return p.includes("EMS")||p.includes("14001")?"bg-emerald-50/50 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400 border-emerald-200 dark:border-emerald-800/50":p.includes("QMS")||p.includes("9001")?"bg-blue-50/50 dark:bg-blue-900/10 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-800/50":p.includes("ISMS")||p.includes("27001")?"bg-purple-50/50 dark:bg-purple-900/10 text-purple-700 dark:text-purple-400 border-purple-200 dark:border-purple-800/50":"bg-slate-50/50 dark:bg-slate-800/50 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-slate-700"},[y]);return e.jsxs("header",{className:"flex-shrink-0 px-4 md:px-6 py-0 border-b border-white/50 dark:border-slate-800 bg-white/70 dark:bg-slate-900/80 backdrop-blur-xl shadow-glass z-[70] relative flex justify-between items-center h-16 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center h-full gap-4 md:gap-6",children:[e.jsx("div",{className:"relative group cursor-pointer flex items-center justify-center active:scale-95 transition-transform",onClick:()=>s(!t),title:"Toggle Sidebar",children:e.jsx("div",{className:"relative w-10 h-10 flex items-center justify-center",children:t?e.jsxs("div",{className:"relative w-8 h-8",children:[e.jsx("div",{className:"absolute inset-0 border-2 border-transparent border-t-indigo-500 border-b-cyan-500 rounded-full animate-infinity-spin drop-shadow-md"}),e.jsx("div",{className:"absolute inset-2 border-2 border-transparent border-l-purple-500 border-r-pink-500 rounded-full animate-spin-reverse drop-shadow-sm"})]}):e.jsx("div",{className:"transform group-hover:scale-110 transition-transform duration-300 drop-shadow-[0_0_10px_rgba(99,102,241,0.5)]",children:e.jsx(f,{name:"TDLogo",size:32})})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"hidden md:block text-lg font-extrabold tracking-tight text-slate-800 dark:text-white leading-none",children:["ISO Audit ",e.jsx("span",{className:"font-light text-slate-400",children:"Pro"})]}),e.jsxs("div",{className:"hidden lg:flex items-center gap-2",children:[e.jsxs("div",{onClick:()=>r("settings",!0),className:`${g} ${j.borderColor} cursor-pointer hover:shadow-md hover:-translate-y-0.5 active:scale-95`,title:j.tooltip,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${j.dotColor}`}),e.jsx("span",{className:w,children:"AI"})]}),e.jsxs("div",{className:`${g} ${C}`,children:[e.jsx(f,{name:"Book",size:10,className:"opacity-70"}),e.jsx("span",{className:w,children:y})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r("privacy",!0),className:`p-2 rounded-xl transition-all active:scale-95 border ${k?"text-emerald-600 bg-emerald-50 border-emerald-200 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-400 shadow-sm":"text-slate-400 hover:text-slate-600 hover:bg-slate-100 border-transparent dark:hover:bg-slate-800"}`,title:k?"Privacy Shield Active":"Configure Privacy Shield",children:e.jsx(f,{name:"ShieldEye",size:18})}),e.jsx("div",{className:"hidden lg:block w-px h-6 bg-slate-200 dark:bg-slate-700 mx-1"}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(os,{fontSizeScale:a,adjustFontSize:p=>i(m=>p==="increase"?Math.min(m+.1,1.3):Math.max(m-.1,.8))})}),e.jsx("button",{onClick:l,className:"p-2 rounded-xl text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 transition-all active:scale-95",children:e.jsx(f,{name:n?"Sun":"Moon",size:18})}),e.jsx("button",{onClick:()=>r("about",!0),className:"p-2 rounded-xl text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition-all active:scale-95",title:"About & Release Notes",children:e.jsx(f,{name:"Info",size:18})})]})]})},Ge=({icon:t,iconColor:s,placeholder:r,value:a,onChange:i,className:n="",rows:l=2})=>e.jsxs("div",{className:`relative group ${n}`,children:[e.jsx("div",{className:"absolute left-3 top-3 pointer-events-none transition-colors duration-300",children:e.jsx("div",{className:s,children:e.jsx(f,{name:t,size:16})})}),e.jsx("textarea",{placeholder:r,value:a,onChange:i,rows:l,className:"w-full pl-10 pr-3 py-3 bg-gray-50 dark:bg-slate-950 border border-gray-100 dark:border-slate-800 rounded-xl text-xs font-normal text-slate-700 dark:text-slate-300 placeholder-gray-400 outline-none focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 transition-all shadow-sm hover:border-indigo-200 dark:hover:border-slate-600 hover:shadow-md dark:shadow-[inset_0_2px_4px_rgba(0,0,0,0.5)] resize-y min-h-[44px]"})]}),ds=({onAddNewStandard:t,onOpenIntegrity:s,onKnowledgeUpload:r,health:a,auditFieldIconColor:i,standardOptions:n})=>{var T;const{standardKey:l,setStandardKey:u,auditInfo:o,setAuditInfo:d,standards:x,knowledgeFileName:h,clearKnowledge:k,processes:g,activeProcessId:w,setActiveProcessId:j,addProcess:y,renameProcess:C,deleteProcess:p}=oe(),{showToast:m}=de(),N=c.useRef(null),A=c.useRef(null),L=c.useRef(null),E=c.useRef(!1),[_,Z]=c.useState(""),[W,q]=c.useState(null),[D,F]=c.useState(""),[U,K]=c.useState(!1),[Y,Q]=c.useState(!1),se=!!h,R=!!l&&l!=="ADD_NEW",O=se?"BookOpen":"Book",V=c.useMemo(()=>{var b;return l&&((b=x[l])==null?void 0:b.name.includes("27001"))},[l,x]);let v="text-gray-300 dark:text-slate-600",S="Please select an ISO Standard first to enable document upload.",I="cursor-not-allowed";se?(v="text-emerald-500 drop-shadow-sm",S=`Source Attached: ${h}. Click to Replace.`,I="cursor-pointer"):R&&(v=`${i} hover:text-indigo-600 dark:hover:text-indigo-300`,S="Click to upload Source PDF or Word (DOCX) for better accuracy",I="cursor-pointer hover:scale-110 active:scale-95");const P=()=>{R&&N.current&&N.current.click()},M=b=>{b.target.files&&b.target.files.length>0&&(r(b),b.target.value="")},$=b=>{if(b.key==="Enter"){b.preventDefault();const B=_.trim();if(B){const G=g.find(J=>J.name.toLowerCase()===B.toLowerCase());G?(j(G.id),m(`Switched to: ${G.name}`),Q(!1),Z(""),K(!1)):(E.current=!0,y(B),Z(""),Q(!0),K(!0),setTimeout(()=>{L.current&&(L.current.scrollTop=L.current.scrollHeight),A.current&&A.current.focus(),E.current=!1},50))}else Q(!1)}else b.key==="Escape"&&(Q(!1),Z(""))},H=()=>{E.current||_.trim()||Q(!1)},z=(b,B,G)=>{b.stopPropagation(),b.preventDefault();const J=g.find(ee=>ee.id===B);if(J){const ee=J.evidence&&J.evidence.trim().length>0,ie=Object.keys(J.matrixData).some(fe=>J.matrixData[fe].some(je=>je.evidenceInput&&je.evidenceInput.trim().length>0)),ne=J.uploadedFiles&&J.uploadedFiles.length>0;ee||ie||ne?window.confirm(`Delete process "${G}"? 

 WARNING: This process contains evidence/files that will be permanently lost.`)&&(p(B),m(`Deleted: ${G}`)):(p(B),m(`Deleted: ${G}`))}},X=b=>{q(b.id),F(b.name)},re=()=>{W&&D.trim()&&(C(W,D.trim()),m("Renamed successfully")),q(null)},ae=c.useMemo(()=>g.filter(b=>b.name&&b.name.trim()!==""),[g]),Ne=((T=ae.find(b=>b.id===w))==null?void 0:T.name)||"Select Process";return e.jsxs("div",{className:"bg-gray-50/80 dark:bg-slate-900/50 rounded-2xl border border-gray-100 dark:border-slate-800 shadow-sm p-3 space-y-4 w-full",children:[e.jsx("input",{type:"file",ref:N,accept:".pdf,.docx,.doc,.txt",className:"hidden",onChange:M}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase px-1",children:"Audit Standard"}),e.jsxs("div",{className:"relative group/source",children:[e.jsx(We,{id:"sidebar-standard-select",icon:O,iconColor:`${v} transition-all duration-300 ${I}`,value:l,onChange:b=>{b.target.value==="ADD_NEW"?t():u(b.target.value)},options:n,defaultText:"Select ISO Standard",onIconClick:P,iconTitle:S}),se&&e.jsx("button",{onClick:b=>{b.stopPropagation(),k()},className:"absolute right-9 top-1/2 -translate-y-1/2 p-1.5 text-slate-400 hover:text-red-500 bg-transparent hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-all z-20 active:scale-95",title:"Remove Source File",children:e.jsx(f,{name:"Trash2",size:14})}),l&&e.jsx("button",{onClick:s,className:`absolute -top-1.5 -right-1.5 p-1 rounded-full shadow-lg transition-all hover:scale-110 active:scale-95 text-white ring-2 ring-white dark:ring-slate-900 ${a.isHealthy?"bg-emerald-500":"bg-orange-500"}`,title:"Integrity Check",children:e.jsx(f,{name:a.isHealthy?"CheckCircle2":"AlertCircle",size:10})})]}),e.jsx(We,{icon:"FileEdit",iconColor:i,value:o.type,onChange:b=>d({...o,type:b.target.value}),options:Object.keys(Jt).map(b=>({value:b,label:b})),defaultText:"Select Audit Type"})]}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700/50"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase px-1",children:"Organization Context"}),e.jsxs("div",{className:"grid grid-cols-[1.5fr_1fr] gap-2",children:[e.jsx(Ee,{icon:"Building",iconColor:i,placeholder:"Company Name",value:o.company,onChange:b=>d({...o,company:b.target.value})}),e.jsx(Ee,{icon:"Tag",iconColor:i,placeholder:"SMO/ID",value:o.smo,onChange:b=>d({...o,smo:b.target.value})})]}),e.jsx(Ge,{icon:"MapPin",iconColor:i,placeholder:"Site Address / Locations...",value:o.address||"",onChange:b=>d({...o,address:b.target.value}),rows:2}),e.jsx(Ge,{icon:"Fence",iconColor:i,placeholder:"Audit Scope Description...",value:o.scope||"",onChange:b=>d({...o,scope:b.target.value}),rows:3}),V&&e.jsx("div",{className:"animate-in fade-in slide-in-from-top-2",children:e.jsx(Ee,{icon:"FileShield",iconColor:"text-purple-600 dark:text-purple-400",placeholder:"SoA Version / Reference (e.g. v2.0 2024)",value:o.soa||"",onChange:b=>d({...o,soa:b.target.value})})}),e.jsxs("div",{className:"space-y-2 pt-1",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-indigo-500 dark:text-indigo-400 uppercase",children:"Process Management"}),e.jsxs("span",{className:"text-[9px] text-slate-400 dark:text-slate-500 font-mono",children:[ae.length," Items"]})]}),ae.length===0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative group w-full",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none text-indigo-600 dark:text-indigo-400 group-focus-within:text-indigo-500",children:e.jsx(f,{name:"Plus",size:16})}),e.jsx("input",{ref:A,type:"text",value:_,placeholder:"Enter Process/Department...",onChange:b=>Z(b.target.value),onKeyDown:$,className:"w-full pl-10 pr-3 py-2.5 bg-white dark:bg-slate-950 border border-indigo-100 dark:border-slate-700 rounded-xl text-xs font-bold text-slate-700 dark:text-slate-300 placeholder-indigo-300 dark:placeholder-slate-600 outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/10 transition-all shadow-sm",autoComplete:"off"})]}),e.jsxs("div",{className:"text-center py-4 text-[10px] text-red-400 font-bold bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800 animate-pulse",children:["! ACTION REQUIRED ",e.jsx("br",{})," ",e.jsx("span",{className:"font-normal text-slate-500",children:"Create a Process to Start"})]})]}):e.jsxs("div",{className:"relative",children:[e.jsxs("div",{onClick:()=>{Y||K(!U)},className:`w-full flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all duration-200 ${U||Y?"border-indigo-500 ring-1 ring-indigo-500 bg-white dark:bg-slate-900 shadow-md z-20":"bg-white dark:bg-slate-950 border-gray-100 dark:border-slate-800 hover:border-indigo-300 dark:hover:border-slate-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden flex-1",children:[e.jsx(f,{name:"Session11_GridAdd",size:16,className:"text-indigo-600 dark:text-indigo-400"}),Y?e.jsx("input",{ref:A,autoFocus:!0,value:_,onChange:b=>Z(b.target.value),onKeyDown:$,onBlur:H,placeholder:"Type Name & Enter to Add...",className:"bg-transparent border-none outline-none text-xs font-bold text-slate-800 dark:text-white placeholder-slate-400 w-full",onClick:b=>b.stopPropagation(),autoComplete:"off"}):e.jsx("span",{className:"text-xs font-bold truncate text-slate-700 dark:text-slate-300",children:Ne})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!Y&&e.jsx("div",{className:`p-1 rounded-full ${U?"bg-indigo-100 text-indigo-600 dark:bg-slate-800 dark:text-indigo-400":"hover:bg-gray-100 dark:hover:bg-slate-800 text-slate-400"}`,title:"Add New Process",onClick:b=>{b.stopPropagation(),K(!0),Q(!0),Z(""),setTimeout(()=>{var B;return(B=A.current)==null?void 0:B.focus()},50)},children:e.jsx(f,{name:"Plus",size:14})}),Y&&e.jsx("div",{className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400 hover:text-red-500",title:"Cancel / Close",onClick:b=>{b.stopPropagation(),Q(!1),Z("")},children:e.jsx(f,{name:"X",size:14})}),e.jsx(f,{name:"ChevronDown",size:14,className:`transition-transform duration-300 text-slate-400 ${U?"rotate-180":""}`})]})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${U?"max-h-[300px] opacity-100 mt-2":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"p-1 bg-white dark:bg-slate-950 border border-gray-200 dark:border-slate-800 rounded-xl shadow-xl space-y-1",children:e.jsx("div",{ref:L,className:"max-h-[200px] overflow-y-auto custom-scrollbar px-1 space-y-1 pb-1 pt-1 scroll-smooth",children:ae.map(b=>{const B=w===b.id,G=W===b.id;return e.jsxs("div",{className:`group flex items-center justify-between p-2 rounded-lg cursor-pointer transition-all ${B?"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-900/30":"hover:bg-gray-50 dark:hover:bg-slate-800 border border-transparent"}`,onClick:()=>{G||(j(b.id),Y||K(!1))},children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden flex-1",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full flex-shrink-0 ${B?"bg-indigo-500":"bg-slate-300 dark:bg-slate-700"}`}),G?e.jsx("input",{autoFocus:!0,className:"w-full min-w-0 bg-white dark:bg-slate-900 text-slate-900 dark:text-white text-xs font-bold px-1 py-0.5 rounded outline-none border border-indigo-300",value:D,onChange:J=>F(J.target.value),onKeyDown:J=>J.key==="Enter"&&re(),onBlur:re,onClick:J=>J.stopPropagation()}):e.jsx("span",{className:`text-xs truncate font-bold ${B?"text-indigo-700 dark:text-indigo-300":"text-slate-600 dark:text-slate-400"}`,children:b.name})]}),!G&&e.jsxs("div",{className:"flex items-center gap-1 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{type:"button",onClick:J=>{J.preventDefault(),J.stopPropagation(),X(b)},className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-md",title:"Rename",children:e.jsx(f,{name:"FileEdit",size:12})}),e.jsx("button",{type:"button",onClick:J=>z(J,b.id,b.name),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md",title:"Delete",children:e.jsx(f,{name:"Trash2",size:12})})]})]},b.id)})})})})]})]})]}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-slate-700/50"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase px-1",children:"Auditor"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.jsx(Ee,{icon:"AuditUser",iconColor:i,placeholder:"Lead Auditor Name",value:o.auditor,onChange:b=>d({...o,auditor:b.target.value})})})]})]})},cs=({isOpen:t,onClose:s,health:r,isCustomStandard:a,onResetStandard:i,onAutoRepair:n,isRepairing:l,repairStats:u})=>e.jsx(Ce,{isOpen:t,title:"Standard Health Index",onClose:s,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-5 p-5 rounded-3xl bg-gray-50 dark:bg-slate-800 border border-gray-100 dark:border-slate-700 shadow-inner dark:shadow-[inset_0_2px_6px_rgba(0,0,0,0.4)]",children:[e.jsxs("div",{className:`w-20 h-20 rounded-full flex items-center justify-center text-white text-2xl font-black shadow-xl ring-4 ring-white dark:ring-slate-700 ${r.score>90?"bg-gradient-to-br from-emerald-400 to-emerald-600":"bg-gradient-to-br from-orange-400 to-orange-600"}`,children:[r.score,"%"]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-black text-slate-900 dark:text-slate-100 uppercase tracking-tight",children:"Data Health"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 leading-snug mt-1",children:r.isHealthy?"Excellent! Data is accurate, clean, and complete for professional use.":"Standard data is incomplete or missing Source verification."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-1",children:"Integrity Checklist"}),[...r.integrity,...r.completeness].map((o,d)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white dark:bg-slate-900 border border-gray-100 dark:border-slate-800 rounded-2xl shadow-sm dark:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-1.5 rounded-full shadow-sm ${o.status==="pass"?"text-emerald-500 bg-emerald-50 dark:bg-emerald-900/20":"text-red-500 bg-red-50 dark:bg-red-900/20"}`,children:e.jsx(f,{name:o.status==="pass"?"CheckCircle2":"AlertCircle",size:18})}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:o.label})]}),e.jsx("span",{className:`text-[10px] font-black px-3 py-1 rounded-full shadow-sm uppercase ${o.status==="pass"?"text-emerald-700 bg-emerald-100":"text-red-700 bg-red-100"}`,children:o.detail})]},d))]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-slate-700 flex flex-col md:flex-row items-center justify-center gap-3",children:[a&&e.jsxs("button",{onClick:i,className:"px-4 py-2 bg-red-50 hover:bg-red-100 text-red-600 dark:bg-red-900/20 dark:hover:bg-red-900/40 dark:text-red-400 rounded-xl font-bold text-xs flex items-center gap-2 transition-all active:scale-95 border border-red-200 dark:border-red-800",children:[e.jsx(f,{name:"Trash2",size:14}),"Reset to Default"]}),u?e.jsxs("div",{className:"flex items-center gap-3 animate-in fade-in slide-in-from-right-5",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase",children:"Repair Complete"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Added ",u.fixed," items, Cleaned ",u.cleaned," dupes."]})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl font-bold text-xs shadow-lg shadow-emerald-500/30",children:"Close & Continue"})]}):!r.isHealthy&&e.jsxs("button",{onClick:n,disabled:l,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-xs flex items-center gap-2 shadow-lg shadow-indigo-500/30 transition-all active:scale-95 disabled:opacity-70 disabled:active:scale-100",children:[l?e.jsx(f,{name:"Loader",className:"animate-spin"}):e.jsx(f,{name:"Wand2"}),l?"AI is Fixing...":"Auto-Repair Issues with AI"]})]})]})}),us=(t,s,r,a)=>{const[i,n]=c.useState(t),[l,u]=c.useState(!1),o=c.useRef(null),d=c.useRef(t),x=c.useCallback(()=>u(!0),[]),h=c.useCallback(()=>u(!1),[]);return c.useEffect(()=>{l||(n(t),d.current=t)},[t,l]),c.useEffect(()=>{const k=w=>{if(l&&o.current){const j=Math.max(s,Math.min(w.clientX,r));d.current=j,o.current.style.width=`${j}px`}},g=()=>{l&&(h(),document.body.style.cursor="",document.body.style.userSelect="",n(d.current),a&&a(d.current))};return l&&(window.addEventListener("mousemove",k),window.addEventListener("mouseup",g),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",g),document.body.style.cursor="",document.body.style.userSelect=""}},[l,s,r,h,a]),{width:i,isResizing:l,sidebarRef:o,startResizing:x}},xs=(t,s,r)=>c.useMemo(()=>{if(!s||!t[s])return{isHealthy:!1,score:0,integrity:[],completeness:[]};const a=t[s],i=[],n=[],l=a.groups.flatMap(p=>p.clauses),u=p=>p.reduce((m,N)=>(m.push(N),N.subClauses&&m.push(...u(N.subClauses)),m),[]),o=u(l),d=o.filter(p=>!p.description||p.description.trim().length<2).length;i.push({label:"Content Quality",status:d===0?"pass":"fail",detail:d===0?"Descriptions OK":`${d} incomplete`});const x=new Set(o.map(p=>p.code)),h=o.length-x.size;if(i.push({label:"Data Cleanliness",status:h===0?"pass":"fail",detail:h===0?"Clean":`${h} Duplicates`}),r&&r.length>1e3){let p=0;const m=o.slice(0,20);m.forEach(L=>{r.includes(L.code)||p++});const N=p/m.length,A=N<.2;n.push({label:"Source Verification",status:A?"pass":"fail",detail:A?"Matches Document":`${(N*100).toFixed(0)}% Clauses Missing in Source`})}else n.push({label:"Source Verification",status:"fail",detail:"No Source Document Linked"});if(s.includes("9001")&&["8.4","8.6","8.7","7.1.4"].forEach(m=>{const N=o.some(A=>A.code===m);n.push({label:`Clause ${m}`,status:N?"pass":"fail",detail:N?"Present":"Missing (Required)"})}),s.includes("27001")){const p=o.filter(N=>N.code.startsWith("A.")),m=p.length>=90;n.push({label:"Annex A Controls",status:m?"pass":"fail",detail:m?`${p.length} Controls (OK)`:`${p.length}/93 (Incomplete)`})}const k=i.every(p=>p.status==="pass"),g=n.every(p=>p.status==="pass"),w=k&&g,j=i.length+n.length,y=i.filter(p=>p.status==="pass").length+n.filter(p=>p.status==="pass").length,C=Math.round(y/(j||1)*100);return{isHealthy:w,score:C,integrity:i,completeness:n}},[t,s,r]),Le=t=>{t&&(navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).catch(()=>qe(t)):qe(t))},qe=t=>{const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-9999px",document.body.appendChild(s),s.focus(),s.select();try{document.execCommand("copy")}catch(r){console.error(r)}document.body.removeChild(s)},ps=t=>new Promise((s,r)=>{const a=new FileReader;a.readAsDataURL(t),a.onload=()=>s(a.result.split(",")[1]),a.onerror=i=>r(i)}),hs=async t=>{if(!window.pdfjsLib)throw new Error("PDF.js library not loaded");const s=await t.arrayBuffer(),r=await window.pdfjsLib.getDocument({data:s}).promise;let a="";for(let i=1;i<=r.numPages;i++){const u=(await(await r.getPage(i)).getTextContent()).items.map(o=>o.str).join(" ");a+=u+`

`}return a},ze=async t=>{let s="";try{if(t.name.toLowerCase().endsWith(".pdf"))s=await hs(t);else if(t.name.toLowerCase().endsWith(".docx")){if(typeof mammoth>"u")throw new Error("Mammoth library missing");const r=await t.arrayBuffer();s=(await mammoth.extractRawText({arrayBuffer:r})).value}else{if(t.name.toLowerCase().endsWith(".doc"))throw new Error("Legacy Word (.doc) files are not supported due to browser limitations. Please save your file as .docx and try again.");s=await t.text()}if(!s||s.length<50)throw new Error("File content is too short or empty.");return s}catch(r){throw console.error("File processing error:",r),new Error(`Failed to parse ${t.name}: ${r.message}`)}},gs=t=>{if(!t)return null;let s=t.trim();s.startsWith("```")&&(s=s.replace(/^```(json)?/,"").replace(/```$/,""));const r=s.indexOf("["),a=s.indexOf("{"),i=s.lastIndexOf("]"),n=s.lastIndexOf("}");r!==-1&&i!==-1&&(a===-1||r<a)?s=s.substring(r,i+1):a!==-1&&n!==-1&&(s=s.substring(a,n+1));try{return JSON.parse(s)}catch{return console.error("JSON Parse Error on text:",s),null}},we=t=>t?t.replace(/[^a-zA-Z0-9\s]/g,"").trim().replace(/\s+/g,"_").substring(0,30):"N_A",ms=(t,s)=>{let r="",a=!1;return s.forEach(i=>{const n=t[i];n&&n.some(l=>l.status==="supplied")&&(a=!0,r+=`
### EVIDENCE MATRIX FOR CLAUSE ${i}
`,r+=`| Requirement | Verified Evidence |
`,r+=`| :--- | :--- |
`,n.forEach(l=>{l.evidenceInput.trim()&&(r+=`| ${l.requirement.replace(/\|/g,"-")} | ${l.evidenceInput.replace(/\|/g,"-").replace(/\n/g," ")} |
`)}),r+=`
`)}),a?r:""},fs=t=>{let s=2166136261;for(let r=0;r<t.length;r++)s^=t.charCodeAt(r),s=Math.imul(s,16777619);return(s>>>0).toString(16)};async function bs(t,s,r=3){const a=[],i=[];for(const d of t){const x=s(d).then(h=>a.push(h));i.push(x),i.length>=r&&await Promise.race(i)}const n=[...t],l=[],u=async()=>{for(;n.length>0;){const d=n.shift();if(d){const x=await s(d);l.push(x)}}},o=Array(Math.min(t.length,r)).fill(null).map(()=>u());return await Promise.all(o),l}const Re={ANALYSIS:{id:"default_analysis",label:"Standard Analysis",description:"Strict ISO compliance check based on evidence.",isSystemDefault:!0,template:`
        Analyze the provided EVIDENCE against ISO Standard "{{STANDARD_NAME}}", Clause "{{CLAUSE_CODE}}: {{CLAUSE_TITLE}}".
        Clause Requirement: {{CLAUSE_DESC}}
        
        CONTEXT (Retrieved from Knowledge Base):
        """
        {{RAG_CONTEXT}}
        """

        EVIDENCE (User Input & Tags):
        """
        {{EVIDENCE}}
        """
        
        CROSS-REFERENCE CHECK:
        Check if this evidence also relates to other common ISO standards (like ISO 9001 if auditing 27001, or vice versa).

        DETERMINE:
        1. Status (COMPLIANT, NC_MINOR, NC_MAJOR, OFI, or N_A).
        2. Reason (Why? Be specific based on evidence).
        3. Evidence Quote (Verbatim support).
        4. Suggestion (If NC or OFI).
        5. CrossRefs (Array of strings, e.g. ["ISO 9001: 7.5.3"]).
        
        Output a SINGLE JSON Object.
        `},REPORT:{id:"system_integration_report_v3_full_evidence",label:"Process-Based Integration Format (Full Evidence)",description:"Plain Text format preserving exact evidence structure.",isSystemDefault:!0,template:`
        ROLE: ISO Audit Data Processor.
        TASK: Convert audit findings into a STRICT PLAIN TEXT format for legacy system integration, GROUPED BY PROCESS.

        CRITICAL FORMATTING RULES:
        1. OUTPUT MUST BE PLAIN TEXT ONLY.
        2. Group findings by PROCESS Name.
        3. List Interviewees for each process.
        4. CRITICAL: For 'VERIFIED_EVIDENCE', you MUST output the EXACT, FULL text provided in the input JSON for that finding. 
           - Do NOT summarize, truncate, or reformat. 
           - KEEP ALL original line breaks, bullet points, and spacing exactly as they appear in the source.
           - If the evidence spans multiple lines, print them exactly as is.
        5. Use exactly "====================" (20 dashes) as a separator between clauses.

        REQUIRED STRUCTURE:

        PROCESS: [Process Name]
        INTERVIEWEES: [List of names]

        [Repeat for each finding in this process]
        CLAUSE_ID: [Code]
        CLAUSE_TITLE: [Title]
        STATUS: [Status]
        FINDING_DETAIL: [Reasoning]
        VERIFIED_EVIDENCE:
        [...Insert the exact full raw text of the evidence here, preserving all line breaks...]
        ====================

        INPUT CONTEXT:
        Entity: {{COMPANY}}
        Standard: {{STANDARD_NAME}}
        Auditor: {{AUDITOR}}
        Target Language: {{LANGUAGE}}

        FINDINGS DATA (Aggregated by Process):
        {{FINDINGS_JSON}}

        FULL EVIDENCE CONTEXT:
        """
        {{FULL_EVIDENCE_CONTEXT}}
        """
        `}};class vs{constructor(){Ae(this,"prompts");this.prompts={...Re},this.loadUserOverrides()}loadUserOverrides(){try{const s=localStorage.getItem("iso_prompt_overrides");if(s){const r=JSON.parse(s);this.prompts={...this.prompts,...r}}}catch(s){console.error("Failed to load prompt overrides",s)}}getPrompt(s){return this.prompts[s]||Re[s]}updatePrompt(s,r){this.prompts[s]={...this.prompts[s],template:r,isSystemDefault:!1},localStorage.setItem("iso_prompt_overrides",JSON.stringify(this.prompts))}resetToDefault(s){this.prompts[s]={...Re[s]},localStorage.setItem("iso_prompt_overrides",JSON.stringify(this.prompts))}hydrate(s,r){let a=s;for(const[i,n]of Object.entries(r)){const l=new RegExp(`{{${i}}}`,"g");a=a.replace(l,n||"")}return a}}const ye=new vs,ks="ISO_VECTOR_DB",he="vectors",js=1,ys=(t,s)=>{let r=0,a=0,i=0;for(let n=0;n<t.length;n++)r+=t[n]*s[n],a+=t[n]*t[n],i+=s[n]*s[n];return r/(Math.sqrt(a)*Math.sqrt(i))};class ws{constructor(){Ae(this,"dbPromise",null)}openDB(){return this.dbPromise?this.dbPromise:(this.dbPromise=new Promise((s,r)=>{const a=indexedDB.open(ks,js);a.onupgradeneeded=i=>{const n=i.target.result;n.objectStoreNames.contains(he)||n.createObjectStore(he,{keyPath:"id"}).createIndex("source","metadata.source",{unique:!1})},a.onsuccess=i=>s(i.target.result),a.onerror=i=>r(i.target.error)}),this.dbPromise)}async embedText(s,r){var a,i;if(!s||!s.trim())return null;try{return((i=(a=(await new $e({apiKey:r}).models.embedContent({model:"text-embedding-004",contents:{parts:[{text:s}]}})).embeddings)==null?void 0:a[0])==null?void 0:i.values)||null}catch(n){return console.error("Embedding Error",n),null}}async addDocuments(s,r,a){const i=r.match(/[\s\S]{1,800}/g)||[],u=(await this.openDB()).transaction([he],"readwrite").objectStore(he);let o=0;for(const d of i){const x=await this.embedText(d,a);if(x){const h={id:`${s}_${o++}_${Date.now()}`,text:d,embedding:x,metadata:{source:s,type:"standard_content"}};u.put(h)}await new Promise(h=>setTimeout(h,50))}}async search(s,r,a=4){const i=await this.embedText(s,r);if(!i)return"";const n=await this.openDB();return new Promise(l=>{const d=n.transaction([he],"readonly").objectStore(he).openCursor(),x=[];d.onsuccess=h=>{const k=h.target.result;if(k){const g=k.value,w=ys(i,g.embedding);w>.5&&x.push({text:g.text,score:w}),k.continue()}else{x.sort((w,j)=>j.score-w.score);const g=x.slice(0,a).map(w=>w.text).join(`

---

`);l(g)}}})}async clear(){(await this.openDB()).transaction([he],"readwrite").objectStore(he).clear()}}const Ns=new ws,Cs={patterns:{email:/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,phoneVN:/(\+84|0)(3|5|7|8|9)([0-9]{8})\b/g,ipAddress:/\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/g,potentialName:new RegExp("(?<!^|\\. |\\? |! )([A-Z][a-z]+ [A-Z][a-z]+)","g")},redact(t,s,r){if(!t)return"";let a=t;if(!s)return a;if(r){if(s.maskCompany&&r.company&&r.company.length>2){const i=r.company.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");a=a.replace(new RegExp(i,"gi"),"[COMPANY_REDACTED]")}if(s.maskSmo&&r.smo&&r.smo.length>2){const i=r.smo.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");a=a.replace(new RegExp(i,"gi"),"[SMO_REDACTED]")}if(s.maskPeople&&r.auditor&&r.auditor.length>2){const i=r.auditor.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");a=a.replace(new RegExp(i,"gi"),"[AUDITOR_REDACTED]")}}return s.maskEmail&&(a=a.replace(this.patterns.email,"[EMAIL_REDACTED]")),s.maskPhone&&(a=a.replace(this.patterns.phoneVN,"[PHONE_REDACTED]")),s.maskIP&&(a=a.replace(this.patterns.ipAddress,"[IP_REDACTED]")),s.maskAddress&&(a=a.replace(/\d+\s+[A-Za-z]+\s+(Street|St|Ave|Avenue|Road|Rd|Lane|Ln|Ward|District)/gi,"[ADDRESS_REDACTED]")),(a.toLowerCase().includes("salary")||a.toLowerCase().includes("lng"))&&(a=a.replace(/(\d{1,3}[,.]\d{3}[,.]\d{3}|\d{7,})/g,"[MONEY_REDACTED]")),a}},Ie={NC_MAJOR:["systemic failure","total breakdown","missing process","khng c quy trnh","cha thit lp","critical","nghim trng"],NC_MINOR:["isolated","single instance","partial","not fully","cha y ","mt s","incomplete","li nh"],OFI:["improve","better","consider","cn nhc","ci tin","optimize","efficiency"],COMPLIANT:["conforms","available","maintained","ph hp","y ","tun th","verified","t"]},Oe={analyze(t,s,r){const a=r.toLowerCase();let i="N_A",n="Offline Analysis: Insufficient data to determine compliance.",l="",u={MAJOR:0,MINOR:0,OFI:0,COMPLIANT:0};Ie.NC_MAJOR.forEach(d=>{a.includes(d)&&(u.MAJOR+=2)}),Ie.NC_MINOR.forEach(d=>{a.includes(d)&&(u.MINOR+=1)}),Ie.OFI.forEach(d=>{a.includes(d)&&(u.OFI+=1)}),Ie.COMPLIANT.forEach(d=>{a.includes(d)&&(u.COMPLIANT+=1)}),u.MAJOR>0?(i="NC_MAJOR",n="Offline Analysis detected critical keywords indicating a systemic issue.",l="Review the entire process and establish missing controls immediately."):u.MINOR>u.COMPLIANT?(i="NC_MINOR",n="Offline Analysis detected potential gaps in implementation.",l="Investigate specific instances and correct them."):u.OFI>0?(i="OFI",n="Opportunities for improvement found in text.",l="Consider optimizing based on best practices."):u.COMPLIANT>0?(i="COMPLIANT",n="Evidence suggests requirements are met."):r.length>50&&(i="COMPLIANT",n="Offline Analysis: No obvious non-conformity keywords detected.");const o={clauseId:t,status:i,reason:n,evidence:r.substring(0,100)+"...",suggestion:l,conclusion_report:`[OFFLINE] ${n}`,crossRefs:[]};return JSON.stringify(o)},extractClauseContent(t,s,r){if(!t)return null;const a=t.replace(/\r\n/g,`
`).replace(/[ \t]+/g," "),i=s.replace(/\./g,"\\."),n=r.split(" ")[0].replace(/[^a-zA-Z0-9]/g,""),l=new RegExp(`(?:^|\\n)\\s*${i}\\.?\\s+.*${n}`,"i"),u=new RegExp(`(?:^|\\n)\\s*${i}\\.?\\s+`,"i");let o=a.match(l);if(o||(o=a.match(u)),o&&o.index!==void 0){const d=o.index,x=s.split(".").map(Number),h=x[x.length-1],k=[...x];k[k.length-1]=h+1;const g=k.join("\\."),w=(x[0]+1).toString(),j=a.substring(d+o[0].length),y=new RegExp(`(?:^|\\n)\\s*(${g}|${w}\\.|${w}\\s|Annex|Bibliography)`,"i"),C=j.match(y);let p="";if(C&&C.index!==void 0)p=o[0]+j.substring(0,C.index);else{const m=/(?:^|\n)\s*\d{1,2}\.\d{1,2}(\.\d{1,2})?\s+[A-Z]/,N=j.match(m);N&&N.index!==void 0&&N.index>50?p=o[0]+j.substring(0,N.index):p=o[0]+j.substring(0,3e3)}return p.trim()}return null}},Ss={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var As={};const ge=t=>{let s=t;if(!s&&De.length>0&&(s=De[0]),!s)try{typeof import.meta<"u"}catch{}if(!s&&typeof process<"u"&&As&&(s=""),!s)try{const a=localStorage.getItem("iso_api_keys"),i=localStorage.getItem("iso_active_key_id");if(a){const n=JSON.parse(a);if(Array.isArray(n)&&n.length>0){const l=n.find(u=>u.id===i);s=l?l.key:n[0].key}}}catch{}const r=(s||"").trim();return r?new $e({apiKey:r}):null},st=new Map,Es=t=>{const s=st.get(t);return s?Date.now()>s:!0},Is=t=>{console.warn(`[Smart Rotator]  Model ${t} hit rate limit. Cooling down for 60s.`),st.set(t,Date.now()+6e4)},Ls=t=>new Promise(s=>setTimeout(s,t)),me=async(t,s,r)=>{const a=[t,...Ht],i=[...new Set(a)].filter(u=>u&&!u.includes("1.5"));let n=i.filter(u=>Es(u));n.length===0&&(console.warn("[Smart Rotator] All models in cooldown. Forcing retry on fallback."),n=["gemini-2.0-flash-lite-preview-02-05",...i]);let l=null;for(const u of n)try{console.log(`[${s}]  Attempting with: ${u}...`);const o=await r(u);if(o&&o.text)return o.text}catch(o){l=o;const d=(o.message||"").toLowerCase(),x=o.status||o.code||0;if(console.warn(`[${s}]  Failed on ${u}: ${d}`),x===429||d.includes("exhausted")||d.includes("too many requests"))Is(u);else{if(x===403||d.includes("key not valid")||d.includes("api_key_invalid"))throw new Error("Invalid API Key. Please check your settings.");x===404||d.includes("not found")}await Ls(500)}throw new Error(`All AI models failed. Last error: ${(l==null?void 0:l.message)||"Unknown"}`)},Ms=async t=>{const s=t?t.trim().replace(/^["']|["']$/g,""):"";if(!s)return{isValid:!1,latency:0,errorType:"invalid",errorMessage:"Key is empty"};const r=new $e({apiKey:s}),a=["gemini-2.0-flash","gemini-3-flash-preview"];for(const i of a){const n=performance.now();try{return await r.models.generateContent({model:i,contents:{parts:[{text:"Hi"}]}}),{isValid:!0,latency:Math.round(performance.now()-n),activeModel:i}}catch(l){if((l.message||"").toLowerCase().includes("key")||l.status===403)return{isValid:!1,latency:0,errorType:"invalid",errorMessage:"Invalid API Key."}}}return{isValid:!0,latency:999,activeModel:"gemini-2.0-flash"}},rt=async(t,s,r,a,i,n,l=!1)=>{if(!navigator.onLine)return Oe.analyze(t.code,t.title,r);const u=ge(i);if(!u)throw new Error("API Key missing");const o=`${t.code} ${t.title} ${t.description}`,d=i||"",x=await Ns.search(o,d);let h=r+`

TAGGED SECTIONS:
`+a;l&&(h=Cs.redact(h));const k=ye.getPrompt("ANALYSIS"),g=ye.hydrate(k.template,{STANDARD_NAME:s,CLAUSE_CODE:t.code,CLAUSE_TITLE:t.title,CLAUSE_DESC:t.description,RAG_CONTEXT:x||"No source document available for vector search.",EVIDENCE:h}),w={responseMimeType:"application/json",responseSchema:{type:xe.OBJECT,properties:{clauseId:{type:xe.STRING},status:{type:xe.STRING,enum:["COMPLIANT","NC_MINOR","NC_MAJOR","OFI","N_A"]},reason:{type:xe.STRING},suggestion:{type:xe.STRING},evidence:{type:xe.STRING},conclusion_report:{type:xe.STRING},crossRefs:{type:xe.ARRAY,items:{type:xe.STRING}}},required:["clauseId","status","reason","evidence"]}};try{return await me(n||Ye,"Analysis",y=>u.models.generateContent({model:y,contents:g,config:w}))||"{}"}catch(j){return console.error("All Analysis Models Failed",j),Oe.analyze(t.code,t.title,r)}},it=async(t,s,r)=>{const a=ge(s);if(!a)throw new Error("API Key missing");const i=`
    ROLE: ISO Technical Reviewer.
    TASK: Critique this finding:
    Clause: ${t.clauseId} (${t.status})
    Evidence: "${t.evidence}"
    Reason: "${t.reason}"
    
    Output max 100 words critique.
    `;try{return await me(r||"gemini-2.0-flash","Shadow Review",n=>a.models.generateContent({model:n,contents:i}))}catch{return"Review unavailable (API Error)."}},at=async(t,s,r)=>{const a=ge(s);if(!a)throw new Error("API Key missing");const i=`
    ROLE: ISO Lead Auditor.
    TASK: Write a professional Executive Summary for an ISO Audit Report.
    
    CONTEXT:
    Company: ${t.company}
    Address: ${t.address||"N/A"}
    Audit Scope: ${t.scope||"N/A"}
    Statement of Applicability (SoA): ${t.soa||"N/A"}
    Standard: ${t.standard}
    Audit Type: ${t.type}
    Auditor: ${t.auditor}
    
    FINDINGS SUMMARY:
    Total Findings: ${t.findings.length}
    Major NCs: ${t.findings.filter(n=>n.status==="NC_MAJOR").length}
    Minor NCs: ${t.findings.filter(n=>n.status==="NC_MINOR").length}
    OFIs: ${t.findings.filter(n=>n.status==="OFI").length}
    
    LANGUAGE: ${t.lang==="vi"?"Vietnamese":"English"}
    
    OUTPUT FORMAT: Plain Text. Concise paragraphs covering:
    1. Overall Compliance Status.
    2. Confirmation of Audit Scope and Site Address (Confirm if scope was covered adequately).
    3. Key Strengths.
    4. Major Areas for Improvement.
    5. Recommendation for Certification (Yes/No/Conditional).
    `;try{return await me(r||"gemini-3-pro-preview","Exec Summary",n=>a.models.generateContent({model:n,contents:i}))}catch{return"Executive Summary could not be generated."}},nt=async(t,s,r,a)=>{const i=ge(r);if(!i||!navigator.onLine)return`
        CLAUSE: ${t.clauseId}
        STATUS: ${t.status}
        FINDING: ${t.reason}
        EVIDENCE:
        ${t.evidence}
        `;const n=`
    ROLE: Audit Reporter.
    TASK: Format this single audit finding into a final report section.
    LANGUAGE: ${s==="vi"?"Vietnamese":"English"}
    
    INPUT:
    Clause: ${t.clauseId}
    Status: ${t.status}
    Observation: "${t.reason}"
    Evidence Block:
    """
    ${t.evidence}
    """
    
    RULES:
    1. Polish the 'Observation' to be professional.
    2. CRITICAL: For 'Verified Evidence', print the content of 'Evidence Block' VERBATIM. 
       - DO NOT summarize.
       - DO NOT remove bullets, dashes, or line breaks. 
       - DO NOT reformat list items into paragraphs.
       - Keep it exactly as provided in the block.
    3. Output in Markdown.
    
    OUTPUT TEMPLATE:
    ### Clause ${t.clauseId} - ${t.status}
    **Observation:** [Polished Observation]
    **Verified Evidence:**
    [Insert Exact Evidence Block Here]
    `;try{return await me("gemini-2.0-flash",`Report Section ${t.clauseId}`,l=>i.models.generateContent({model:l,contents:n}))}catch{return`### Clause ${t.clauseId}
Error formatting section. Raw data:
${t.reason}
${t.evidence}`}},ot=async(t,s,r,a)=>{const i=ge(a);if(!i)throw new Error("API Key missing");const n={parts:[{inlineData:{mimeType:r,data:s}},{text:t}]};try{return await me(Wt,"OCR",l=>i.models.generateContent({model:l,contents:n}))}catch{return""}},Ts=async(t,s,r)=>{if(!t.trim())return"";const a=ge(r);if(!a)throw new Error("API Key missing");const i=`Translate to ${s==="vi"?"Vietnamese":"English"}. Keep formatting.

${t}`;try{return await me("gemini-2.0-flash","Translation",n=>a.models.generateContent({model:n,contents:i}))}catch{return t}},lt=async t=>"[]",dt=async(t,s,r,a)=>{const i=ge(a);if(!i)return{en:"API Key missing",vi:""};const n=`
    ROLE: ISO Standard Expert.
    TASK: Provide the full official text (or detailed summary if copyrighted) for:
    Standard: ${s}
    Clause: ${t.code} - ${t.title}
    
    CONTEXT (from user document):
    """
    ${r?r.substring(0,3e3):"No local context provided."}
    """

    OUTPUT: JSON Object with keys:
    - en: English text
    - vi: Vietnamese translation
    `;try{const l=await me(Ye,"Fetch Clause Text",u=>i.models.generateContent({model:u,contents:n,config:{responseMimeType:"application/json"}}));return JSON.parse(l)}catch(l){return console.error("Fetch Clause Failed",l),{en:"Content unavailable due to API error.",vi:""}}},ct=async(t,s,r)=>{const a=ge();if(!a)return{};const i=r.length>5e4?r.substring(0,5e4)+"...":r,n=`
    ROLE: ISO Analyst.
    TASK: Map the following Clause Codes to their Description/Requirement text found in the document.
    
    STANDARD: ${t}
    CODES TO FIND: ${JSON.stringify(s)}
    
    DOCUMENT CONTENT:
    """
    ${i}
    """
    
    OUTPUT: JSON Object { "CODE": "Description text extracted from document" }.
    Only include found codes.
    `;try{const l=await me("gemini-2.0-flash","Map Requirements",u=>a.models.generateContent({model:u,contents:n,config:{responseMimeType:"application/json"}}));return JSON.parse(l)}catch(l){return console.error("Mapping Failed",l),{}}},He=Object.freeze(Object.defineProperty({__proto__:null,fetchFullClauseText:dt,formatFindingReportSection:nt,generateAnalysis:rt,generateExecutiveSummary:at,generateMissingDescriptions:lt,generateOcrContent:ot,mapStandardRequirements:ct,performShadowReview:it,translateChunk:Ts,validateApiKey:Ms},Symbol.toStringTag,{value:"Module"})),Rs=()=>{const{standards:t,standardKey:s,addCustomStandard:r,setKnowledgeData:a}=oe(),{showToast:i}=de(),[n,l]=c.useState(!1);return{handleKnowledgeUpload:async o=>{if(!o.target.files||o.target.files.length===0)return;const d=o.target.files[0];l(!0);try{i("Processing document...");const x=await ze(d);if(x.length<100&&i("Warning: Document text is very short."),s){await _e.saveDocument(s,d.name,x);const h=t[s];if(h){i("Analyzing document structure (this may take 30s)...");const k=[],g=C=>C.forEach(p=>{k.push(p),p.subClauses&&g(p.subClauses)});h.groups.forEach(C=>g(C.clauses));const w=k.map(C=>C.code),j=10;let y={};for(let C=0;C<w.length;C+=j){const p=w.slice(C,C+j),m=Math.round(C/w.length*100);m>0&&i(`Mapping content: ${m}%`);try{const N=await ct(h.name,p,x);y={...y,...N}}catch(N){console.warn("Batch mapping failed",N)}}if(Object.keys(y).length>0){const C=JSON.parse(JSON.stringify(h)),p=m=>{m.forEach(N=>{y[N.code]&&(N.description=y[N.code]),N.subClauses&&p(N.subClauses)})};C.groups.forEach(m=>p(m.clauses)),r(s,C),i(`Success! Enriched ${Object.keys(y).length} clauses.`)}else i("Analysis complete, but no matching clauses found.")}}a(x,d.name),o.target.value=""}catch(x){console.error("Knowledge Upload Error",x),i(`Upload Failed: ${x.message}`)}finally{l(!1)}},isProcessing:n}},Ps=()=>{const{standards:t,standardKey:s,updateStandard:r}=oe(),[a,i]=c.useState(!1),[n,l]=c.useState(null),[u,o]=c.useState([]);return{handleAutoRepair:async()=>{if(!(!s||!t[s])){i(!0),l(null);try{const x=JSON.parse(JSON.stringify(t[s])),h=[],k=[];let g=0;const w=j=>{j.forEach(y=>{(!y.description||y.description.trim().length<5)&&h.push({ref:y,code:y.code,title:y.title}),y.subClauses&&w(y.subClauses)})};if(x.groups.forEach(j=>w(j.clauses)),h.length>0){const j=h.map(p=>({code:p.code,title:p.title})),y=await lt(j),C=gs(y);if(Array.isArray(C)){const p=C.reduce((m,N)=>(N.code&&N.description&&(m[N.code]=N.description),m),{});h.forEach(m=>{p[m.code]&&(m.ref.description=p[m.code],k.push(m.ref.id))})}}r(x),o(k),l({fixed:k.length,cleaned:g})}catch(x){console.error("Repair failed",x),alert("Failed to repair automatically. Check API Key.")}finally{i(!1)}}},isRepairing:a,repairStats:n,repairedIds:u}},Ds=ve.memo(({isOpen:t,width:s,setWidth:r})=>{const[a,i]=c.useState(!0),{isResizing:n,sidebarRef:l,startResizing:u}=us(s,300,800,r),{handleKnowledgeUpload:o}=Rs(),{handleAutoRepair:d,isRepairing:x,repairStats:h}=Ps(),{standards:k,standardKey:g,setStandardKey:w,resetStandard:j,auditInfo:y,knowledgeBase:C}=oe(),{modals:p,toggleModal:m}=de(),N=xs(k,g,C),A=[...Object.keys(k).map(_=>({value:_,label:k[_].name})),{value:"ADD_NEW",label:"+ Add New Standard..."}],L=(()=>{let E=0;return g&&E++,y.type&&E++,y.company&&E++,y.auditor&&E++,Math.min(4,E)})();return e.jsxs("div",{ref:l,className:`${t?"border-r":"w-0 border-0 overflow-hidden"} flex flex-col bg-white dark:bg-slate-900 border-gray-200 dark:border-slate-800 shadow-2xl z-50 relative shrink-0 ${n?"transition-none":"transition-[width] duration-300 ease-soft"} h-full`,style:{width:t?window.innerWidth<768?"100%":s:0},children:[t&&e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1.5 cursor-col-resize hover:bg-indigo-500 transition-colors z-50 group resize-handle hidden md:block",onMouseDown:E=>{E.preventDefault(),u()}}),e.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-900 w-full md:min-w-[390px] flex flex-col transition-all duration-400 ease-soft overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-6 cursor-pointer group select-none hover:bg-gray-50 dark:hover:bg-slate-800/50 border-b border-gray-200 dark:border-slate-800",onClick:()=>i(!a),children:[e.jsxs("h3",{className:"text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2 group-hover:text-indigo-500 transition-colors",children:[e.jsx(f,{name:"Session8_Flag",size:14,className:"text-indigo-500"}),"Audit Details"]}),e.jsxs("div",{className:"flex gap-4 items-center",onClick:E=>E.stopPropagation(),children:[e.jsx("div",{className:"flex gap-1 items-center",children:[1,2,3,4].map(E=>e.jsx("div",{className:`w-3 h-1 rounded-full ${E<=L?"bg-indigo-500":"bg-gray-200 dark:bg-slate-700"}`},E))}),e.jsx(f,{name:"ChevronDown",size:14,className:`text-slate-400 transition-transform duration-300 ${a?"rotate-180":""}`})]})]}),e.jsx("div",{className:`flex-1 min-h-0 grid transition-all duration-300 ease-in-out ${a?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,children:e.jsx("div",{className:"overflow-hidden flex flex-col",children:e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 pt-2 pb-6",children:e.jsx(ds,{onAddNewStandard:()=>m("addStandard",!0),onOpenIntegrity:()=>m("integrity",!0),onKnowledgeUpload:o,health:N,auditFieldIconColor:"text-indigo-700 dark:text-indigo-400",standardOptions:A})})})})]}),e.jsx(cs,{isOpen:p.integrity,onClose:()=>m("integrity",!1),health:N,isCustomStandard:!!g&&!Ze[g],onResetStandard:()=>{j(g),m("integrity",!1)},onAutoRepair:d,isRepairing:x,repairStats:h})]})}),_s=({isOpen:t,onClose:s,settings:r,setSettings:a})=>{const i=u=>{a({...r,[u]:!r[u]})},n=u=>{a({maskCompany:u,maskSmo:u,maskPeople:u,maskEmail:u,maskPhone:u,maskAddress:u,maskIP:u})},l=(u,o,d,x)=>e.jsxs("div",{onClick:()=>i(o),className:`flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all ${r[o]?"bg-indigo-50 border-indigo-200 dark:bg-indigo-900/20 dark:border-indigo-800":"bg-white border-gray-100 dark:bg-slate-900 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${r[o]?"bg-indigo-100 text-indigo-600 dark:bg-indigo-900/40 dark:text-indigo-300":"bg-gray-100 text-slate-400 dark:bg-slate-800"}`,children:e.jsx(f,{name:d,size:18})}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm font-bold ${r[o]?"text-indigo-900 dark:text-indigo-100":"text-slate-600 dark:text-slate-400"}`,children:u}),e.jsx("p",{className:"text-[10px] text-slate-400",children:x})]})]}),e.jsx("div",{className:`w-10 h-5 rounded-full relative transition-colors ${r[o]?"bg-emerald-500":"bg-slate-200 dark:bg-slate-700"}`,children:e.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white shadow-sm transition-all ${r[o]?"left-6":"left-1"}`})})]});return e.jsx(Ce,{isOpen:t,title:"Privacy Shield Configuration",onClose:s,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-2xl border border-indigo-100 dark:border-indigo-800 flex items-start gap-3",children:[e.jsx(f,{name:"ShieldEye",className:"text-indigo-600 dark:text-indigo-400 mt-1",size:24}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-900 dark:text-indigo-100",children:"Data Redaction Active"}),e.jsxs("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mt-1 leading-relaxed",children:["Selected information types will be replaced with placeholders (e.g., [EMAIL_REDACTED]) ",e.jsx("strong",{children:"before"})," sending data to the AI API. This processing happens entirely in your browser."]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pb-2",children:[e.jsx("button",{onClick:()=>n(!0),className:"text-[10px] font-bold text-indigo-600 hover:underline",children:"Select All"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("button",{onClick:()=>n(!1),className:"text-[10px] font-bold text-slate-500 hover:text-slate-700 hover:underline",children:"Clear All"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 max-h-[40vh] overflow-y-auto custom-scrollbar pr-1",children:[l("Company Name","maskCompany","Building","Matches exact name from Audit Charter"),l("SMO / ID","maskSmo","Tag","Matches SMO code from Audit Charter"),l("Person Names","maskPeople","Users","Matches Auditor & Interviewee names"),l("Emails","maskEmail","Demo12_Attach","Standard email patterns"),l("Phone Numbers","maskPhone","Demo6_BoxUp","Vietnamese & Intl phone patterns"),l("Addresses","maskAddress","Demo13_Meteor","Street/District patterns"),l("IP Addresses","maskIP","Demo11_Scan","IPv4 server addresses")]}),e.jsx("div",{className:"pt-4 border-t border-gray-100 dark:border-slate-800",children:e.jsx("button",{onClick:s,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-500/30 transition-all active:scale-95",children:"Save & Apply Shield"})})]})})},Os=({isOpen:t,onClose:s,onRestore:r})=>{const[a,i]=c.useState([]),[n,l]=c.useState(null);c.useEffect(()=>{t&&u()},[t]);const u=()=>{var h,k,g;try{const w=localStorage.getItem("iso_session_data");if(w){const y=JSON.parse(w),C=((h=y.evidence)==null?void 0:h.trim())||((k=y.selectedClauses)==null?void 0:k.length)>0||((g=y.auditInfo)==null?void 0:g.company);l(C?{id:"current_autosave",timestamp:Date.now(),label:"Latest Auto-Save",triggerType:"AUTO_SAVE",data:y}:null)}else l(null);const j=localStorage.getItem("iso_session_history");if(j){const y=JSON.parse(j);i(y.sort((C,p)=>p.timestamp-C.timestamp))}else i([])}catch(w){console.error("Failed to load session history",w)}},o=h=>new Date(h).toLocaleString(),d=h=>{let k=0;h.data.processes&&h.data.processes.length>0?k=h.data.processes.reduce((j,y)=>j+(y.evidence?y.evidence.length:0),0):h.data.scopes&&h.data.scopes.length>0?k=h.data.scopes.reduce((j,y)=>j+(y.evidence?y.evidence.length:0),0):h.data.evidence&&(k=h.data.evidence.length);const g=h.data.selectedClauses?h.data.selectedClauses.length:0,w=h.data.analysisResult?h.data.analysisResult.length:0;return e.jsxs("div",{className:"flex gap-3 mt-2 text-[10px] text-slate-500 font-mono",children:[e.jsxs("span",{className:"flex items-center gap-1 bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:[e.jsx(f,{name:"FileText",size:10})," ",k>0?`${(k/1024).toFixed(1)}KB Evid`:"No Evid"]}),e.jsxs("span",{className:"flex items-center gap-1 bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:[e.jsx(f,{name:"CheckSquare",size:10})," ",g," Clauses"]}),e.jsxs("span",{className:"flex items-center gap-1 bg-slate-100 dark:bg-slate-800 px-1.5 py-0.5 rounded",children:[e.jsx(f,{name:"Wand2",size:10})," ",w," Findings"]})]})},x=(h,k)=>e.jsxs("div",{onClick:()=>r(h),className:`group relative p-4 rounded-2xl border cursor-pointer transition-all duration-300 hover:scale-[1.02] active:scale-95 ${k?"bg-indigo-50/50 dark:bg-indigo-900/20 border-indigo-200 dark:border-indigo-800 ring-1 ring-indigo-500/20":"bg-white dark:bg-slate-900 border-gray-100 dark:border-slate-800 hover:border-indigo-300 dark:hover:border-indigo-700 hover:shadow-lg"}`,children:[e.jsx("div",{className:"flex justify-between items-start mb-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded-full ${k?"bg-indigo-500 text-white shadow-lg shadow-indigo-500/30":"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300"}`,children:k?"ACTIVE STATE":"BACKUP ARCHIVE"}),e.jsx("span",{className:"text-xs text-slate-400 font-mono",children:o(h.timestamp)})]})}),e.jsxs("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 truncate",children:[h.data.auditInfo.company||"Untitled Company",e.jsx("span",{className:"font-normal text-slate-400 mx-1",children:"|"}),h.data.auditInfo.type||"Untitled Audit"]}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate mb-1",children:["Standard: ",we(h.data.standardKey).replace(/_/g," ")]}),d(h),e.jsx("div",{className:"absolute top-1/2 right-4 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-indigo-600 text-white p-2 rounded-full shadow-xl",children:e.jsx(f,{name:"History",size:20})})})]},h.id);return t?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:s,children:e.jsxs("div",{className:"bg-white dark:bg-slate-950 w-full max-w-2xl rounded-3xl shadow-2xl border border-gray-200 dark:border-slate-800 overflow-hidden flex flex-col max-h-[85vh] animate-zoom-in-spring",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-900/50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-black text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx(f,{name:"History",className:"text-indigo-500"}),"Session Time Machine"]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Select a restoration point. This will overwrite your current workspace."})]}),e.jsx("button",{onClick:s,className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-slate-800 text-slate-400 transition-colors",children:e.jsx(f,{name:"X",size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-6 bg-gray-50/30 dark:bg-slate-950",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Available Auto-Save"]}),n?x(n,!0):e.jsx("div",{className:"p-4 border border-dashed border-gray-300 dark:border-slate-700 rounded-xl text-center text-slate-400 text-xs italic",children:"No active auto-save data found."})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[e.jsx(f,{name:"Lock",size:12}),"Backup Vault (Last 5 Resets)"]}),e.jsx("div",{className:"space-y-3",children:a.length>0?a.map(h=>x(h,!1)):e.jsxs("div",{className:"p-8 border border-dashed border-gray-300 dark:border-slate-700 rounded-xl text-center",children:[e.jsx(f,{name:"Archive",className:"mx-auto mb-2 text-slate-300",size:24}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Vault is empty."}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Backups are created automatically when you start a New Session."})]})})]})]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-slate-900 border-t border-gray-100 dark:border-slate-800 text-center",children:e.jsxs("p",{className:"text-[10px] text-slate-400",children:[e.jsx("span",{className:"font-bold text-indigo-500",children:"Pro Tip:"})," Backups are stored locally in your browser. Clearing cache will delete them."]})})]})}):null},$s=({isOpen:t,onClose:s})=>{const[r,a]=c.useState(!1),[i,n]=c.useState("overview");if(c.useEffect(()=>{t&&(a(!1),n("overview"))},[t]),!t)return null;const l=[{id:"overview",label:"Overview",icon:"Session1_SparklePlus"},{id:"guide",label:"User Guide",icon:"BookOpen"},{id:"tech",label:"Architecture",icon:"Cpu"},{id:"changelog",label:"Releases",icon:"History"}],u=[{layer:"Frontend",tech:"React 19 + Vite",role:"Component Lifecycle, State Management",color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-50 dark:bg-blue-900/20"},{layer:"Styling",tech:"Tailwind CSS",role:"Utility-first, Dark mode adaptive, Glassmorphism",color:"text-cyan-600 dark:text-cyan-400",bg:"bg-cyan-50 dark:bg-cyan-900/20"},{layer:"AI Engine",tech:"Google Gemini 3.0",role:"Reasoning, Analysis, Vision OCR",color:"text-amber-600 dark:text-amber-400",bg:"bg-amber-50 dark:bg-amber-900/20"},{layer:"Storage",tech:"IndexedDB + LocalStorage",role:"Vector Store, Session Persistence",color:"text-purple-600 dark:text-purple-400",bg:"bg-purple-50 dark:bg-purple-900/20"}];return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-[9999] p-4 fade-in",onClick:s,children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-2xl w-full max-w-5xl flex flex-col h-[90vh] md:h-[85vh] border border-white/20 dark:border-slate-700/50 transform transition-all scale-100 overflow-hidden relative",onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex-shrink-0 relative overflow-hidden group border-b border-gray-100 dark:border-slate-800",children:[e.jsxs("div",{className:"absolute inset-0 bg-slate-900",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-indigo-600/20 rounded-full blur-[100px] -translate-y-1/2 translate-x-1/2"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-cyan-600/10 rounded-full blur-[80px] translate-y-1/2 -translate-x-1/2"})]}),e.jsx("button",{onClick:s,className:"absolute top-4 right-4 text-slate-400 hover:text-white z-50 p-2 bg-white/10 hover:bg-white/20 rounded-full transition-all backdrop-blur-sm",children:e.jsx(f,{name:"X",size:20})}),e.jsxs("div",{className:"relative px-6 py-8 md:px-10 flex flex-col md:flex-row items-center md:items-start gap-8 z-10",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("div",{className:"relative w-24 h-24 rounded-full p-1 bg-gradient-to-br from-indigo-500 to-cyan-500 shadow-glow mx-auto md:mx-0",children:e.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-slate-950 relative",children:r?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-950",children:e.jsx(f,{name:"TDLogo",size:48})}):e.jsx("img",{src:"./author.png",alt:"Author",className:"w-full h-full object-cover",onError:()=>a(!0)})})})}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsxs("h2",{className:"text-3xl md:text-4xl font-black text-white tracking-tight leading-tight mb-2 drop-shadow-md",children:["ISO Audit ",e.jsx("span",{className:"font-light opacity-80",children:"Pro"})]}),e.jsx("p",{className:"text-slate-300 text-sm font-medium mb-6 max-w-lg mx-auto md:mx-0 leading-relaxed opacity-90",children:"The AI-Powered Compliance Assistant leveraging Gemini 3.0 for intelligent, automated ISO auditing."}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center md:justify-start",children:l.map(o=>e.jsxs("button",{onClick:()=>n(o.id),className:`px-4 py-2 rounded-xl text-xs font-bold flex items-center gap-2 transition-all duration-300 backdrop-blur-md border ${i===o.id?"bg-white/20 border-white/30 text-white shadow-lg":"bg-slate-800/40 border-slate-700/50 text-slate-400 hover:bg-slate-800/60 hover:text-white"}`,children:[e.jsx(f,{name:o.icon,size:14})," ",o.label]},o.id))})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 md:p-10 bg-gray-50/50 dark:bg-slate-950 text-slate-800 dark:text-slate-200",children:[i==="overview"&&e.jsxs("div",{className:"animate-fade-in-up space-y-8",children:[e.jsxs("div",{className:"p-6 rounded-2xl bg-white dark:bg-slate-900 border border-gray-100 dark:border-slate-800 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx(f,{name:"Session10_Pulse",size:100})}),e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4 border-b border-gray-100 dark:border-slate-800 pb-2",children:"System Status"}),e.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-y-3 gap-x-6 items-center relative z-10",children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 text-right",children:"Version"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-mono font-bold text-indigo-600 dark:text-indigo-400 text-sm bg-indigo-50 dark:bg-indigo-900/20 px-2 py-0.5 rounded",children:["v",Kt]}),e.jsx("span",{className:"text-[10px] text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 px-2 py-0.5 rounded font-bold uppercase",children:"Stable"})]}),e.jsx("span",{className:"text-sm font-medium text-slate-500 text-right",children:"Build"}),e.jsx("span",{className:"font-mono text-[10px] text-slate-500 break-words",children:Vt}),e.jsx("span",{className:"text-sm font-medium text-slate-500 text-right",children:"Engine"}),e.jsx("span",{className:"font-mono text-[10px] font-bold text-amber-600 bg-amber-50 dark:bg-amber-900/20 px-2 py-1 rounded w-fit",children:"Gemini 3.0 Pro / Flash"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Yt.map((o,d)=>e.jsxs("div",{className:"p-5 bg-white dark:bg-slate-900 rounded-2xl border border-gray-100 dark:border-slate-800 flex items-start gap-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-xl text-indigo-600 dark:text-indigo-400 shadow-sm",children:e.jsx(f,{name:o.icon,size:20})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-sm text-slate-900 dark:text-white mb-1",children:o.title}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed",children:o.desc})]})]},d))})]}),i==="guide"&&e.jsx("div",{className:"animate-fade-in-up space-y-8 max-w-3xl mx-auto",children:e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-indigo-500 rounded-full"})," Workflow"]}),e.jsx("div",{className:"space-y-4 relative pl-4 border-l-2 border-indigo-100 dark:border-indigo-900/50",children:[{title:"Context Setup",desc:"Select a Standard (ISO 9001/27001) via Sidebar. Upload a source PDF to enable Retrieval-Augmented Generation (RAG)."},{title:"Evidence Collection",desc:"Use the 'Audit' tab. Toggle between Document Mode (Unstructured) and Matrix Mode (Structured). Drop files directly onto matrix rows."},{title:"AI Analysis",desc:"Select clauses and click 'Analyze'. The engine uses a Dual-Stream approach to verify compliance against the standard."},{title:"Reporting",desc:"Review findings, refine conclusions, and generate the final report in Markdown or Plain Text."}].map((o,d)=>e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute -left-[25px] top-0 w-5 h-5 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 text-[10px] font-bold flex items-center justify-center border-2 border-white dark:border-slate-900",children:d+1}),e.jsx("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200",children:o.title}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 leading-relaxed",children:o.desc})]},d))})]})}),i==="tech"&&e.jsx("div",{className:"animate-fade-in-up space-y-8",children:e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:u.map((o,d)=>e.jsxs("div",{className:"p-5 bg-white dark:bg-slate-900 border border-gray-100 dark:border-slate-800 rounded-2xl shadow-sm flex flex-col gap-3 hover:border-indigo-200 dark:hover:border-indigo-800 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-gray-50 dark:border-slate-800/50",children:[e.jsx("span",{className:"font-bold text-sm text-slate-700 dark:text-slate-300",children:o.layer}),e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${o.bg} ${o.color}`,children:o.tech})]}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed",children:[e.jsx("strong",{className:"text-slate-700 dark:text-slate-300",children:"Role:"})," ",o.role]})]},d))})}),i==="changelog"&&e.jsx("div",{className:"animate-fade-in-up",children:e.jsxs("div",{className:"space-y-8 pl-4 relative",children:[e.jsx("div",{className:"absolute top-0 bottom-0 left-0 w-px bg-gradient-to-b from-indigo-500 via-slate-200 to-transparent dark:via-slate-800"}),Xt.map((o,d)=>e.jsxs("div",{className:"relative pl-6",children:[e.jsx("div",{className:`absolute left-[-4px] top-1.5 w-2 h-2 rounded-full border border-white dark:border-slate-900 transition-all ${d===0?"bg-indigo-500 scale-125 shadow-[0_0_0_4px_rgba(99,102,241,0.2)]":"bg-slate-300 dark:bg-slate-700"}`}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h4",{className:`text-sm font-bold ${d===0?"text-indigo-600 dark:text-indigo-400":"text-slate-800 dark:text-slate-200"}`,children:["v",o.version]}),e.jsx("span",{className:"text-[10px] font-mono text-slate-400 bg-slate-100 dark:bg-slate-800 px-2 py-0.5 rounded",children:o.date})]}),e.jsx("ul",{className:"space-y-2",children:o.features.map((x,h)=>e.jsxs("li",{className:"text-xs text-slate-600 dark:text-slate-300 flex items-start gap-2 leading-relaxed",children:[e.jsx("span",{className:"w-1 h-1 bg-slate-300 dark:bg-slate-600 rounded-full mt-1.5 flex-shrink-0"}),e.jsx("span",{children:x})]},h))})]},d))]})}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-100 dark:border-slate-800 flex flex-col items-center opacity-70",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("span",{className:"text-[10px] font-bold text-indigo-500 uppercase tracking-widest",children:"Architected By"})}),e.jsxs("h3",{className:"text-sm font-bold text-slate-800 dark:text-white",children:["Trung Dang Hoang ",e.jsx("span",{className:"text-slate-400 font-normal italic",children:"(Steven)"})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:" 2026 ISO Audit Pro. All Rights Reserved."})]})]})]})})},zs=({children:t,commandActions:s,onRestoreSnapshot:r})=>{const{isSidebarOpen:a,setSidebarOpen:i,sidebarWidth:n,setSidebarWidth:l,toastMsg:u,showToast:o,modals:d,toggleModal:x}=de(),{privacySettings:h,setPrivacySettings:k}=oe();return e.jsxs("div",{className:"flex flex-col h-[100dvh] w-full bg-gray-50 dark:bg-slate-900 transition-colors duration-500 ease-soft relative",children:[u&&e.jsx(as,{message:u,onClose:()=>o("")}),e.jsx(ls,{}),e.jsxs("main",{className:"flex-1 flex overflow-hidden relative",children:[e.jsx("div",{className:`${a?"translate-x-0":"-translate-x-full"} fixed top-16 bottom-0 left-0 z-[60] md:absolute md:inset-y-0 md:relative md:top-0 md:translate-x-0 md:transform-none transition-transform duration-300 ease-soft h-[calc(100%-4rem)] md:h-full`,children:e.jsx(Ds,{isOpen:a,width:n,setWidth:l})}),a&&e.jsx("div",{className:"fixed top-16 bottom-0 inset-x-0 bg-black/50 z-50 md:hidden backdrop-blur-sm transition-opacity duration-300 animate-in fade-in",onClick:()=>i(!1)}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0 relative w-full transition-all duration-300 ease-soft bg-white/50 dark:bg-slate-900/50 backdrop-blur-sm",children:t})]}),e.jsx($s,{isOpen:d.about,onClose:()=>x("about",!1)}),e.jsx(Os,{isOpen:d.recall,onClose:()=>x("recall",!1),onRestore:r}),e.jsx(_s,{isOpen:d.privacy,onClose:()=>x("privacy",!1),settings:h,setSettings:k})]})},Fs=ve.memo(({layoutMode:t,setLayoutMode:s,isSidebarOpen:r,sidebarWidth:a})=>{const i=c.useRef([]),n=c.useRef(null),[l,u]=c.useState({left:0,width:0,opacity:0,color:""});return c.useEffect(()=>{const o=()=>{const x=ue.findIndex(k=>k.id===t),h=i.current[x];h&&u({left:h.offsetLeft,width:h.offsetWidth,opacity:1,color:ue[x].colorClass})};o(),window.addEventListener("resize",o);const d=setTimeout(o,300);return()=>{window.removeEventListener("resize",o),clearTimeout(d)}},[t,r,a]),e.jsx("div",{className:"flex gap-2 w-full",children:e.jsxs("div",{ref:n,className:"relative flex-1 flex justify-between bg-gray-100 dark:bg-slate-950 p-1 rounded-xl dark:shadow-[inset_0_1px_3px_rgba(0,0,0,0.5)]",children:[e.jsx("div",{className:`absolute top-1 bottom-1 shadow-sm rounded-lg transition-all duration-500 ease-fluid z-0 ${l.color}`,style:{left:l.left,width:l.width,opacity:l.opacity}}),ue.map((o,d)=>e.jsxs("button",{ref:x=>{i.current[d]=x},onClick:()=>s(o.id),className:`flex-1 relative z-10 flex items-center justify-center gap-2 px-1 md:px-4 py-2 rounded-lg text-xs md:text-sm font-bold transition-colors duration-300 ${t===o.id?"text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"}`,children:[e.jsx(f,{name:o.icon,size:16}),e.jsx("span",{className:`${r?"hidden xl:inline":"hidden md:inline"}`,children:o.label})]},o.id))]})})}),Bs=t=>{const s=c.useMemo(()=>{if(!t)return[];const i=[],n=l=>{l.forEach(u=>{i.push(u),u.subClauses&&n(u.subClauses)})};return t.groups.forEach(l=>n(l.clauses)),i},[t]),r=c.useCallback(i=>s.find(n=>n.id===i),[s]),a=c.useCallback(i=>s.find(n=>n.code===i),[s]);return{flatClauses:s,getClauseById:r,getClauseByCode:a}},Us=c.forwardRef(({standard:t,selectedClauses:s,matrixData:r,setMatrixData:a,onPasteFiles:i,uploadedFiles:n=[],onRemoveFile:l,onLookup:u},o)=>{const[d,x]=c.useState(null),h=c.useRef(null),{getClauseById:k}=Bs(t);c.useEffect(()=>{a(p=>{const m={...p};let N=!1,A=null;return s.forEach(L=>{if(!m[L]||m[L].length===0){const E=k(L);if(E){const _=E.description||"Requirement",Z=_.length>300?_.split(/(?:\. |\n)/).filter(W=>W.trim().length>5):[_];m[L]=Z.map((W,q)=>({id:`${L}_req_${q}`,requirement:W.trim(),evidenceInput:"",status:"pending"})),N=!0}}!A&&m[L]&&m[L].length>0&&(A={clauseId:L,rowId:m[L][0].id})}),!d&&A&&x(A),N?m:p})},[s,k,a]);const g=c.useCallback((p,m,N)=>{a(A=>({...A,[p]:A[p].map(L=>{if(L.id===m){const E=L.evidenceInput||"",Z=E+(E&&N?`
`:"")+N;return{...L,evidenceInput:Z,status:Z.trim()?"supplied":"pending"}}return L})}))},[a]),w=c.useCallback((p,m,N)=>{a(A=>{const L=A[p];if(!L)return A;const E=L.findIndex(Z=>Z.id===m);if(E===-1||L[E].evidenceInput===N)return A;const _=[...L];return _[E]={..._[E],evidenceInput:N,status:N.trim()?"supplied":"pending"},{...A,[p]:_}})},[a]),j=c.useCallback((p,m,N)=>{const A=p.clipboardData.items,L=[];for(let E=0;E<A.length;E++)if(A[E].kind==="file"){const _=A[E].getAsFile();_&&L.push(_)}L.length>0&&(p.preventDefault(),i&&i(L,{clauseId:m,rowId:N}))},[i]);c.useImperativeHandle(o,()=>({insertEvidence:(p,m,N)=>g(p,m,N),handleExternalDictation:p=>{d&&g(d.clauseId,d.rowId,p)},getActiveRow:()=>d}));const y=c.useMemo(()=>{if(!d)return null;const p=k(d.clauseId),m=r[d.clauseId],N=m==null?void 0:m.find(A=>A.id===d.rowId);return!p||!N?null:{clause:p,row:N}},[d,r,k]),C=p=>{const m=p.file.type.startsWith("image/"),N=p.file.type.includes("pdf");return e.jsxs("div",{className:"relative group w-20 h-20 bg-gray-50 dark:bg-slate-800 rounded-lg border border-gray-200 dark:border-slate-700 flex flex-col items-center justify-center overflow-hidden transition-all hover:shadow-md hover:-translate-y-1",children:[m?e.jsx("img",{src:URL.createObjectURL(p.file),alt:"preview",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}):e.jsxs("div",{className:"flex flex-col items-center p-2 text-center",children:[e.jsx(f,{name:N?"BookOpen":"FileText",size:24,className:"text-slate-400 mb-1"}),e.jsx("span",{className:"text-[9px] text-slate-500 line-clamp-2 leading-tight break-all",children:p.file.name})]}),e.jsxs("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-start justify-end p-1",children:[p.status==="processing"&&e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-black/50 flex items-center justify-center",children:e.jsx(f,{name:"Loader",size:16,className:"animate-spin text-indigo-600"})}),p.status==="success"&&e.jsx("div",{className:"bg-emerald-500 rounded-full p-0.5 shadow-sm",children:e.jsx(f,{name:"CheckThick",size:10,className:"text-white"})}),e.jsx("button",{onClick:A=>{A.stopPropagation(),l&&l(p.id)},className:"bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-all hover:scale-110 shadow-sm",title:"Remove File",children:e.jsx(f,{name:"X",size:10})})]})]},p.id)};return s.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 bg-gray-50/30 dark:bg-slate-900/30 rounded-3xl border-2 border-dashed border-gray-200 dark:border-slate-800 m-4",children:[e.jsx("div",{className:"p-6 bg-white dark:bg-slate-900 rounded-full shadow-depth mb-4",children:e.jsx(f,{name:"LayoutList",size:48,className:"text-indigo-200 dark:text-slate-700"})}),e.jsx("p",{className:"text-sm font-bold text-slate-500",children:"Select clauses to start mapping evidence."})]}):e.jsx("div",{className:"h-full flex flex-col relative animate-fade-in-up",children:e.jsxs("div",{className:"flex-1 min-h-0 bg-white dark:bg-slate-900 rounded-2xl border border-white/60 dark:border-slate-800 shadow-depth overflow-hidden flex",children:[e.jsxs("div",{className:"w-1/3 min-w-[260px] max-w-[350px] border-r border-gray-100 dark:border-slate-800 flex flex-col bg-slate-50/50 dark:bg-slate-950/30 backdrop-blur-sm",children:[e.jsxs("div",{className:"p-3 border-b border-gray-100 dark:border-slate-800 flex justify-between items-center bg-white/50 dark:bg-slate-900/50",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Requirement Checklist"}),e.jsxs("button",{onClick:()=>{const p=ms(r,s);p&&Le(p)},className:"text-[10px] text-indigo-500 hover:text-indigo-600 font-bold flex items-center gap-1 transition-colors",children:[e.jsx(f,{name:"Copy",size:10})," Copy All"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-4",children:s.map(p=>{const m=k(p),N=r[p]||[];return m?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 px-2 py-1.5 group/header rounded-lg hover:bg-white dark:hover:bg-slate-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx("span",{className:"text-[10px] font-black text-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 px-1.5 py-0.5 rounded flex-shrink-0 border border-indigo-100 dark:border-indigo-800/50",children:m.code}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-300 truncate",title:m.title,children:m.title})]}),e.jsx("button",{onClick:A=>{A.stopPropagation(),u&&u(m)},className:"p-1 text-slate-400 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded opacity-0 group-hover/header:opacity-100 transition-all scale-90 hover:scale-100",title:"Read Clause Content",children:e.jsx(f,{name:"BookOpen",size:12})})]}),e.jsx("div",{className:"pl-2 space-y-1",children:N.map(A=>{const L=(d==null?void 0:d.rowId)===A.id,E=A.status==="supplied";return e.jsx("div",{onClick:()=>x({clauseId:p,rowId:A.id}),className:`group relative p-3 rounded-xl cursor-pointer transition-all border ${L?"bg-white dark:bg-slate-800 border-indigo-200 dark:border-indigo-600 shadow-sm ring-1 ring-indigo-500/10":"bg-transparent border-transparent hover:bg-white dark:hover:bg-slate-800/50 hover:border-slate-200 dark:hover:border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx("div",{className:`mt-1 w-2.5 h-2.5 rounded-full shrink-0 transition-all shadow-sm ${E?"bg-emerald-500 scale-110":L?"bg-indigo-500 scale-110":"bg-slate-200 dark:bg-slate-700"}`}),e.jsx("p",{className:`text-[11px] leading-relaxed line-clamp-3 ${L?"text-slate-800 dark:text-slate-100 font-medium":"text-slate-500 dark:text-slate-400"}`,children:A.requirement})]})},A.id)})})]},p):null})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-white dark:bg-slate-900 min-w-0 relative",children:y?e.jsxs("div",{className:"flex flex-col h-full animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50 backdrop-blur-md sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-black text-white bg-gradient-to-r from-indigo-500 to-purple-500 px-2 py-0.5 rounded shadow-sm",children:y.clause.code}),e.jsx("span",{className:"text-sm font-bold text-slate-800 dark:text-white tracking-tight",children:y.clause.title})]}),e.jsxs("button",{onClick:()=>u&&u(y.clause),className:"flex items-center gap-1.5 px-3 py-1.5 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-600 dark:text-slate-300 hover:text-indigo-600 dark:hover:text-indigo-400 hover:border-indigo-300 transition-all shadow-sm active:scale-95",children:[e.jsx(f,{name:"BookOpen",size:14}),"Ref"]})]}),e.jsx("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border-l-4 border-indigo-400 dark:border-indigo-600 shadow-sm",children:e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 leading-relaxed font-medium",children:y.row.requirement})})]}),n.length>0&&e.jsx("div",{className:"px-6 pt-4 pb-2 bg-slate-50/30 dark:bg-black/10",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:n.map(C)})}),e.jsxs("div",{className:"flex-1 relative group",children:[e.jsx("textarea",{ref:h,className:"w-full h-full p-6 text-sm text-slate-800 dark:text-slate-200 bg-transparent outline-none resize-none leading-7 placeholder-slate-300 dark:placeholder-slate-600 font-medium",placeholder:"Type verified evidence here... (Drag & Drop files supported)",value:y.row.evidenceInput,onChange:p=>w(y.clause.id,y.row.id,p.target.value),onPaste:p=>j(p,y.clause.id,y.row.id),autoFocus:!0}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[y.row.status==="supplied"&&e.jsxs("span",{className:"px-3 py-1.5 bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400 rounded-full text-xs font-bold flex items-center gap-1 shadow-sm border border-emerald-200 dark:border-emerald-800",children:[e.jsx(f,{name:"CheckThick",size:12})," Saved"]}),e.jsx("button",{onClick:()=>w(y.clause.id,y.row.id,""),className:"p-2 bg-white dark:bg-slate-800 hover:bg-red-50 text-slate-400 hover:text-red-500 rounded-lg transition-colors shadow-sm border border-gray-200 dark:border-slate-700",title:"Clear Text",children:e.jsx(f,{name:"Trash2",size:16})})]})]}),e.jsxs("div",{className:"px-6 py-2 border-t border-gray-100 dark:border-slate-800 text-[10px] text-slate-400 flex justify-between bg-gray-50/80 dark:bg-slate-950/80 backdrop-blur-sm",children:[e.jsxs("span",{className:"font-mono",children:["Ln ",y.row.evidenceInput.split(`
`).length,", Col ",y.row.evidenceInput.length]}),e.jsxs("span",{children:[n.length," Attachment(s)"]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300 dark:text-slate-600",children:[e.jsx(f,{name:"ArrowLeft",size:32,className:"mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Select a requirement from the checklist"})]})})]})})}),Ks=(t,s)=>{const[r,a]=c.useState(!1),i=c.useRef(null),n=c.useCallback(()=>{var u;if(r){(u=i.current)==null||u.stop(),a(!1);return}const l=window.SpeechRecognition||window.webkitSpeechRecognition;if(!l){alert("Voice-to-Text is not supported in this browser.");return}try{const o=new l;o.continuous=!0,o.interimResults=!0,o.lang=t==="vi"?"vi-VN":"en-US",o.onresult=d=>{let x="";for(let h=d.resultIndex;h<d.results.length;++h)d.results[h].isFinal&&(x+=d.results[h][0].transcript);x&&s(x.trim())},o.onerror=d=>{console.error("Speech Error",d.error),a(!1)},o.onend=()=>a(!1),o.start(),i.current=o,a(!0)}catch(o){console.error("Failed to start recognition",o),a(!1)}},[r,t,s]);return{isListening:r,toggleListening:n}},Vs=ve.memo(({processes:t,activeProcessId:s,activeProcess:r,setActiveProcessId:a,addInterviewee:i,removeInterviewee:n})=>{var d;const[l,u]=c.useState(""),o=x=>{x.key==="Enter"&&l.trim()&&(i(l.trim()),u(""))};return e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-2 bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-800 rounded-xl p-1.5 shadow-sm shrink-0 transition-colors",children:[e.jsxs("div",{className:"relative group w-full md:w-auto min-w-[200px] bg-gray-50 dark:bg-slate-800 rounded-lg border border-gray-200 dark:border-slate-700 flex items-center hover:border-indigo-300 dark:hover:border-indigo-700 transition-colors",children:[e.jsx("div",{className:"absolute left-2 text-indigo-500 pointer-events-none",children:e.jsx(f,{name:"Session11_GridAdd",size:14})}),e.jsx("select",{value:s||"",onChange:x=>a(x.target.value),className:"w-full bg-transparent appearance-none pl-7 pr-6 py-2 text-xs font-bold text-slate-700 dark:text-slate-200 outline-none cursor-pointer",title:"Switch active process context",children:t.map(x=>e.jsx("option",{value:x.id,className:"text-slate-900 dark:text-white bg-white dark:bg-slate-900",children:x.name},x.id))}),e.jsx("div",{className:"absolute right-2 pointer-events-none text-slate-400",children:e.jsx(f,{name:"ChevronDown",size:12})})]}),e.jsx("div",{className:"w-px h-6 bg-gray-200 dark:bg-slate-700 hidden md:block"}),e.jsxs("div",{className:"flex-1 flex items-center gap-2 w-full overflow-x-auto custom-scrollbar px-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-bold text-slate-400 uppercase whitespace-nowrap",children:[e.jsx(f,{name:"User",size:12})," Persons:"]}),(d=r==null?void 0:r.interviewees)==null?void 0:d.map((x,h)=>e.jsxs("span",{className:"flex items-center gap-1 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-[10px] font-bold px-2 py-0.5 rounded-md border border-indigo-100 dark:border-indigo-800 whitespace-nowrap animate-in zoom-in-95",children:[x,e.jsx("button",{onClick:()=>n(x),className:"hover:text-red-500 transition-colors",children:e.jsx(f,{name:"X",size:10})})]},h)),e.jsx("input",{className:"bg-transparent border-b border-dashed border-gray-300 dark:border-slate-700 text-xs py-0.5 px-1 outline-none focus:border-indigo-500 min-w-[100px] dark:text-slate-300 placeholder-slate-400 focus:placeholder-indigo-300 transition-all",placeholder:"+ Name & Enter",value:l,onChange:x=>u(x.target.value),onKeyDown:o})]})]})}),Ws=({uploadedFiles:t,onOcrProcess:s,isOcrLoading:r,isProcessing:a,toggleListening:i,isListening:n,triggerFileUpload:l,onAnalyze:u,isReadyForAnalysis:o,isAnalyzeLoading:d})=>e.jsxs("div",{className:"flex-shrink-0 flex items-end gap-3 min-h-[52px]",children:[t.length>0&&e.jsxs("div",{className:"flex-1 flex gap-2 overflow-x-auto custom-scrollbar bg-gray-50 dark:bg-slate-900 p-1.5 rounded-xl border border-gray-200 dark:border-slate-800 animate-in fade-in slide-in-from-bottom-2",children:[t.map(x=>e.jsxs("div",{className:"relative group w-10 h-10 flex-shrink-0 bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-gray-100 dark:border-slate-700 flex items-center justify-center overflow-hidden transition-transform hover:scale-105",children:[e.jsx(f,{name:"FileText",size:16,className:"text-indigo-500"}),x.status==="processing"&&e.jsx("div",{className:"absolute inset-0 bg-white/50 flex items-center justify-center",children:e.jsx(f,{name:"Loader",size:14,className:"animate-spin text-indigo-600"})}),x.status==="success"&&e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-emerald-500 rounded-full animate-ping-once"})]},x.id)),e.jsxs("button",{onClick:s,disabled:r||a,className:"px-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-[10px] font-bold shadow-md transition-all active:scale-95 disabled:opacity-50",children:["Process ",t.filter(x=>x.status==="pending").length]})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsxs("button",{onClick:i,className:`px-4 h-[48px] rounded-xl text-xs font-bold flex items-center gap-2 transition-all shadow-sm border active:scale-95 ${n?"bg-red-50 text-red-600 border-red-200 animate-pulse":"bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-300 border-gray-200 dark:border-slate-700 hover:border-indigo-500"}`,children:[e.jsx(f,{name:"Mic",size:18}),e.jsx("span",{className:"hidden md:inline",children:n?"Recording...":"Dictate"})]}),e.jsxs("button",{onClick:l,className:"px-4 h-[48px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 hover:border-indigo-500 text-slate-600 dark:text-slate-300 rounded-xl text-xs font-bold flex items-center gap-2 shadow-sm transition-all active:scale-95",children:[e.jsx(f,{name:"UploadCloud",size:18}),e.jsx("span",{className:"hidden md:inline",children:"Upload"})]}),e.jsxs("button",{onClick:u,disabled:!o,className:`px-6 h-[48px] rounded-xl font-bold transition-all flex items-center gap-2 shadow-lg ${o?"btn-shrimp text-white active:scale-95 hover:shadow-indigo-500/40":"bg-gray-200 dark:bg-slate-800 text-slate-400 cursor-not-allowed"}`,children:[d?e.jsx(ns,{className:"text-white"}):e.jsx(f,{name:"Wand2",size:18}),e.jsx("span",{children:"Analyze"})]})]})]}),Gs=()=>{const{knowledgeBase:t,standards:s,standardKey:r}=oe(),{getActiveKey:a}=ke();return async n=>{var u;const l=new CustomEvent("OPEN_REFERENCE",{detail:n});if(window.dispatchEvent(l),t){const o=Oe.extractClauseContent(t,n.code,n.title);if(o&&o.length>20){setTimeout(()=>{const d=new CustomEvent("UPDATE_REFERENCE_CONTENT",{detail:{en:o,vi:`[SOURCE DOCUMENT EXTRACT]

${o}

(Auto-translated view not available in Offline Mode)`}});window.dispatchEvent(d)},300);return}else console.warn(`[Local Lookup] Could not find clause ${n.code} in source document. Falling back to AI.`)}try{const o=((u=s[r])==null?void 0:u.name)||"",d=a(),x=(d==null?void 0:d.key)||"",h=await dt(n,o,t,x),k=new CustomEvent("UPDATE_REFERENCE_CONTENT",{detail:h});window.dispatchEvent(k)}catch(o){console.error("Reference Fetch Failed",o);const d=new CustomEvent("UPDATE_REFERENCE_CONTENT",{detail:{en:"Failed to load content. Ensure API Key is valid or source document is attached.",vi:""}});window.dispatchEvent(d)}}},qs=({evidence:t,setEvidence:s,uploadedFiles:r,setUploadedFiles:a,isOcrLoading:i,onAnalyze:n,isReadyForAnalysis:l,isAnalyzeLoading:u,analyzeTooltip:o,evidenceLanguage:d,setEvidenceLanguage:x,onExport:h,selectedClauses:k=[],standards:g,standardKey:w,matrixData:j,setMatrixData:y})=>{const{activeProcess:C,activeProcessId:p,setActiveProcessId:m,processes:N,addInterviewee:A,removeInterviewee:L}=oe(),[E,_]=c.useState(!1),[Z,W]=c.useState(!1),q=c.useRef({}),D=c.useRef(null),F=c.useRef(null),U=Gs(),K=c.useMemo(()=>{const M=j?Object.keys(j):[];return Array.from(new Set([...k,...M]))},[k,j]),Y=ue.find(M=>M.id==="evidence"),Q=c.useCallback(M=>{M&&F.current?F.current.handleExternalDictation(M):alert("Please select a Requirement row in the Matrix first.")},[]),{isListening:se,toggleListening:R}=Ks(d,Q),O=c.useCallback((M,$)=>{var X;const H=$||((X=F.current)==null?void 0:X.getActiveRow());if(!H){alert("Please click/focus on a specific Requirement row to attach files.");return}const z=M.map(re=>{const ae=Math.random().toString(36).substr(2,9);return q.current[ae]=H,{id:ae,file:re,status:"pending"}});a(re=>[...re,...z])},[a]),V=c.useCallback(M=>{a($=>$.filter(H=>H.id!==M)),delete q.current[M]},[a]),v=c.useCallback(async()=>{const M=r.filter($=>$.status==="pending"||$.status==="error");if(M.length!==0){W(!0);for(const $ of M)try{a(z=>z.map(X=>X.id===$.id?{...X,status:"processing"}:X));let H="";if($.file.type.startsWith("image/")){const z=await ps($.file);H=await ot("Transcribe text.",z,$.file.type)}else $.file.type==="application/pdf"?H="[PDF Content extracted via OCR would go here - System limitation]":H=await $.file.text();if(H&&F.current){const z=q.current[$.id];if(z){const X=`[File: ${$.file.name}]`;F.current.insertEvidence(z.clauseId,z.rowId,`${X}
${H}`),a(re=>re.filter(ae=>ae.id!==$.id))}}}catch(H){console.error("Matrix OCR Error",H),a(z=>z.map(X=>X.id===$.id?{...X,status:"error",error:H.message||"Failed"}:X))}W(!1)}},[r,a]),S=c.useCallback(M=>{M.preventDefault(),_(!0)},[]),I=c.useCallback(M=>{M.preventDefault(),_(!1)},[]),P=c.useCallback(M=>{M.preventDefault(),_(!1),M.dataTransfer.files&&M.dataTransfer.files.length>0&&O(Array.from(M.dataTransfer.files))},[O]);return e.jsxs("div",{className:"h-full flex flex-col gap-2 md:gap-3 animate-fade-in-up relative p-1",children:[e.jsx(Vs,{processes:N,activeProcessId:p,activeProcess:C,setActiveProcessId:M=>m(M),addInterviewee:A,removeInterviewee:L}),e.jsxs("div",{className:"flex-1 flex flex-col gap-2 min-h-0 relative",children:[e.jsx("input",{type:"file",ref:D,className:"hidden",accept:"image/*,application/pdf,text/plain",multiple:!0,onChange:M=>M.target.files&&O(Array.from(M.target.files))}),e.jsxs("div",{className:`flex-1 bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-t-4 border-t-${Y.borderClass.replace("border-","")} overflow-hidden flex flex-row relative group transition-all duration-500 ease-fluid dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05),0_4px_6px_-1px_rgba(0,0,0,0.5)] ${E?`${Y.borderClass} ring-4 ring-blue-500/20 bg-blue-50/10`:"border-gray-100 dark:border-transparent"}`,onDragOver:S,onDragLeave:I,onDrop:P,children:[E&&e.jsxs("div",{className:"absolute inset-0 bg-blue-500/10 backdrop-blur-[2px] z-50 flex flex-col items-center justify-center pointer-events-none animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("div",{className:"p-6 rounded-full bg-white dark:bg-slate-900 shadow-2xl border-4 border-dashed border-blue-500",children:e.jsx(f,{name:"UploadCloud",size:48,className:"text-blue-600 animate-bounce"})}),e.jsx("h3",{className:"mt-4 text-xl font-black text-blue-700 dark:text-blue-400 uppercase tracking-widest",children:"Drop Files to Active Row"})]}),g&&w&&g[w]&&j&&y?e.jsx("div",{className:"flex-1 w-full h-full p-1",children:e.jsx(Us,{ref:F,standard:g[w],selectedClauses:K,matrixData:j,setMatrixData:y,onPasteFiles:O,uploadedFiles:r,onRemoveFile:V,onLookup:U})}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400",children:[e.jsx(f,{name:"LayoutList",size:48,className:"mb-4 opacity-30"}),e.jsx("p",{children:"Please select a Standard to view the Matrix."})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 flex flex-row items-center justify-between gap-2 md:gap-3 w-full pt-1",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx(Ws,{uploadedFiles:r,onOcrProcess:v,isOcrLoading:i,isProcessing:Z,toggleListening:R,isListening:se,triggerFileUpload:()=>{var M;return(M=D.current)==null?void 0:M.click()},onAnalyze:n,isReadyForAnalysis:l,isAnalyzeLoading:u})}),e.jsxs("button",{onClick:()=>h("evidence",d),className:"flex-none md:w-auto px-3 md:px-4 h-[52px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 hover:border-indigo-500 text-slate-700 dark:text-slate-200 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all duration-300 active:scale-95 shadow-sm whitespace-nowrap dark:shadow-md",title:"Export Raw Evidence",children:[e.jsx(f,{name:"Download"}),e.jsx("span",{className:"hidden md:inline",children:"Export"}),e.jsxs("div",{className:"lang-pill-container",children:[e.jsx("span",{onClick:M=>{M.stopPropagation(),x("en")},className:`lang-pill-btn ${d==="en"?"lang-pill-active":"lang-pill-inactive"}`,children:"EN"}),e.jsx("span",{onClick:M=>{M.stopPropagation(),x("vi")},className:`lang-pill-btn ${d==="vi"?"lang-pill-active":"lang-pill-inactive"}`,children:"VI"})]})]})]})]})},Hs=({analysisResult:t,setAnalysisResult:s,selectedFindings:r,setSelectedFindings:a,isAnalyzeLoading:i,loadingMessage:n,currentAnalyzingClause:l,viewMode:u,setViewMode:o,focusedFindingIndex:d,setFocusedFindingIndex:x,onExport:h,notesLanguage:k,setNotesLanguage:g})=>{const w=c.useRef(null),j=c.useRef([]),{getActiveKey:y}=ke(),{showToast:C}=de(),[p,m]=c.useState(null),[N,A]=c.useState({}),[L,E]=c.useState(new Set),[_,Z]=c.useState(!1),W=ue.find(R=>R.id==="findings");c.useEffect(()=>{u==="list"&&w.current&&(w.current.scrollTop=w.current.scrollHeight)},[t==null?void 0:t.length,u]);const q=c.useMemo(()=>!t||t.length===0?!1:t.every(R=>r[R.clauseId]),[t,r]),D=c.useMemo(()=>{if(!t)return{};const R={};return t.forEach((O,V)=>{const v=O.processName||"General Audit";R[v]||(R[v]=[]),R[v].push({finding:O,originalIndex:V})}),Object.keys(R).sort().reduce((O,V)=>(O[V]=R[V],O),{})},[t]),F=R=>{E(O=>{const V=new Set(O);return V.has(R)?V.delete(R):V.add(R),V})},U=()=>{if(!t)return;const R={},O=!q;t.forEach(V=>{R[V.clauseId]=O}),a(V=>({...V,...R})),C(O?"All Findings Selected":"All Findings Deselected")},K=(R,O,V)=>{if(s(v=>{if(!v)return null;const S=[...v];return S[R]={...S[R],[O]:V},S}),O==="status"&&t){const v=R+1;v<t.length&&j.current[v]&&setTimeout(()=>{var S;return(S=j.current[v])==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})},100)}},Y=async(R,O)=>{R.stopPropagation();const V=y();if(!V)return C("API Key Required for Review");m(O.clauseId);try{const v=await it(O,V.key,V.activeModel);A(S=>({...S,[O.clauseId]:v}))}catch{C("Review Failed")}finally{m(null)}},Q=R=>{switch(R){case"COMPLIANT":return{bg:"bg-emerald-500",text:"text-emerald-700 dark:text-emerald-300",pill:"bg-emerald-100 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300",border:"border-emerald-500"};case"NC_MAJOR":return{bg:"bg-red-600",text:"text-red-700 dark:text-red-300",pill:"bg-red-100 dark:bg-red-900/40 text-red-700 dark:text-red-300",border:"border-red-600"};case"NC_MINOR":return{bg:"bg-orange-500",text:"text-orange-700 dark:text-orange-300",pill:"bg-orange-100 dark:bg-orange-900/40 text-orange-700 dark:text-orange-300",border:"border-orange-500"};case"OFI":return{bg:"bg-blue-500",text:"text-blue-700 dark:text-blue-300",pill:"bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300",border:"border-blue-500"};default:return{bg:"bg-slate-500",text:"text-slate-600",pill:"bg-slate-100 text-slate-500",border:"border-slate-300"}}},se=(R,O,V=!1)=>{const v=Q(R.status),S=N[R.clauseId],I=p===R.clauseId;return e.jsxs("div",{ref:V?null:P=>{j.current[O]=P},className:`group relative bg-white dark:bg-slate-900 rounded-2xl p-4 md:p-5 border-l-[6px] transition-all duration-300 hover:shadow-depth-lg dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05)] ${v.border} ${r[R.clauseId]?"ring-2 ring-indigo-500/20 translate-x-2":"hover:translate-x-1 opacity-60 hover:opacity-100"} animate-in slide-in-from-bottom-2 fade-in fill-mode-backwards`,style:{animationDelay:`${O*50}ms`},onClick:()=>a(P=>({...P,[R.clauseId]:!P[R.clauseId]})),children:[e.jsxs("div",{className:"absolute top-4 right-4 z-10 flex gap-2",children:[e.jsx("button",{onClick:P=>Y(P,R),disabled:I,className:`p-1.5 rounded-full transition-all border ${S?"bg-purple-100 text-purple-600 border-purple-200":"bg-gray-100 text-slate-400 hover:text-purple-600 hover:bg-purple-50 border-transparent"}`,title:"AI Shadow Review (Critique Finding)",children:I?e.jsx(f,{name:"Loader",className:"animate-spin",size:14}):e.jsx(f,{name:"ShieldEye",size:14})}),r[R.clauseId]?e.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-900/30 rounded-full p-1 text-emerald-600 dark:text-emerald-400",children:e.jsx(f,{name:"CheckThick",size:18})}):e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-gray-200 dark:border-slate-700 group-hover:border-indigo-400 transition-colors"})]}),e.jsxs("div",{className:"pr-12",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[e.jsx("span",{className:"text-xs font-black text-slate-500 dark:text-slate-400 bg-gray-100 dark:bg-slate-800 px-2 py-1 rounded-lg border border-gray-200 dark:border-slate-700",children:R.clauseId}),R.processName&&e.jsxs("span",{className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/30 px-2 py-1 rounded border border-indigo-100 dark:border-indigo-800 flex items-center gap-1",children:[e.jsx(f,{name:"Session11_GridAdd",size:10})," ",R.processName]}),e.jsx("div",{className:"relative group/badge",onClick:P=>P.stopPropagation(),children:e.jsxs("select",{value:R.status,onChange:P=>K(O,"status",P.target.value),className:`appearance-none cursor-pointer text-[10px] font-black uppercase tracking-wider px-3 py-1 rounded-full ${v.pill} border-none outline-none hover:brightness-95 text-center transition-all shadow-sm`,children:[e.jsx("option",{className:"bg-white dark:bg-slate-900 text-slate-900 dark:text-white",value:"COMPLIANT",children:"COMPLIANT"}),e.jsx("option",{className:"bg-white dark:bg-slate-900 text-slate-900 dark:text-white",value:"NC_MINOR",children:"MINOR NC"}),e.jsx("option",{className:"bg-white dark:bg-slate-900 text-slate-900 dark:text-white",value:"NC_MAJOR",children:"MAJOR NC"}),e.jsx("option",{className:"bg-white dark:bg-slate-900 text-slate-900 dark:text-white",value:"OFI",children:"OFI"})]})})]}),e.jsx("div",{className:"mb-4 group/evidence",children:e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-950/50 p-4 rounded-xl border border-slate-100 dark:border-slate-800 relative transition-colors focus-within:border-indigo-300 dark:focus-within:border-indigo-700 focus-within:ring-1 focus-within:ring-indigo-500/20",onClick:P=>P.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("strong",{className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-wider block",children:"Verified Evidence"}),e.jsxs("span",{className:"text-[9px] text-slate-400 opacity-0 group-hover/evidence:opacity-100 transition-opacity flex items-center gap-1",children:[e.jsx(f,{name:"FileEdit",size:10})," Editable (Raw Data)"]})]}),e.jsx("textarea",{value:R.evidence,onChange:P=>K(O,"evidence",P.target.value),className:"w-full bg-transparent outline-none text-xs text-slate-700 dark:text-slate-300 leading-relaxed font-medium resize-y min-h-[80px] whitespace-pre-wrap font-mono custom-scrollbar border-l-2 border-transparent focus:border-indigo-400 pl-2 transition-all",placeholder:"Evidence content...",spellCheck:!1})]})}),e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border-2 border-slate-100 dark:border-slate-800 hover:border-indigo-200 dark:hover:border-indigo-900/50 transition-colors group-focus-within:border-indigo-500 shadow-sm",onClick:P=>P.stopPropagation(),children:[e.jsx("strong",{className:"text-[10px] font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider mb-1 block",children:"Auditor Conclusion"}),e.jsx("textarea",{value:R.reason,onChange:P=>K(O,"reason",P.target.value),className:"w-full bg-transparent outline-none text-sm text-slate-800 dark:text-slate-200 leading-relaxed resize-none h-auto min-h-[60px]",placeholder:"Enter conclusion..."})]})}),S&&e.jsxs("div",{className:"mt-3 p-3 bg-purple-50 dark:bg-purple-900/20 border-l-4 border-purple-400 rounded-r-lg animate-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(f,{name:"ShieldEye",size:12,className:"text-purple-600"}),e.jsx("span",{className:"text-[10px] font-bold text-purple-700 dark:text-purple-300 uppercase",children:"AI Reviewer Note"})]}),e.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-300 italic leading-relaxed",children:['"',S,'"']})]}),R.suggestion&&!S&&e.jsxs("div",{className:"flex gap-2 items-start mt-3 opacity-80 group-hover:opacity-100 transition-opacity",children:[e.jsx("div",{className:"p-1 bg-amber-100 dark:bg-amber-900/30 rounded-full text-amber-600 dark:text-amber-400 shrink-0",children:e.jsx(f,{name:"Lightbulb",size:10})}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 italic leading-tight pt-0.5",children:R.suggestion})]})]})]},O)};return e.jsxs("div",{className:"h-full flex flex-col gap-2 md:gap-4 animate-fade-in-up",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-1",ref:w,children:[!t&&!i&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 opacity-60",children:[e.jsx("div",{className:"p-6 bg-slate-100 dark:bg-slate-800 rounded-full mb-4 animate-pulse-slow",children:e.jsx(f,{name:"Wand2",size:48,className:"text-indigo-300 dark:text-indigo-600"})}),e.jsx("p",{className:"font-bold",children:"No analysis results yet."}),e.jsx("p",{className:"text-xs mt-2",children:"Run analysis from the Audit tab to generate findings."})]}),i&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"relative w-28 h-28 mb-8",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-indigo-100 dark:border-indigo-900/50 rounded-full opacity-50"}),e.jsx("div",{className:"absolute inset-0 border-t-4 border-indigo-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-4 border-r-4 border-purple-500 rounded-full animate-spin-reverse opacity-70"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(f,{name:"BrainCircuit",size:32,className:"text-indigo-500 animate-pulse"})})]}),e.jsx("h3",{className:"text-2xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-purple-500 animate-pulse mb-3",children:"AI Auditor Working"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium mb-1 bg-white/50 dark:bg-slate-800/50 px-4 py-1 rounded-full shadow-sm",children:n}),e.jsx("p",{className:"text-xs text-slate-400 font-mono mt-2 opacity-80",children:l&&`Analyzing Clause: [${l}]`})]}),t&&(u==="list"?e.jsx("div",{className:"space-y-4 pb-10",children:t.map((R,O)=>se(R,O))}):e.jsxs("div",{className:"flex flex-col h-full gap-4",children:[e.jsxs("div",{className:`flex-shrink-0 flex flex-col bg-white dark:bg-slate-900 rounded-2xl border ${W.borderClass.replace("border-","border-opacity-30 border-")} border-t-4 border-t-${W.borderClass.replace("border-","")} dark:border-slate-800 overflow-hidden shadow-depth transition-all duration-300 ease-in-out ${_?"h-11 min-h-[44px]":"h-auto max-h-[45vh]"}`,children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/50 dark:bg-slate-900/50 border-b border-gray-50 dark:border-slate-800 cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-800",onClick:()=>Z(!_),children:[e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(f,{name:"Grid",size:12})," Findings Matrix (",Object.keys(D).length," Processes)"]}),e.jsx("div",{className:"text-slate-400 hover:text-indigo-500 transition-colors",children:e.jsx(f,{name:_?"ChevronDown":"ChevronUp",size:16})})]}),e.jsxs("div",{className:`flex flex-col transition-opacity duration-200 ${_?"opacity-0 pointer-events-none":"opacity-100"}`,children:[e.jsxs("div",{className:`grid grid-cols-[80px_1fr_1fr_1fr_1fr] gap-1 p-3 border-b border-gray-100 dark:border-slate-800 ${W.bgSoft} sticky top-0 z-10 transition-colors duration-500 ease-fluid`,children:[e.jsx("div",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest text-center",children:"Clause"}),e.jsx("div",{className:"text-[10px] font-bold text-red-500 uppercase tracking-widest text-center",children:"Major"}),e.jsx("div",{className:"text-[10px] font-bold text-orange-500 uppercase tracking-widest text-center",children:"Minor"}),e.jsx("div",{className:"text-[10px] font-bold text-blue-500 uppercase tracking-widest text-center",children:"OFI"}),e.jsx("div",{className:"text-[10px] font-bold text-emerald-500 uppercase tracking-widest text-center",children:"Comp"})]}),e.jsx("div",{className:"overflow-y-auto custom-scrollbar max-h-[40vh] p-2",children:Object.entries(D).map(([R,O])=>{const V=L.has(R),v=O,S=v.filter(I=>I.finding.status==="NC_MAJOR"||I.finding.status==="NC_MINOR").length;return e.jsxs("div",{className:"flex flex-col mb-2 rounded-xl border border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-900/50 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white dark:bg-slate-900 cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-800 transition-colors",onClick:()=>F(R),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{name:"ChevronDown",size:14,className:`text-slate-400 transition-transform duration-300 ${V?"-rotate-90":""}`}),e.jsx("span",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-300 uppercase tracking-wide truncate max-w-[200px]",title:R,children:R}),e.jsxs("span",{className:"text-[10px] text-slate-400 font-normal",children:["(",v.length,")"]})]}),S>0&&e.jsxs("span",{className:"text-[9px] font-bold text-red-500 bg-red-50 dark:bg-red-900/20 px-2 py-0.5 rounded shadow-sm",children:[S," NCs"]})]}),!V&&e.jsx("div",{className:"max-h-[240px] overflow-y-auto custom-scrollbar divide-y divide-gray-100 dark:divide-slate-800/50 border-t border-gray-100 dark:border-slate-800",children:v.map(({finding:I,originalIndex:P})=>{const M=d===P;return e.jsxs("div",{onClick:()=>x(P),className:`grid grid-cols-[80px_1fr_1fr_1fr_1fr] gap-1 py-2 cursor-pointer transition-colors ${M?"bg-indigo-50 dark:bg-indigo-900/20":"hover:bg-slate-100 dark:hover:bg-slate-800/80"}`,children:[e.jsx("div",{className:`flex items-center justify-center h-full w-full text-[10px] font-mono font-bold ${M?"text-indigo-600 dark:text-indigo-400":"text-slate-500 dark:text-slate-400"}`,children:I.clauseId}),e.jsx("div",{className:"flex items-center justify-center h-full w-full",children:I.status==="NC_MAJOR"&&e.jsx("div",{className:"w-4 h-4 rounded bg-red-500 shadow-md ring-2 ring-white dark:ring-slate-900",title:"Major NC"})}),e.jsx("div",{className:"flex items-center justify-center h-full w-full",children:I.status==="NC_MINOR"&&e.jsx("div",{className:"w-4 h-4 rounded bg-orange-500 shadow-md ring-2 ring-white dark:ring-slate-900",title:"Minor NC"})}),e.jsx("div",{className:"flex items-center justify-center h-full w-full",children:I.status==="OFI"&&e.jsx("div",{className:"w-4 h-4 rounded bg-blue-500 shadow-md ring-2 ring-white dark:ring-slate-900",title:"Opportunity for Improvement"})}),e.jsx("div",{className:"flex items-center justify-center h-full w-full",children:I.status==="COMPLIANT"&&e.jsx("div",{className:"w-4 h-4 rounded bg-emerald-500 shadow-md ring-2 ring-white dark:ring-slate-900",title:"Compliant"})})]},P)})})]},R)})})]})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto custom-scrollbar bg-slate-50/50 dark:bg-slate-900/50 rounded-2xl border border-gray-100 dark:border-slate-800 p-2 shadow-inner",children:t[d]?se(t[d],d,!0):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 italic text-xs",children:"Select a row above to view details"})})]}))]}),e.jsxs("div",{className:"flex-shrink-0 flex flex-row items-center md:justify-end gap-2 md:gap-3 w-full pt-2",children:[e.jsxs("div",{className:"flex-1 md:flex-none md:w-auto h-[52px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 rounded-xl p-1 flex items-center shadow-sm min-w-0 dark:shadow-md",children:[e.jsxs("button",{onClick:()=>o("list"),className:`flex-1 md:flex-none md:w-auto h-full px-4 rounded-lg flex items-center justify-center gap-2 transition-all whitespace-nowrap ${u==="list"?"bg-indigo-500 text-white shadow-md":"text-slate-400 hover:text-slate-600 hover:bg-gray-50 dark:hover:bg-slate-800"}`,title:"List View",children:[e.jsx(f,{name:"LayoutList",size:18}),e.jsx("span",{className:"hidden md:inline text-xs font-bold",children:"List"})]}),e.jsxs("button",{onClick:()=>o("matrix"),className:`flex-1 md:flex-none md:w-auto h-full px-4 rounded-lg flex items-center justify-center gap-2 transition-all whitespace-nowrap ${u==="matrix"?"bg-indigo-500 text-white shadow-md":"text-slate-400 hover:text-slate-600 hover:bg-gray-50 dark:hover:bg-slate-800"}`,title:"Matrix View",children:[e.jsx(f,{name:"Grid",size:18}),e.jsx("span",{className:"hidden md:inline text-xs font-bold",children:"Matrix"})]})]}),t&&e.jsxs("button",{onClick:U,className:`flex-none md:w-auto px-4 h-[52px] border rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all duration-300 active:scale-95 shadow-sm whitespace-nowrap dark:shadow-md ${q?"bg-indigo-50 border-indigo-200 text-indigo-600 dark:bg-indigo-900/20 dark:border-indigo-800 dark:text-indigo-400":"bg-white dark:bg-slate-900 border-gray-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 hover:bg-gray-50"}`,children:[e.jsx(f,{name:q?"CheckSquare":"Square",size:18}),e.jsx("span",{className:"hidden lg:inline",children:q?"Deselect All":"Select All"})]}),e.jsxs("button",{onClick:()=>h("notes",k),disabled:!t,className:"flex-none md:w-auto px-6 h-[52px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 hover:border-indigo-500 text-slate-700 dark:text-slate-200 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all duration-300 active:scale-95 shadow-sm disabled:opacity-50 whitespace-nowrap dark:shadow-md hover:shadow-lg",children:[e.jsx(f,{name:"Download"}),e.jsx("span",{className:"hidden md:inline",children:"Export Findings"}),e.jsxs("div",{className:"lang-pill-container",children:[e.jsx("span",{onClick:R=>{R.stopPropagation(),g("en")},className:`lang-pill-btn ${k==="en"?"lang-pill-active":"lang-pill-inactive"}`,children:"EN"}),e.jsx("span",{onClick:R=>{R.stopPropagation(),g("vi")},className:`lang-pill-btn ${k==="vi"?"lang-pill-active":"lang-pill-inactive"}`,children:"VI"})]})]})]})]})},Js=({finalReportText:t,setFinalReportText:s,isReportLoading:r,loadingMessage:a,templateFileName:i,isTemplateProcessing:n=!1,handleTemplateUpload:l,handleGenerateReport:u,isReadyToSynthesize:o,onExport:d,exportLanguage:x,setExportLanguage:h,analysisResult:k,generationLogs:g=[],progressPercent:w=0,selectedFindings:j})=>{const y=ue.find(E=>E.id==="report"),{showToast:C}=de(),[p,m]=c.useState("text"),N=c.useRef(null);c.useEffect(()=>{r&&N.current&&N.current.scrollIntoView({behavior:"smooth"})},[g,r]);const A=(E,_)=>{Le(E),C(`${_} copied!`)},L=k&&j?k.filter(E=>j[E.clauseId]):[];return e.jsxs("div",{className:"h-full flex flex-col gap-2 md:gap-4 animate-fade-in-up",children:[e.jsx("div",{className:"flex items-center justify-between px-2",children:e.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>m("smart_copy"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${p==="smart_copy"?"bg-white dark:bg-slate-700 shadow-sm text-indigo-600 dark:text-white":"text-slate-500"}`,children:"Smart Copy Dashboard"}),e.jsx("button",{onClick:()=>m("text"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${p==="text"?"bg-white dark:bg-slate-700 shadow-sm text-indigo-600 dark:text-white":"text-slate-500"}`,children:"Raw Text Editor"})]})}),e.jsxs("div",{className:`flex-1 bg-white dark:bg-slate-900 rounded-3xl shadow-sm border ${y.borderClass.replace("border-","border-opacity-30 border-")} border-t-4 border-t-${y.borderClass.replace("border-","")} dark:border-transparent overflow-hidden flex flex-col dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05),0_4px_6px_-1px_rgba(0,0,0,0.5)] transition-colors duration-500 ease-fluid relative`,children:[r&&e.jsx("div",{className:"absolute inset-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur-md z-50 flex flex-col items-center justify-center p-8 animate-in fade-in duration-300",children:e.jsxs("div",{className:"w-full max-w-lg space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-indigo-100 dark:border-slate-700 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-t-4 border-indigo-600 rounded-full animate-spin"}),e.jsx(f,{name:"Wand2",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-indigo-500",size:24})]}),e.jsx("h3",{className:"text-xl font-black text-slate-800 dark:text-white animate-pulse",children:a}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mt-1",children:[w,"% Complete"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300 ease-out",style:{width:`${w}%`}})}),e.jsxs("div",{className:"w-full h-40 bg-black/5 dark:bg-black/30 rounded-xl border border-gray-200 dark:border-slate-800 p-4 font-mono text-xs overflow-y-auto custom-scrollbar shadow-inner",children:[g.map((E,_)=>e.jsxs("div",{className:"mb-1 text-slate-600 dark:text-slate-400 flex gap-2",children:[e.jsx("span",{className:"text-indigo-400 select-none",children:">"}),e.jsx("span",{children:E})]},_)),e.jsx("div",{ref:N})]})]})}),p==="text"&&e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{className:"w-full h-full p-4 resize-none bg-transparent focus:outline-none text-slate-700 dark:text-slate-300 text-sm leading-relaxed font-mono custom-scrollbar",value:t||"",onChange:E=>s(E.target.value),placeholder:"The final synthesized audit report will appear here..."}),!t&&!r&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none opacity-40",children:[e.jsx(f,{name:"FileText",size:48,className:"text-slate-300 dark:text-slate-600 mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Ready to generate report"})]})]}),p==="smart_copy"&&e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 bg-gray-50/50 dark:bg-slate-950/50",children:L.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-50",children:[e.jsx(f,{name:"LayoutList",size:48,className:"text-slate-300 mb-2"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"No selected findings available for staging."})]}):e.jsx("div",{className:"space-y-4",children:L.map((E,_)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-gray-200 dark:border-slate-800 shadow-sm p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 pb-2 border-b border-gray-100 dark:border-slate-800",children:[e.jsx("span",{className:"font-mono font-black text-xs bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-slate-600 dark:text-slate-300",children:E.clauseId}),e.jsx("span",{className:`text-[10px] font-bold uppercase px-2 py-0.5 rounded-full ${E.status==="COMPLIANT"?"bg-emerald-100 text-emerald-700":"bg-orange-100 text-orange-700"}`,children:E.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1 group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Evidence"}),e.jsx("button",{onClick:()=>A(E.evidence,"Evidence"),className:"p-1 rounded hover:bg-indigo-50 text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(f,{name:"Copy",size:12})})]}),e.jsx("div",{className:"p-2 bg-gray-50 dark:bg-slate-950 rounded text-xs text-slate-700 dark:text-slate-300 h-20 overflow-y-auto border border-transparent group-hover:border-indigo-200 transition-colors whitespace-pre-wrap font-mono",children:E.evidence})]}),e.jsxs("div",{className:"space-y-1 group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Conclusion / Finding"}),e.jsx("button",{onClick:()=>A(E.reason,"Finding"),className:"p-1 rounded hover:bg-indigo-50 text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(f,{name:"Copy",size:12})})]}),e.jsx("div",{className:"p-2 bg-gray-50 dark:bg-slate-950 rounded text-xs text-slate-700 dark:text-slate-300 h-20 overflow-y-auto border border-transparent group-hover:border-indigo-200 transition-colors",children:E.reason})]})]})]},_))})})]}),e.jsxs("div",{className:"flex-shrink-0 flex flex-row items-center md:justify-end gap-2 md:gap-3 w-full pt-2",children:[e.jsxs("label",{className:`flex-none md:w-auto px-4 h-[52px] border rounded-xl text-xs font-bold flex items-center justify-center gap-2 cursor-pointer transition-all duration-300 active:scale-95 shadow-sm group whitespace-nowrap dark:shadow-md ${i?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-700 dark:text-emerald-400":"bg-white dark:bg-slate-900 border-gray-200 dark:border-slate-700 hover:border-indigo-500 text-slate-700 dark:text-slate-200"}`,title:i||"Upload Template",children:[n?e.jsx(f,{name:"Loader",size:20,className:"animate-spin text-indigo-500"}):e.jsx(f,{name:i?"CheckCircle2":"UploadCloud",size:20,className:i?"text-emerald-500":""}),e.jsx("span",{className:"hidden lg:inline",children:n?"Processing...":i?"Template Loaded":"Upload Template"}),e.jsx("input",{type:"file",accept:".txt,.docx",className:"hidden",onChange:l,disabled:n})]}),e.jsxs("button",{onClick:u,disabled:!o||r,className:`flex-1 md:flex-none md:w-auto md:px-6 h-[52px] rounded-xl font-bold transition-all duration-300 flex items-center justify-center gap-2 shadow-lg whitespace-nowrap ${o&&!r?"btn-shrimp text-white active:scale-95 border-indigo-700 hover:shadow-indigo-500/40":"bg-gray-200 dark:bg-slate-800 text-slate-400 dark:text-slate-600 opacity-70 cursor-not-allowed border-transparent"}`,title:"Synthesize Report",children:[r?e.jsx(f,{name:"Loader",className:"animate-spin text-white",size:20}):e.jsx(f,{name:"Wand2",size:20,className:"hidden md:block"}),e.jsx("span",{className:"inline text-xs uppercase tracking-wider",children:r?"Processing...":"Synthesize"})]}),e.jsxs("button",{onClick:()=>d("report",x),disabled:!t,className:"flex-none md:w-auto px-3 md:px-4 h-[52px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-950 hover:border-indigo-500 text-slate-700 dark:text-slate-200 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all duration-300 active:scale-95 shadow-sm disabled:opacity-50 whitespace-nowrap dark:shadow-md",children:[e.jsx(f,{name:"Download"}),e.jsx("span",{className:"hidden md:inline",children:"Export"}),e.jsxs("div",{className:"lang-pill-container",children:[e.jsx("span",{onClick:E=>{E.stopPropagation(),h("en")},className:`lang-pill-btn ${x==="en"?"lang-pill-active":"lang-pill-inactive"}`,children:"EN"}),e.jsx("span",{onClick:E=>{E.stopPropagation(),h("vi")},className:`lang-pill-btn ${x==="vi"?"lang-pill-active":"lang-pill-inactive"}`,children:"VI"})]})]})]})]})},Fe=t=>{let s=[t.id];return t.subClauses&&t.subClauses.forEach(r=>{s=[...s,...Fe(r)]}),s},Xs=c.memo(({clause:t,level:s,processes:r,isExpanded:a,onToggleDescription:i,onCopyCitation:n,onSmartToggle:l})=>{const u=c.useMemo(()=>Fe(t),[t]),o=t.subClauses&&t.subClauses.length>0;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-800/30 transition-colors group duration-300 ease-fluid",children:[e.jsx("td",{className:"p-2 border-r border-gray-100 dark:border-slate-800 sticky left-0 bg-white dark:bg-slate-900 group-hover:bg-gray-50 dark:group-hover:bg-slate-800/30 z-10 align-top transition-colors duration-300 ease-fluid",children:e.jsxs("div",{className:`flex flex-col gap-1 ${s>0?"ml-4 border-l-2 border-gray-200 dark:border-slate-800 pl-2":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold whitespace-nowrap ${s===0?"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 border border-slate-200 dark:border-slate-700":"text-slate-400"}`,children:t.code}),e.jsx("span",{className:`text-xs truncate ${s===0?"font-bold text-slate-800 dark:text-slate-200":"font-medium text-slate-600 dark:text-slate-400"}`,children:t.title})]}),s===0&&e.jsxs("div",{className:"relative group/desc pr-4",children:[e.jsx("div",{onClick:()=>i(t.id),className:`text-[10px] text-slate-500 dark:text-slate-400 mt-1 cursor-pointer hover:text-slate-800 dark:hover:text-slate-200 transition-colors font-serif italic text-left whitespace-pre-wrap leading-relaxed ${a?"":"line-clamp-3"}`,title:"Click to toggle full text",children:t.description}),e.jsx("button",{onClick:d=>{d.stopPropagation(),n(t.description)},className:"absolute top-0 right-0 opacity-0 group-hover/desc:opacity-100 transition-opacity p-1 text-slate-400 hover:text-indigo-600 bg-white/80 dark:bg-slate-900/80 rounded",title:"Copy Citation",children:e.jsx(f,{name:"Copy",size:12})})]})]})}),r.map(d=>{let x="none";if(o){const h=u.reduce((k,g)=>k+(d.matrixData[g]?1:0),0);h===u.length?x="all":h>0&&(x="some")}else x=d.matrixData[t.id]?"all":"none";return e.jsx("td",{className:"p-1 text-center border-r border-gray-50 dark:border-slate-800/50 last:border-0 relative align-middle",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>l(d.id,t),className:`w-8 h-8 rounded-lg flex items-center justify-center transition-all duration-300 ease-spring ${x==="all"?"bg-emerald-500 text-white shadow-sm shadow-emerald-500/40 transform scale-105":x==="some"?"bg-orange-100 dark:bg-orange-900/30 text-orange-500 border border-orange-200 dark:border-orange-800":"bg-slate-50 dark:bg-slate-800/50 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-300"}`,title:x==="all"?"Fully Planned":x==="some"?"Partially Planned (Click to Fill)":"Click to Plan",children:[x==="all"&&(o?e.jsx(f,{name:"CheckCircle2",size:14}):e.jsx(f,{name:"CheckThick",size:14})),x==="some"&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-orange-500"})]})})},`${d.id}_${t.id}`)})]})},(t,s)=>t.isExpanded!==s.isExpanded||t.processes.length!==s.processes.length?!1:!t.processes.some((a,i)=>{const n=s.processes[i];return a.matrixData!==n.matrixData})),Ys=()=>{const{standards:t,standardKey:s,processes:r,addProcess:a,batchUpdateProcessClauses:i,toggleProcessClause:n}=oe(),{showToast:l,setSidebarOpen:u}=de(),[o,d]=c.useState(""),[x,h]=c.useState("en"),k=c.useRef(null),g=c.useRef(null),[w,j]=c.useState(new Set),[y,C]=c.useState(new Set),p=t[s],m=ue.find(v=>v.id==="planning"),N=v=>{const S=v.toUpperCase();return S.includes("PLAN")?"bg-orange-50 hover:bg-orange-100 dark:bg-orange-900/20 dark:hover:bg-orange-900/30 text-orange-700 dark:text-orange-400 border-l-4 border-orange-500":S.includes("SUPPORT")?"bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-400 border-l-4 border-blue-500":S.includes("DO")?"bg-cyan-50 hover:bg-cyan-100 dark:bg-cyan-900/20 dark:hover:bg-cyan-900/30 text-cyan-700 dark:text-cyan-400 border-l-4 border-cyan-500":S.includes("CHECK")||S.includes("ACT")?"bg-emerald-50 hover:bg-emerald-100 dark:bg-emerald-900/20 dark:hover:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 border-l-4 border-emerald-500":S.includes("ANNEX")?"bg-purple-50 hover:bg-purple-100 dark:bg-purple-900/20 dark:hover:bg-purple-900/30 text-purple-700 dark:text-purple-400 border-l-4 border-purple-500":`${m.bgSoft} border-l-4 ${m.borderClass} ${m.textClass}`},A=c.useMemo(()=>v=>{const S=[],I=(P,M)=>{P.forEach($=>{S.push({clause:$,level:M}),$.subClauses&&I($.subClauses,M+1)})};return I(v,0),S},[]),L=c.useCallback((v,S)=>{const I=r.find($=>$.id===v);if(!I)return;const P=Fe(S);if(!(P.length>1))n(v,S.id);else if(P.reduce((z,X)=>z+(I.matrixData[X]?1:0),0)===P.length)P.forEach(z=>{I.matrixData[z]&&n(v,z)});else{const z=P.filter(X=>!I.matrixData[X]);z.length>0&&i([{processId:v,clauses:z}])}},[r,n,i]),E=(v,S,I)=>{v.stopPropagation();const P=[],M=z=>z.forEach(X=>{P.push(X.id),X.subClauses&&M(X.subClauses)});M(I);const $=r.find(z=>z.id===S);if(!$)return;if(P.every(z=>!!$.matrixData[z]))P.forEach(z=>{$.matrixData[z]&&n(S,z)});else{const z=P.filter(X=>!$.matrixData[X]);i([{processId:S,clauses:z}])}},_=v=>{j(S=>{const I=new Set(S);return I.has(v)?I.delete(v):I.add(v),I})},Z=c.useCallback(v=>{C(S=>{const I=new Set(S);return I.has(v)?I.delete(v):I.add(v),I})},[]),W=c.useCallback(v=>{Le(v),l("Citation copied!")},[l]),q=c.useMemo(()=>p?p.groups.every(v=>w.has(v.id)):!1,[p,w]),D=()=>{if(!p)return;const v=p.groups.map(S=>S.id);j(q?new Set:new Set(v))},F=c.useMemo(()=>{if(!p)return{percent:0,covered:0,total:0};let v=0;const S=P=>P.forEach(M=>{v++,M.subClauses&&S(M.subClauses)});if(p.groups.forEach(P=>S(P.clauses)),v===0)return{percent:0,covered:0,total:0};const I=new Set;return r.forEach(P=>{Object.keys(P.matrixData).forEach(M=>I.add(M))}),{percent:Math.round(I.size/v*100),covered:I.size,total:v}},[p,r]),U=24,K=2*Math.PI*U,Y=K-F.percent/100*K,Q=c.useMemo(()=>{if(!p)return[];if(!o)return p.groups;const v=o.toLowerCase();return p.groups.map(S=>{const I=S.clauses.filter(P=>{var H;const M=P.code.toLowerCase().includes(v)||P.title.toLowerCase().includes(v),$=(H=P.subClauses)==null?void 0:H.some(z=>z.code.toLowerCase().includes(v)||z.title.toLowerCase().includes(v));return M||$});return I.length>0?{...S,clauses:I}:null}).filter(S=>S!==null)},[p,o]),se=()=>{if(r.length===0){l("No processes to export.");return}const v=r.map(P=>({name:P.name,clauses:Object.keys(P.matrixData)})),S=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),I=document.createElement("a");I.href=URL.createObjectURL(S),I.download=`${we(p.name)}_Plan.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),l("JSON Template exported.")},R=()=>{if(r.length===0){l("No data to export.");return}const v={},S=$=>$.forEach(H=>{v[H.id]=H.code,H.subClauses&&S(H.subClauses)});p==null||p.groups.forEach($=>S($.clauses));let I="";x==="vi"?I+=`NGY XUT: ${new Date().toLocaleDateString("vi-VN")}
TIU CHUN: ${p.name}
====================

`:I+=`EXPORT DATE: ${new Date().toLocaleDateString()}
STANDARD: ${p.name}
====================

`,r.forEach($=>{const H=Object.keys($.matrixData).map(z=>v[z]||z).sort((z,X)=>z.localeCompare(X,void 0,{numeric:!0,sensitivity:"base"}));H.length>0&&(I+=`${x==="vi"?"QUY TRNH":"PROCESS"}: ${$.name}
`,I+=`${x==="vi"?"IU KHON":"SCOPE"}: [${H.join(", ")}]

`)});const P=new Blob([I],{type:"text/plain"}),M=document.createElement("a");M.href=URL.createObjectURL(P),M.download=`${we(p.name)}_Scope_${x}.txt`,document.body.appendChild(M),M.click(),document.body.removeChild(M),l(`TXT Scope exported (${x.toUpperCase()}).`)},O=v=>{var P;const S=(P=v.target.files)==null?void 0:P[0];if(!S)return;const I=new FileReader;I.onload=M=>{var $;try{const H=($=M.target)==null?void 0:$.result,z=JSON.parse(H);if(!Array.isArray(z))throw new Error("Invalid format");z.forEach(X=>{X.name&&a(X.name)}),l(`Imported ${z.length} processes structure.`)}catch{l("Import failed.")}},I.readAsText(S),v.target.value=""},V=()=>{u(!0),setTimeout(()=>{const v=document.getElementById("sidebar-standard-select");if(v){v.focus();try{"showPicker"in v?v.showPicker():v.click()}catch{}}},300)};return p?e.jsxs("div",{className:"h-full flex flex-col animate-fade-in-up gap-4 relative",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-2xl border border-gray-100 dark:border-slate-800 shadow-sm flex flex-col md:flex-row gap-4 items-center justify-between shrink-0 transition-colors duration-500 ease-fluid",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative w-16 h-16 flex items-center justify-center shrink-0",children:[e.jsxs("svg",{className:"transform -rotate-90 w-16 h-16",children:[e.jsx("circle",{cx:"32",cy:"32",r:U,stroke:"currentColor",strokeWidth:"6",fill:"transparent",className:"text-gray-100 dark:text-slate-800"}),e.jsx("circle",{cx:"32",cy:"32",r:U,stroke:"currentColor",strokeWidth:"6",fill:"transparent",strokeDasharray:K,strokeDashoffset:Y,className:`${m.textClass.replace("text-","text-opacity-80 ")} transition-all duration-1000 ease-out`,strokeLinecap:"round"})]}),e.jsxs("span",{className:"absolute text-xs font-black text-slate-700 dark:text-white",children:[F.percent,"%"]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:p.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[e.jsx("span",{className:`font-bold ${m.textClass}`,children:F.covered})," of ",F.total," clauses mapped."]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64 group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors",children:e.jsx(f,{name:"Search",size:16})}),e.jsx("input",{ref:g,className:"w-full pl-10 pr-8 py-2.5 bg-white dark:bg-slate-950 border border-indigo-100 dark:border-slate-700 rounded-xl text-sm font-bold text-slate-800 dark:text-slate-200 placeholder-slate-400 outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/10 transition-all shadow-sm",placeholder:"Filter clauses...",value:o,onChange:v=>d(v.target.value)}),o&&e.jsx("button",{onClick:()=>{var v;d(""),(v=g.current)==null||v.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-slate-400 hover:text-red-500 transition-colors",children:e.jsx(f,{name:"X",size:14})})]}),e.jsx("input",{type:"file",ref:k,className:"hidden",accept:".json",onChange:O}),e.jsx("button",{onClick:()=>{var v;return(v=k.current)==null?void 0:v.click()},className:"p-2.5 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl text-slate-600 dark:text-slate-300 shadow-sm active:scale-95 transition-all hover:border-indigo-300 dark:hover:border-slate-600",title:"Import Plan",children:e.jsx(f,{name:"UploadCloud",size:18})}),e.jsxs("button",{onClick:se,className:"p-2.5 px-4 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl text-slate-600 dark:text-slate-300 shadow-sm active:scale-95 transition-all hover:border-indigo-300 dark:hover:border-slate-600 flex items-center gap-2",title:"Export Template (JSON)",children:[e.jsx(f,{name:"Grid",size:18}),e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Template"})]})]})]}),e.jsx("div",{className:`flex-1 bg-white dark:bg-slate-900 rounded-2xl border ${m.borderClass.replace("border-","border-opacity-30 border-")} border-t-4 border-t-${m.borderClass.replace("border-","")} dark:border-slate-800 overflow-hidden shadow-sm relative flex flex-col transition-colors duration-500 ease-fluid`,children:r.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400",children:[e.jsx("p",{className:"mb-4",children:"No processes defined."}),e.jsx("div",{className:"p-4 border-2 border-dashed border-indigo-200 dark:border-indigo-900/50 rounded-xl bg-indigo-50 dark:bg-indigo-900/10 text-indigo-500",children:"Create processes in the sidebar to begin planning."})]}):e.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar relative",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`${m.bgSoft.replace("50","50/80")} dark:bg-slate-950 sticky top-0 z-30 shadow-sm backdrop-blur-sm transition-colors duration-500 ease-fluid`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`p-3 border-b border-r border-gray-200 dark:border-slate-800 sticky left-0 z-40 min-w-[300px] cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group select-none ${m.bgSoft}`,onClick:D,title:q?"Click to Expand All":"Click to Collapse All",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider transition-colors ${m.textClass}`,children:"Clause Reference"})})}),r.map(v=>e.jsx("th",{className:`p-3 text-[10px] font-bold uppercase tracking-wider border-b border-gray-200 dark:border-slate-800 min-w-[120px] text-center ${m.textClass}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"truncate max-w-[100px]",title:v.name,children:v.name}),e.jsx("span",{className:"text-[10px] font-bold bg-white dark:bg-slate-800 px-2 py-0.5 rounded-full shadow-sm",children:Object.keys(v.matrixData).length})]})},v.id))]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-800/50",children:Q.map(v=>{const S=w.has(v.id),I=N(v.id),P=A(v.clauses);return e.jsxs(ve.Fragment,{children:[e.jsxs("tr",{className:`sticky z-20 hover:brightness-95 transition-all duration-500 ease-fluid ${I}`,children:[e.jsx("td",{className:"p-2 border-r border-black/5 dark:border-white/5 font-black text-xs uppercase tracking-widest sticky left-0 z-20 bg-inherit shadow-sm cursor-pointer",onClick:()=>_(v.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{name:v.icon,size:14,className:"opacity-70"}),v.title]}),e.jsx(f,{name:"ChevronDown",size:14,className:`transition-transform duration-300 ${S?"-rotate-90":"rotate-0"}`})]})}),r.map(M=>{const $=[],H=re=>re.forEach(ae=>{$.push(ae.id),ae.subClauses&&H(ae.subClauses)});H(v.clauses);const z=r.find(re=>re.id===M.id),X=z?$.every(re=>!!z.matrixData[re]):!1;return e.jsx("td",{className:"p-2 text-center bg-inherit",children:!S&&e.jsx("button",{onClick:re=>E(re,M.id,v.clauses),className:"p-1.5 rounded-lg hover:bg-black/10 dark:hover:bg-white/10 transition-colors opacity-70 hover:opacity-100",title:X?"Deselect Group":"Select Entire Group",children:e.jsx(f,{name:X?"CheckSquare":"Square",size:16})})},`group_action_${M.id}_${v.id}`)})]}),!S&&P.map(({clause:M,level:$})=>e.jsx(Xs,{clause:M,level:$,processes:r,isExpanded:y.has(M.id),onToggleDescription:Z,onCopyCitation:W,onSmartToggle:L},M.id))]},v.id)})})]})})}),e.jsxs("div",{className:"flex-shrink-0 flex flex-row items-center md:justify-end gap-2 md:gap-3 w-full pt-2",children:[e.jsx("div",{className:"flex-1"}),e.jsxs("button",{onClick:R,disabled:r.length===0,className:"flex-none md:w-auto px-3 md:px-4 h-[52px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-700 hover:border-indigo-500 text-slate-700 dark:text-slate-200 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all duration-300 active:scale-95 shadow-sm disabled:opacity-50 whitespace-nowrap dark:shadow-md",children:[e.jsx(f,{name:"FileText"}),e.jsx("span",{className:"hidden md:inline",children:"Export"}),e.jsxs("div",{className:"lang-pill-container",children:[e.jsx("span",{onClick:v=>{v.stopPropagation(),h("en")},className:`lang-pill-btn ${x==="en"?"lang-pill-active":"lang-pill-inactive"}`,children:"EN"}),e.jsx("span",{onClick:v=>{v.stopPropagation(),h("vi")},className:`lang-pill-btn ${x==="vi"?"lang-pill-active":"lang-pill-inactive"}`,children:"VI"})]})]})]})]}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 bg-gray-50/30 dark:bg-slate-900/30 rounded-2xl border border-dashed border-gray-200 dark:border-slate-800 m-4 animate-fade-in-up",children:[e.jsx(f,{name:"Book",size:48,className:"mb-4 opacity-20"}),e.jsx("p",{className:"font-bold text-slate-500",children:"No Standard Selected"}),e.jsxs("button",{onClick:V,className:"mt-6 px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg text-xs font-bold flex items-center gap-2",children:[e.jsx(f,{name:"LayoutList",size:16})," Select Standard"]})]})},Zs=({isOpen:t,onClose:s,clause:r,standardName:a,fullText:i,isLoading:n,onInsert:l})=>{const[u,o]=c.useState("en"),[d,x]=c.useState(!1),[h,k]=c.useState(""),g=u==="en"?i.en:i.vi,w=c.useMemo(()=>{if(!a)return{text:"ISO",colorClass:"bg-gray-100 text-gray-600"};const C=a.match(/\((.*?)\)/),p=C?C[1]:a.split(" ")[0]||"ISO",m=p.toUpperCase();let N="bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 border-indigo-100 dark:border-indigo-800/50";return m.includes("EMS")||m.includes("14001")?N="bg-emerald-100 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300 border-emerald-200 dark:border-emerald-700/50":m.includes("QMS")||m.includes("9001")?N="bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-700/50":(m.includes("ISMS")||m.includes("27001"))&&(N="bg-purple-100 dark:bg-purple-900/40 text-purple-700 dark:text-purple-300 border-purple-200 dark:border-purple-700/50"),{text:p,colorClass:N}},[a]);c.useEffect(()=>{if(!t){k("");return}if(n||!g){k("");return}const C=g.split(`
`);let p=0,m="";const N=setTimeout(()=>{const A=setInterval(()=>{p<C.length?(m+=(C[p]||"")+`
`,k(m),p++):clearInterval(A)},20);return()=>clearInterval(A)},50);return()=>clearTimeout(N)},[t,g,n]);const j=()=>{l(g)},y=()=>{Le(g),x(!0),setTimeout(()=>x(!1),2e3)};return e.jsx(Ce,{isOpen:t,title:"Clause Reference",onClose:s,children:e.jsxs("div",{className:"flex flex-col h-full gap-3",children:[r&&e.jsxs("div",{className:"flex items-start gap-3 pb-2 border-b border-gray-100 dark:border-slate-800",children:[e.jsx("span",{className:"text-sm font-black text-indigo-700 dark:text-indigo-400 uppercase bg-indigo-50 dark:bg-indigo-900/30 px-2 py-1 rounded-lg border border-indigo-100 dark:border-indigo-800 shrink-0",children:r.code}),e.jsx("h4",{className:"text-sm font-bold text-slate-800 dark:text-white leading-tight mt-1",children:r.title})]}),n?e.jsxs("div",{className:"h-64 flex flex-col items-center justify-center text-slate-500 gap-4",children:[e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("div",{className:"absolute inset-0 border-2 border-indigo-200 dark:border-indigo-800 rounded-full opacity-20"}),e.jsx("div",{className:"absolute inset-0 border-t-2 border-indigo-600 rounded-full animate-spin"})]}),e.jsx("span",{className:"text-sm font-bold animate-pulse",children:"Consulting Gemini AI Auditor..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full border shadow-sm uppercase tracking-wider ${w.colorClass}`,children:w.text}),e.jsxs("div",{className:"lang-pill-container shadow-sm border-gray-200 dark:border-slate-700",children:[e.jsx("span",{onClick:()=>o("en"),className:`lang-pill-btn ${u==="en"?"lang-pill-active":"lang-pill-inactive"}`,children:"EN"}),e.jsx("span",{onClick:()=>o("vi"),className:`lang-pill-btn ${u==="vi"?"lang-pill-active":"lang-pill-inactive"}`,children:"VI"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx("button",{onClick:y,disabled:d,className:`p-2 rounded-xl transition-all hover:scale-110 active:scale-95 disabled:opacity-70 border shadow-sm ${d?"text-emerald-600 border-emerald-200 bg-emerald-50 dark:bg-emerald-900/20":"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 hover:text-indigo-600"}`,title:d?"Copied!":"Copy to Clipboard",children:e.jsx(f,{name:d?"CheckThick":"Copy",size:16})}),e.jsx("button",{onClick:j,className:"p-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg shadow-indigo-500/20 transition-all hover:scale-110 active:scale-95",title:"Insert Reference into Evidence",children:e.jsx(f,{name:"Quote",size:16})})]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto custom-scrollbar bg-gray-50/50 dark:bg-slate-950/50 rounded-2xl border border-gray-100 dark:border-slate-800 relative shadow-inner text-left",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsxs("p",{className:"text-xs md:text-sm text-slate-800 dark:text-slate-200 whitespace-pre-wrap leading-7 font-medium tracking-wide",children:[h,!n&&h!==g&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-indigo-500 animate-pulse ml-1 align-middle"})]})})})]})]})})},Qs=({isOpen:t,onClose:s,apiKeys:r,newKeyInput:a,setNewKeyInput:i,handleAddKey:n,activeKeyId:l,editingKeyId:u,editLabelInput:o,setEditLabelInput:d,handleSaveLabel:x,handleStartEdit:h,handleDeleteKey:k})=>{const[g,w]=c.useState("keys"),[j,y]=c.useState("ANALYSIS"),[C,p]=c.useState("");c.useEffect(()=>{t&&g==="prompts"&&p(ye.getPrompt(j).template)},[t,g,j]);const m=()=>{ye.updatePrompt(j,C);const A=document.getElementById("save-prompt-btn");A&&(A.innerText="Saved!",setTimeout(()=>A.innerText="Save Prompt",1e3))},N=()=>{ye.resetToDefault(j),p(ye.getPrompt(j).template)};return e.jsxs(Ce,{isOpen:t,title:"Settings & Configuration",onClose:s,children:[e.jsxs("div",{className:"flex gap-2 mb-4 border-b border-gray-100 dark:border-slate-800 pb-2",children:[e.jsx("button",{onClick:()=>w("keys"),className:`px-4 py-2 text-xs font-bold rounded-lg transition-colors ${g==="keys"?"bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300":"text-slate-500 hover:bg-gray-50 dark:hover:bg-slate-800"}`,children:"API Keys"}),e.jsx("button",{onClick:()=>w("prompts"),className:`px-4 py-2 text-xs font-bold rounded-lg transition-colors ${g==="prompts"?"bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300":"text-slate-500 hover:bg-gray-50 dark:hover:bg-slate-800"}`,children:"AI Prompts"})]}),g==="keys"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-gray-100 dark:border-slate-700 dark:shadow-inner",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-3",children:"Google Gemini API Keys"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",name:"search_query_custom",id:"custom_search_input_x",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false","data-lpignore":"true",placeholder:"Paste API Key (AIza...)",className:"flex-1 p-2.5 bg-white dark:bg-slate-950 border border-gray-200 dark:border-slate-600 rounded-xl text-xs font-mono outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500/50 text-slate-800 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 transition-all dark:shadow-[inset_0_1px_2px_rgba(0,0,0,0.5)]",value:a,onChange:A=>i(A.target.value),onKeyDown:A=>A.key==="Enter"&&n()}),e.jsx("button",{onClick:n,className:"p-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-xs transition-colors shadow-sm min-w-[60px] flex items-center justify-center",children:"Add"})]}),e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto custom-scrollbar pr-1",children:[r.map(A=>e.jsxs("div",{className:`flex items-center justify-between p-2.5 rounded-xl border transition-all duration-200 ${A.id===l?"bg-indigo-50 border-indigo-200 dark:bg-indigo-500/20 dark:border-indigo-500/50 shadow-sm":"bg-white border-gray-100 dark:bg-slate-900 dark:border-slate-700 hover:border-indigo-300 dark:hover:border-slate-500"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${A.id===l?"bg-indigo-200 text-indigo-700 dark:bg-indigo-800 dark:text-white":"bg-gray-100 text-gray-400 dark:bg-slate-800"}`,children:e.jsx(f,{name:"Key",size:14})}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[u===A.id?e.jsx("input",{autoFocus:!0,className:"text-xs font-bold bg-white dark:bg-slate-950 text-slate-900 dark:text-white border-b-2 border-indigo-500 outline-none w-32 px-1 rounded-t",value:o,onChange:L=>d(L.target.value),onBlur:x,onKeyDown:L=>L.key==="Enter"&&x()}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{onClick:()=>h(A),className:`text-xs font-bold truncate cursor-pointer transition-colors ${A.id===l?"text-indigo-700 dark:text-indigo-200":"text-slate-700 dark:text-slate-200 hover:text-indigo-500 dark:hover:text-indigo-400"}`,children:A.label}),A.id===l&&e.jsx("span",{className:"text-[9px] bg-indigo-600 text-white px-1.5 py-0.5 rounded font-bold uppercase",children:"Active"})]}),e.jsxs("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 font-mono truncate",children:[A.key.substr(0,8),"...******"]})]})]}),e.jsx("button",{onClick:L=>{L.stopPropagation(),k(A.id)},className:"p-1.5 text-slate-400 hover:text-red-500 dark:text-slate-500 dark:hover:text-red-400 transition-colors",title:"Delete Key",children:e.jsx(f,{name:"Trash2",size:14})})]},A.id)),r.length===0&&e.jsx("div",{className:"text-center p-4 text-slate-400 text-xs italic",children:"No API Keys found. Add one above to start."})]})]}),e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/10 rounded-xl border border-yellow-100 dark:border-yellow-800/30",children:e.jsxs("p",{className:"text-[10px] text-yellow-700 dark:text-yellow-500 flex items-center gap-2",children:[e.jsx(f,{name:"Info",size:12}),"Keys are stored locally in your browser. We do not validate them until you run an analysis."]})})]}),g==="prompts"&&e.jsxs("div",{className:"flex flex-col h-[60vh]",children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{onClick:()=>y("ANALYSIS"),className:`flex-1 py-2 text-xs font-bold rounded-lg border ${j==="ANALYSIS"?"bg-indigo-100 border-indigo-200 text-indigo-800 dark:bg-indigo-900/40 dark:text-indigo-200":"border-gray-200 dark:border-slate-700 text-slate-500"}`,children:"Analysis Logic"}),e.jsx("button",{onClick:()=>y("REPORT"),className:`flex-1 py-2 text-xs font-bold rounded-lg border ${j==="REPORT"?"bg-indigo-100 border-indigo-200 text-indigo-800 dark:bg-indigo-900/40 dark:text-indigo-200":"border-gray-200 dark:border-slate-700 text-slate-500"}`,children:"Report Format"})]}),e.jsx("div",{className:"flex-1 relative border border-gray-200 dark:border-slate-700 rounded-xl overflow-hidden",children:e.jsx("textarea",{className:"w-full h-full p-4 bg-gray-50 dark:bg-slate-950 text-xs font-mono text-slate-700 dark:text-slate-300 resize-none outline-none leading-relaxed",value:C,onChange:A=>p(A.target.value)})}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsx("button",{onClick:N,className:"text-xs text-slate-400 hover:text-red-500 underline",children:"Reset to Default"}),e.jsx("button",{id:"save-prompt-btn",onClick:m,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-xs shadow-md transition-all active:scale-95",children:"Save Prompt"})]})]})]})},er=({isOpen:t,onClose:s,onAdd:r})=>{const[a,i]=c.useState(""),[n,l]=c.useState(null),u=c.useRef(null),o=()=>{a.trim()&&(r(a.trim(),n),i(""),l(null))},d=x=>{if(x.target.files&&x.target.files[0]&&(l(x.target.files[0]),!a)){const h=x.target.files[0].name;i(we(h.replace(/\.[^/.]+$/,"")).replace(/_/g," "))}};return e.jsx(Ce,{isOpen:t,title:"Define New Standard",onClose:s,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-2xl border border-indigo-100 dark:border-indigo-800",children:e.jsxs("p",{className:"text-xs text-indigo-800 dark:text-indigo-300 leading-relaxed",children:["Create a custom standard entry. For best results, ",e.jsx("strong",{children:"attach a PDF/DOCX"}),' containing the full standard text. The AI will use this as the "Ground Truth" for citations.']})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase",children:["Standard Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",autoFocus:!0,className:"w-full p-3 pl-10 bg-white dark:bg-slate-950 border border-gray-200 dark:border-slate-700 rounded-xl text-sm font-bold outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all text-slate-800 dark:text-white",placeholder:"e.g. ISO 45001:2018 (OH&S)",value:a,onChange:x=>i(x.target.value),onKeyDown:x=>x.key==="Enter"&&o()}),e.jsx("div",{className:"absolute left-3 top-3 text-slate-400",children:e.jsx(f,{name:"Book",size:18})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Source Document (Optional)"}),e.jsxs("div",{onClick:()=>{var x;return(x=u.current)==null?void 0:x.click()},className:`group relative flex items-center justify-center border-2 border-dashed rounded-xl p-6 cursor-pointer transition-all ${n?"border-emerald-400 bg-emerald-50 dark:bg-emerald-900/10":"border-gray-200 dark:border-slate-700 hover:border-indigo-400 hover:bg-gray-50 dark:hover:bg-slate-800"}`,children:[e.jsx("input",{type:"file",ref:u,className:"hidden",accept:".pdf,.docx,.txt",onChange:d}),n?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-2 shadow-sm",children:e.jsx(f,{name:"CheckThick",size:20})}),e.jsx("p",{className:"text-sm font-bold text-emerald-700 dark:text-emerald-400 truncate max-w-[250px]",children:n.name}),e.jsx("p",{className:"text-[10px] text-emerald-600/70",children:"Click to change"})]}):e.jsxs("div",{className:"text-center text-slate-400 group-hover:text-indigo-500 transition-colors",children:[e.jsx(f,{name:"UploadCloud",size:28,className:"mx-auto mb-2"}),e.jsx("p",{className:"text-xs font-bold",children:"Click to Upload PDF / DOCX"}),e.jsx("p",{className:"text-[10px] opacity-70",children:"Max 10MB"})]})]})]})]}),e.jsxs("button",{onClick:o,disabled:!a.trim(),className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-sm shadow-lg shadow-indigo-500/30 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(f,{name:"Plus",size:18}),"Create Standard"]})]})})},tr=({exportState:t,setExportState:s,rescueKey:r,setRescueKey:a,handleResumeExport:i,isRescuing:n,onClose:l,onSkip:u})=>t.isOpen?e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl border border-gray-200 dark:border-slate-800 p-6 animate-zoom-in-spring",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2 text-slate-800 dark:text-white",children:[t.isFinished?e.jsx(f,{name:"CheckCircle2",className:"text-emerald-500",size:24}):e.jsx(f,{name:"Loader",className:"animate-spin text-indigo-500",size:24}),t.isFinished?"Export Complete":"Processing Export..."]}),t.error?e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-xl border border-red-100 dark:border-red-800 mb-4 animate-shake",children:[e.jsxs("p",{className:"text-sm text-red-600 dark:text-red-400 font-bold mb-2 flex items-center gap-2",children:[e.jsx(f,{name:"AlertCircle",size:16})," Process Paused"]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 leading-relaxed font-mono bg-white/50 dark:bg-black/20 p-2 rounded border border-red-100 dark:border-red-800/50 break-words max-h-24 overflow-y-auto",children:t.error}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"password",placeholder:"Paste Emergency Google AI Key...",className:"w-full p-2 text-xs rounded-lg border border-red-200 dark:border-red-800 bg-white dark:bg-slate-950 outline-none focus:border-red-500",value:r,onChange:o=>a(o.target.value)})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:i,disabled:n||!r.trim(),className:"w-full py-2 text-xs font-bold bg-red-500 text-white rounded-lg hover:bg-red-600 flex items-center justify-center gap-2 transition-all active:scale-95 disabled:opacity-50 disabled:active:scale-100",children:[n?e.jsx(f,{name:"Loader",className:"animate-spin",size:12}):e.jsx(f,{name:"Zap",size:12}),"Use Rescue Key"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:u,className:"flex-1 py-2 text-xs font-bold bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors flex items-center justify-center gap-1",title:"Skip translation for this chunk and use original text",children:[e.jsx(f,{name:"Minus",size:12})," Skip / Use Original"]}),e.jsx("button",{onClick:()=>s(o=>({...o,isOpen:!1})),className:"px-4 py-2 text-xs font-bold text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:"Cancel"})]})]})]}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-indigo-600 bg-indigo-200 dark:text-indigo-200 dark:bg-indigo-900/50",children:t.isFinished?"Done":"Translating"})}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-indigo-600 dark:text-indigo-400",children:[Math.round(t.processedChunksCount/Math.max(t.totalChunks,1)*100),"%"]})})]}),e.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-indigo-100 dark:bg-slate-800",children:e.jsx("div",{style:{width:`${Math.round(t.processedChunksCount/Math.max(t.totalChunks,1)*100)}%`},className:`shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center transition-all duration-500 ease-out ${t.isFinished?"bg-emerald-500":"bg-indigo-500"}`})})]}),e.jsx("div",{className:"text-center space-y-1",children:t.isFinished?e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 font-bold",children:"File has been downloaded successfully."}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono",children:["Processing Chunk ",Math.min(t.processedChunksCount+1,t.totalChunks)," of ",t.totalChunks]}),e.jsxs("p",{className:"text-[10px] text-slate-400 italic",children:["Target Language: ",t.targetLang==="vi"?"Vietnamese":"English"]})]})}),t.isFinished&&e.jsx("div",{className:"flex justify-center pt-2",children:e.jsxs("button",{onClick:l,className:"px-6 py-3 bg-slate-100 hover:bg-slate-200 dark:bg-slate-800 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-xl font-bold text-sm transition-all active:scale-95 flex items-center gap-2",children:[e.jsx(f,{name:"X",size:16}),"Close Window"]})})]})]})}):null,sr=()=>{const{standardKey:t,auditInfo:s,selectedClauses:r,activeProcessId:a,processes:i,analysisResult:n,selectedFindings:l,finalReportText:u,restoreSession:o,customStandards:d}=oe(),[x,h]=c.useState(null),[k,g]=c.useState(!1),w=c.useRef(!1);return c.useEffect(()=>{try{const y=localStorage.getItem("iso_session_data"),C=localStorage.getItem("iso_custom_standards");if(y){w.current=!0;const p=JSON.parse(y);o(p),h(new Date().toLocaleTimeString()),setTimeout(()=>w.current=!1,1e3)}}catch(y){console.error("Load failed",y)}},[]),c.useEffect(()=>{if(w.current)return;const y=setTimeout(()=>{g(!0);const C={standardKey:t,auditInfo:s,selectedClauses:r,activeProcessId:a,processes:i,analysisResult:n,selectedFindings:l,finalReportText:u};localStorage.setItem("iso_session_data",JSON.stringify(C)),localStorage.setItem("iso_custom_standards",JSON.stringify(d)),h(new Date().toLocaleTimeString()),setTimeout(()=>g(!1),500)},1e3);return()=>clearTimeout(y)},[t,s,r,a,i,n,l,u,d]),{lastSavedTime:x,isSaving:k,createManualBackup:()=>{try{const y={standardKey:t,auditInfo:s,selectedClauses:r,activeProcessId:a,processes:i,analysisResult:n,selectedFindings:l,finalReportText:u},C={id:`backup_${Date.now()}`,timestamp:Date.now(),label:"Manual Backup",triggerType:"MANUAL_BACKUP",data:y},p=localStorage.getItem("iso_session_history"),m=p?JSON.parse(p):[],N=[C,...m].slice(0,5);return localStorage.setItem("iso_session_history",JSON.stringify(N)),!0}catch{return!1}}}},Pe=new Map,rr=()=>{const{standards:t,standardKey:s,matrixData:r,evidence:a,selectedClauses:i,evidenceTags:n,setAnalysisResult:l,activeProcessId:u,processes:o,privacySettings:d}=oe(),{apiKeys:x,activeKeyId:h}=ke(),{showToast:k}=de(),[g,w]=c.useState(!1),[j,y]=c.useState(""),C=c.useRef(0);return{handleAnalyze:c.useCallback(async()=>{if(!(!s||!u)){w(!0),C.current=0,k("AI Auditor: Optimizing workload...");try{const m=t[s],N=x.find(D=>D.id===h),A=new Set;if(Object.keys(r).forEach(D=>{r[D].some(F=>F.status==="supplied")&&A.add(D)}),a&&a.trim().length>20&&A.size===0&&i.forEach(D=>A.add(D)),A.size===0)throw new Error("No evidence found to analyze.");const L=D=>{const F=U=>{for(const K of U){if(K.id===D)return K;if(K.subClauses){const Y=F(K.subClauses);if(Y)return Y}}return null};for(const U of m.groups){const K=F(U.clauses);if(K)return K}return null},E=Array.from(A).map(D=>({cid:D,clause:L(D)})).filter(D=>D.clause),_=E.length,Z=async({cid:D,clause:F})=>{var v;if(!F)return null;y(`${F.code} ${F.title}`);const U=r[D]||[],K=U.filter(S=>S.status==="supplied").map(S=>`[Requirement]: ${S.requirement}
[Evidence]: ${S.evidenceInput}`).join(`

`),Y=U.filter(S=>S.status==="supplied").map(S=>S.evidenceInput).join(`

`),Q=a.length>8e3?a.substring(0,8e3)+"...(truncated)":a,se=`
                ${K?`### MATRIX EVIDENCE (Specific to ${F.code}):
${K}`:""}
                ${Q?`### GENERAL PROCESS EVIDENCE:
${Q}`:""}
                `.trim(),R=n.filter(S=>S.clauseId===D).map(S=>`Tagged Excerpt: "${S.text}"`).join(`
`),O=se+R,V=fs(`${D}_${u}_${O}_${N==null?void 0:N.activeModel}`);if(Pe.has(V))return console.log(`[Cache Hit] Clause ${D}`),C.current++,Pe.get(V);try{const S=await rt({code:F.code,title:F.title,description:F.description},m.name,se,R,N==null?void 0:N.key,N==null?void 0:N.activeModel,d.maskCompany),I=JSON.parse(S);I.processId=u;const P=(v=o.find(H=>H.id===u))==null?void 0:v.name;I.processName=P;const M=Y.trim().length>0?Y:I.evidence||"No specific evidence cited.",$={clauseId:I.clauseId||F.code,status:I.status||"N_A",reason:I.reason||"Analysis completed.",suggestion:I.suggestion||"",evidence:M,conclusion_report:I.conclusion_report||I.reason,crossRefs:I.crossRefs||[],processId:u||void 0,processName:P};return Pe.set(V,$),C.current++,C.current%2===0&&k(`Analyzing... ${Math.round(C.current/_*100)}%`),$}catch(S){return console.error(`Error analyzing ${D}`,S),null}};k(`Batch processing ${_} clauses...`);const q=(await bs(E,Z,3)).filter(D=>D!==null);q.length>0?(l(D=>{const F=D?[...D]:[];return q.forEach(U=>{const K=F.findIndex(Y=>Y.clauseId===U.clauseId&&Y.processId===U.processId);K>=0?F[K]=U:F.push(U)}),F.sort((U,K)=>U.clauseId.localeCompare(K.clauseId,void 0,{numeric:!0}))}),k(`Analysis Completed. ${q.length} findings updated.`)):k("Analysis finished but returned no valid results.")}catch(m){console.error("Analysis Workflow Error",m),k("Failed: "+m.message)}finally{w(!1),y("")}}},[s,u,r,a,i,n,x,h,o,d,t]),isAnalyzeLoading:g,currentAnalyzingClause:j}},ir=t=>{const{analysisResult:s,auditInfo:r,standards:a,standardKey:i,setFinalReportText:n,selectedFindings:l}=oe(),{apiKeys:u,activeKeyId:o}=ke(),{showToast:d}=de(),[x,h]=c.useState(!1),[k,g]=c.useState(""),[w,j]=c.useState([]),[y,C]=c.useState(0),[p,m]=c.useState(""),[N,A]=c.useState(""),[L,E]=c.useState(!1);return{isReportLoading:x,reportLoadingMessage:k,reportTemplateName:N,isTemplateProcessing:L,handleTemplateUpload:async W=>{var D;const q=(D=W.target.files)==null?void 0:D[0];if(q){E(!0),g("Processing Template...");try{const F=Date.now(),U=await ze(q);Date.now()-F<500&&await new Promise(K=>setTimeout(K,500)),m(U),A(q.name),d(`Template "${q.name}" loaded.`)}catch(F){d(`Template Error: ${F.message}`)}finally{E(!1),g("")}}},handleGenerateReport:async()=>{var q;if(!s||s.length===0){d("No findings to report.");return}const W=s.filter(D=>l[D.clauseId]);if(W.length===0){d("No findings selected. Please select at least one finding.");return}h(!0),j([]),C(0),g("Initializing Report Engine...");try{const D=u.find(O=>O.id===o),F=((q=a[i])==null?void 0:q.name)||"ISO Standard",U=D==null?void 0:D.key,K=D==null?void 0:D.activeModel,Y=[];g("Drafting Executive Summary..."),j(O=>[...O,`Analysing ${W.length} selected findings...`]);const Q=await at({company:r.company||"N/A",address:r.address||"N/A",scope:r.scope||"N/A",soa:r.soa||"N/A",type:r.type||"Internal Audit",auditor:r.auditor||"N/A",standard:F,findings:W,lang:t},U,K);Y.push(`# AUDIT REPORT: ${r.company}

## EXECUTIVE SUMMARY
${Q}
`),j(O=>[...O,"Executive Summary: Completed"]),C(10);const se=W.length;Y.push("## DETAILED FINDINGS");for(let O=0;O<se;O++){const V=W[O],v=`Clause ${V.clauseId}`;g(`Processing ${v}...`),j(P=>[...P,`Formatting ${v} (${V.status})...`]);const S=await nt(V,t,U,K);Y.push(S);const I=10+Math.round((O+1)/se*90);C(I),O%3===0&&await new Promise(P=>setTimeout(P,200))}g("Finalizing document..."),j(O=>[...O,"Stitching report sections..."]);const R=Y.join(`

`+"=".repeat(30)+`

`);n(p?`TEMPLATE APPLIED:
${p}

GENERATED CONTENT:
${R}`:R),j(O=>[...O,"Done."]),C(100),d("Report Generated Successfully.")}catch(D){console.error(D),j(F=>[...F,`ERROR: ${D.message}`]),d("Report Generation Failed.")}finally{setTimeout(()=>{h(!1),g("")},1e3)}},generationLogs:w,progressPercent:y}},ar="modulepreload",nr=function(t,s){return new URL(t,s).href},Je={},Xe=function(s,r,a){let i=Promise.resolve();if(r&&r.length>0){const l=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),o=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));i=Promise.allSettled(r.map(d=>{if(d=nr(d,a),d in Je)return;Je[d]=!0;const x=d.endsWith(".css"),h=x?'[rel="stylesheet"]':"";if(!!a)for(let w=l.length-1;w>=0;w--){const j=l[w];if(j.href===d&&(!x||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${h}`))return;const g=document.createElement("link");if(g.rel=x?"stylesheet":ar,x||(g.as="script"),g.crossOrigin="",g.href=d,o&&g.setAttribute("nonce",o),document.head.appendChild(g),x)return new Promise((w,j)=>{g.addEventListener("load",w),g.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return i.then(l=>{for(const u of l||[])u.status==="rejected"&&n(u.reason);return s().catch(n)})},or=()=>{const{evidence:t,matrixData:s,analysisResult:r,finalReportText:a,standards:i,standardKey:n,auditInfo:l,processes:u,activeProcessId:o}=oe(),{apiKeys:d,activeKeyId:x,addKey:h}=ke(),{showToast:k}=de(),[g,w]=c.useState({isOpen:!1,isPaused:!1,isFinished:!1,totalChunks:0,processedChunksCount:0,chunks:[],results:[],error:null,currentType:"report",targetLang:"en"}),[j,y]=c.useState(""),[C,p]=c.useState(!1),m=(L,E)=>{let _="";if(L==="evidence")_=`EVIDENCE DUMP
Date: ${new Date().toLocaleString()}

`,_+=`--- GENERAL EVIDENCE ---
${t}

`,_+=`--- MATRIX EVIDENCE ---
`,Object.keys(s).forEach(W=>{s[W].forEach(D=>{D.status==="supplied"&&(_+=`[Clause ${W}] ${D.requirement}
EVIDENCE: ${D.evidenceInput}
---
`)})});else if(L==="notes"){if(!r)return k("No findings.");_=r.map(W=>`[${W.clauseId}] ${W.status}
Observation: ${W.reason}
Evidence: ${W.evidence}
`).join(`
----------------------------------------

`)}else if(L==="report"){if(!a)return k("No report text.");_=a}if(!_.trim())return k("Nothing to export.");const Z=_.match(/[\s\S]{1,3000}/g)||[];w({isOpen:!0,isPaused:!1,isFinished:!1,totalChunks:Z.length,processedChunksCount:0,chunks:Z,results:[],error:null,currentType:L,targetLang:E})};return c.useEffect(()=>{(async()=>{var E;if(g.isOpen&&!g.isPaused&&!g.isFinished){const _=g.processedChunksCount;if(_>=g.totalChunks){const W=g.results.join(""),q=((E=i[n])==null?void 0:E.name)||"ISO";let D="ISO";q.includes("27001")?D="27k":q.includes("9001")?D="9k":q.includes("14001")&&(D="14k");const F=u.find(v=>v.id===o),U=F?F.name:"General";let K="Document";g.currentType==="notes"?K="Audit_Note":g.currentType==="evidence"?K="Evidence":g.currentType==="report"&&(K="Report");const Y=new Date,Q=`${Y.getFullYear()}${String(Y.getMonth()+1).padStart(2,"0")}${String(Y.getDate()).padStart(2,"0")}`,R=`${[D,we(l.company||"Company"),we(U),K,Q].filter(v=>v&&v!=="N_A").join("_")}_${g.targetLang}.txt`,O=new Blob([W],{type:"text/plain"}),V=document.createElement("a");V.href=URL.createObjectURL(O),V.download=R,document.body.appendChild(V),V.click(),document.body.removeChild(V),w(v=>({...v,isFinished:!0}));return}const Z=g.chunks[_];try{const W=d.find(U=>U.id===x);await new Promise(U=>setTimeout(U,200));const q=j||(W==null?void 0:W.key),{translateChunk:D}=await Xe(async()=>{const{translateChunk:U}=await Promise.resolve().then(()=>He);return{translateChunk:U}},void 0,import.meta.url),F=await D(Z,g.targetLang,q);w(U=>({...U,results:[...U.results,F],processedChunksCount:U.processedChunksCount+1}))}catch(W){w(q=>({...q,isPaused:!0,error:W.message||"Translation failed."}))}}})()},[g,x,j,d]),{handleExport:m,exportState:g,setExportState:w,rescueKey:j,setRescueKey:y,handleResumeExport:async()=>{p(!0);const{validateApiKey:L}=await Xe(async()=>{const{validateApiKey:_}=await Promise.resolve().then(()=>He);return{validateApiKey:_}},void 0,import.meta.url);(await L(j)).isValid?(await h(j,"Rescue Key"),w(_=>({..._,isPaused:!1,error:null})),y("")):k("Rescue Key Invalid."),p(!1)},isRescuing:C,handleSkipExportChunk:()=>{w(L=>({...L,results:[...L.results,L.chunks[L.processedChunksCount]],processedChunksCount:L.processedChunksCount+1,isPaused:!1,error:null}))}}},lr=()=>{var Ue;const[t,s]=c.useState("planning"),{isSidebarOpen:r,sidebarWidth:a,showToast:i,modals:n,toggleModal:l,setSidebarOpen:u}=de(),{evidence:o,setEvidence:d,matrixData:x,setMatrixData:h,evidenceTags:k,addEvidenceTag:g,selectedClauses:w,standards:j,standardKey:y,auditInfo:C,setKnowledgeData:p,analysisResult:m,setAnalysisResult:N,selectedFindings:A,setSelectedFindings:L,finalReportText:E,setFinalReportText:_,resetSession:Z,restoreSession:W,addCustomStandard:q,setStandardKey:D,activeProcessId:F,processes:U,privacySettings:K}=oe(),{apiKeys:Y,addKey:Q,deleteKey:se,refreshKeyStatus:R,activeKeyId:O,isCheckingKey:V,isAutoCheckEnabled:v,toggleAutoCheck:S}=ke(),{lastSavedTime:I,isSaving:P,createManualBackup:M}=sr(),[$,H]=c.useState([]),[z,X]=c.useState({isOpen:!1,clause:null,fullText:{en:"",vi:""},isLoading:!1}),[re,ae]=c.useState(""),[Ne,T]=c.useState("list"),[b,B]=c.useState(0),[G,J]=c.useState("en"),[ee,ie]=c.useState("en"),[ne,fe]=c.useState("en"),{handleAnalyze:je,isAnalyzeLoading:Se,currentAnalyzingClause:xt}=rr(),{isReportLoading:pt,reportLoadingMessage:ht,reportTemplateName:gt,isTemplateProcessing:mt,handleTemplateUpload:ft,handleGenerateReport:bt,generationLogs:vt,progressPercent:kt}=ir(ne),{handleExport:Me,exportState:jt,setExportState:Be,rescueKey:yt,setRescueKey:wt,handleResumeExport:Nt,isRescuing:Ct,handleSkipExportChunk:St}=or();c.useEffect(()=>{const te=ce=>X({isOpen:!0,clause:ce.detail,fullText:{en:"",vi:""},isLoading:!0}),le=ce=>X(Pt=>({...Pt,fullText:ce.detail,isLoading:!1})),be=ce=>{ce.detail&&s(ce.detail)};return window.addEventListener("OPEN_REFERENCE",te),window.addEventListener("UPDATE_REFERENCE_CONTENT",le),window.addEventListener("SWITCH_LAYOUT",be),()=>{window.removeEventListener("OPEN_REFERENCE",te),window.removeEventListener("UPDATE_REFERENCE_CONTENT",le),window.removeEventListener("SWITCH_LAYOUT",be)}},[]);const At=c.useMemo(()=>{const te=ue.find(le=>le.id===t);return te?`${te.colorClass} ${te.borderClass}`:"bg-slate-500 border-slate-600"},[t]),Et=c.useMemo(()=>{switch(t){case"planning":return"selection:bg-orange-200 selection:text-orange-900 dark:selection:bg-orange-900 dark:selection:text-orange-100 bg-orange-50/80 dark:bg-orange-950/20";case"evidence":return"selection:bg-blue-200 selection:text-blue-900 dark:selection:bg-blue-900 dark:selection:text-blue-100 bg-blue-50/80 dark:bg-blue-950/20";case"findings":return"selection:bg-purple-200 selection:text-purple-900 dark:selection:bg-purple-900 dark:selection:text-purple-100 bg-purple-50/80 dark:bg-purple-950/20";case"report":return"selection:bg-emerald-200 selection:text-emerald-900 dark:selection:bg-emerald-900 dark:selection:text-emerald-100 bg-emerald-50/80 dark:bg-emerald-950/20";default:return"selection:bg-indigo-200 selection:text-indigo-900"}},[t]),It=ue.find(te=>te.id===t)||ue[0],Lt=(!F||U.length===0)&&t!=="planning",Mt=async()=>{const te=await Q(re);te==="valid"?(ae(""),i("Success: API Key is Active")):te==="quota_exceeded"?(ae(""),i("Added: Key Quota Exhausted")):i(te==="duplicate"?"Info: Key already exists":"Failed: Invalid API Key or Network Error")},Tt=c.useMemo(()=>{if(!y||!F||Se)return!1;const te=Object.values(x).some(be=>be.some(ce=>ce.status==="supplied")),le=o&&o.trim().length>10;return te||le},[y,F,x,o,Se]),Rt=async()=>{s("findings"),await je()};return e.jsxs(zs,{commandActions:[],onRestoreSnapshot:W,children:[e.jsxs("div",{className:`flex-shrink-0 px-4 md:px-6 py-3 border-b border-gray-200 dark:border-slate-800 transition-colors duration-500 ease-fluid flex justify-between items-center gap-3 border-t-4 ${It.borderClass} ${At.split(" ")[0].replace("bg-","bg-opacity-10 ")}`,children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx(Fs,{layoutMode:t,setLayoutMode:s,isSidebarOpen:r,sidebarWidth:a})}),e.jsxs("div",{className:"flex gap-2 items-center flex-shrink-0 pl-2 border-l border-gray-200 dark:border-slate-800",children:[e.jsxs("button",{onClick:()=>l("recall",!0),className:`h-10 px-4 rounded-xl flex items-center justify-center gap-2 transition-all border ${I?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600":"bg-white dark:bg-slate-800 text-slate-500"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{name:"History",size:18}),I&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-2.5 w-2.5",children:e.jsx("span",{className:`relative inline-flex rounded-full h-2.5 w-2.5 ${P?"bg-red-500":"bg-emerald-500"}`})})]}),e.jsx("span",{className:"hidden xl:inline text-xs font-bold",children:"Recall"})]}),e.jsxs("button",{onClick:()=>{confirm("Start New Session?")&&(M(),Z(),i("Session Reset."))},className:"h-10 px-4 bg-amber-50 dark:bg-amber-950/30 text-amber-600 border border-amber-200 rounded-xl flex items-center justify-center gap-2 hover:bg-amber-100 transition-all",children:[e.jsx(f,{name:"Session4_FilePlus",size:18}),e.jsx("span",{className:"hidden md:inline text-xs font-bold",children:"New"})]})]})]}),e.jsxs("div",{className:`flex-1 overflow-hidden relative p-2 md:p-4 transition-colors duration-500 ease-fluid ${Et}`,children:[Lt&&e.jsx("div",{className:"absolute inset-0 z-50 bg-white/80 dark:bg-slate-950/80 backdrop-blur-sm flex flex-col items-center justify-center animate-in fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-8 rounded-3xl shadow-2xl border border-indigo-100 dark:border-indigo-900 max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-indigo-100 dark:bg-indigo-900/50 rounded-full flex items-center justify-center mx-auto mb-4 text-indigo-600",children:e.jsx(f,{name:"Session11_GridAdd",size:32})}),e.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white mb-2",children:"Process Required"}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6 leading-relaxed",children:["Define at least one ",e.jsx("strong",{children:"Process"})," to begin evidence collection."]}),e.jsx("div",{className:"flex gap-3 justify-center",children:e.jsx("button",{onClick:()=>s("planning"),className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-transform active:scale-95",children:"Go to Planning"})})]})}),t==="planning"&&e.jsx(Ys,{}),t==="evidence"&&e.jsx(qs,{evidence:o,setEvidence:d,uploadedFiles:$,setUploadedFiles:H,onOcrProcess:()=>{},isOcrLoading:!1,onAnalyze:Rt,isReadyForAnalysis:Tt,isAnalyzeLoading:Se,analyzeTooltip:"Run AI Analysis",onExport:Me,evidenceLanguage:G,setEvidenceLanguage:J,textareaRef:{current:null},tags:k,onAddTag:g,selectedClauses:w,standards:j,standardKey:y,matrixData:x,setMatrixData:h}),t==="findings"&&e.jsx(Hs,{analysisResult:m,setAnalysisResult:N,selectedFindings:A,setSelectedFindings:L,isAnalyzeLoading:Se,loadingMessage:"Synthesizing findings...",currentAnalyzingClause:xt,viewMode:Ne,setViewMode:T,focusedFindingIndex:b,setFocusedFindingIndex:B,onExport:Me,notesLanguage:ee,setNotesLanguage:ie}),t==="report"&&e.jsx(Js,{finalReportText:E,setFinalReportText:_,isReportLoading:pt,loadingMessage:ht,templateFileName:gt,isTemplateProcessing:mt,handleTemplateUpload:ft,handleGenerateReport:bt,isReadyToSynthesize:!!m&&m.length>0,onExport:Me,exportLanguage:ne,setExportLanguage:fe,analysisResult:m,generationLogs:vt,progressPercent:kt,selectedFindings:A})]}),e.jsx(Qs,{isOpen:n.settings,onClose:()=>l("settings",!1),apiKeys:Y,newKeyInput:re,setNewKeyInput:ae,isCheckingKey:V,handleAddKey:Mt,activeKeyId:O,editingKeyId:null,editLabelInput:"",setEditLabelInput:()=>{},handleSaveLabel:()=>{},handleStartEdit:()=>{},handleRefreshStatus:R,handleDeleteKey:se,isAutoCheckEnabled:v,toggleAutoCheck:S}),e.jsx(er,{isOpen:n.addStandard,onClose:()=>l("addStandard",!1),onAdd:async(te,le)=>{l("addStandard",!1);const be=`CUSTOM_${Date.now()}`;if(le){const ce=await ze(le);p(ce,le.name)}q(be,{name:te,description:"Custom",groups:[]}),D(be)}}),e.jsx(Zs,{isOpen:z.isOpen,onClose:()=>X(te=>({...te,isOpen:!1})),clause:z.clause,standardName:((Ue=j[y])==null?void 0:Ue.name)||"",fullText:z.fullText,isLoading:z.isLoading,onInsert:te=>d(le=>le+`
`+te)}),e.jsx(tr,{exportState:jt,setExportState:Be,rescueKey:yt,setRescueKey:wt,handleResumeExport:Nt,isRescuing:Ct,onClose:()=>Be(te=>({...te,isOpen:!1})),onSkip:St})]})};function dr(){return e.jsx(rs,{children:e.jsx(is,{children:e.jsx(ss,{children:e.jsx(lr,{})})})})}const ut=document.getElementById("root");if(!ut)throw new Error("Could not find root element to mount to");const cr=Ot.createRoot(ut);cr.render(e.jsx(ve.StrictMode,{children:e.jsx(dr,{})}));
