import{r as x,j as e}from"./vendor-react--UE8qFvL.js";import{T as $,d as I,I as s,c as E}from"./index-Cbv7HqSR.js";import"./vendor-BhE6lIor.js";import"./vendor-genai-C0GBL7S7.js";const M=({finalReportText:o,setFinalReportText:N,isReportLoading:t,loadingMessage:k,templateFileName:l,isTemplateProcessing:n=!1,handleTemplateUpload:y,handleGenerateReport:C,isReadyToSynthesize:m,onExport:z,exportLanguage:i,setExportLanguage:p,analysisResult:b,generationLogs:h=[],progressPercent:u=0,selectedFindings:g})=>{const f=$.find(a=>a.id==="report"),{showToast:_}=I(),[d,j]=x.useState("text"),c=x.useRef(null);x.useEffect(()=>{t&&c.current&&c.current.scrollIntoView({behavior:"smooth"})},[h,t]);const v=(a,r)=>{E(a),_(`${r} copied!`)},w=b&&g?b.filter(a=>g[a.clauseId]):[];return e.jsxs("div",{className:"h-full flex flex-col gap-2 md:gap-4 animate-fade-in-up",children:[e.jsx("div",{className:"flex items-center justify-between px-2",children:e.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>j("smart_copy"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${d==="smart_copy"?"bg-white dark:bg-slate-700 shadow-sm text-indigo-600 dark:text-white":"text-slate-500"}`,children:"Smart Copy Dashboard"}),e.jsx("button",{onClick:()=>j("text"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${d==="text"?"bg-white dark:bg-slate-700 shadow-sm text-indigo-600 dark:text-white":"text-slate-500"}`,children:"Raw Text Editor"})]})}),e.jsxs("div",{className:`flex-1 bg-white dark:bg-slate-900 rounded-3xl shadow-sm border ${f.borderClass.replace("border-","border-opacity-30 border-")} border-t-4 border-t-${f.borderClass.replace("border-","")} dark:border-transparent overflow-hidden flex flex-col dark:shadow-[0_0_0_1px_rgba(255,255,255,0.05),0_4px_6px_-1px_rgba(0,0,0,0.5)] transition-colors duration-500 ease-fluid relative`,children:[t&&e.jsx("div",{className:"absolute inset-0 bg-white/95 dark:bg-slate-900/95 backdrop-blur-md z-50 flex flex-col items-center justify-center p-8 animate-in fade-in duration-300",children:e.jsxs("div",{className:"w-full max-w-lg space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-indigo-100 dark:border-slate-700 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-t-4 border-indigo-600 rounded-full animate-spin"}),e.jsx(s,{name:"Wand2",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-indigo-500",size:24})]}),e.jsx("h3",{className:"text-xl font-black text-slate-800 dark:text-white animate-pulse",children:k}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mt-1",children:[u,"% Complete"]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-300 ease-out",style:{width:`${u}%`}})}),e.jsxs("div",{className:"w-full h-40 bg-black/5 dark:bg-black/30 rounded-xl border border-gray-200 dark:border-slate-800 p-4 font-mono text-xs overflow-y-auto custom-scrollbar shadow-inner",children:[h.map((a,r)=>e.jsxs("div",{className:"mb-1 text-slate-600 dark:text-slate-400 flex gap-2",children:[e.jsx("span",{className:"text-indigo-400 select-none",children:">"}),e.jsx("span",{children:a})]},r)),e.jsx("div",{ref:c})]})]})}),d==="text"&&e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("textarea",{className:"w-full h-full p-4 resize-none bg-transparent focus:outline-none text-slate-700 dark:text-slate-300 text-base leading-relaxed font-mono custom-scrollbar",value:o||"",onChange:a=>N(a.target.value),placeholder:"The final synthesized audit report will appear here..."}),!o&&!t&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none opacity-40",children:[e.jsx(s,{name:"FileText",size:48,className:"text-slate-300 dark:text-slate-600 mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Ready to generate report"})]})]}),d==="smart_copy"&&e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 bg-gray-50/50 dark:bg-slate-950/50",children:w.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-50",children:[e.jsx(s,{name:"LayoutList",size:48,className:"text-slate-300 mb-2"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"No selected findings available for staging."})]}):e.jsx("div",{className:"space-y-4",children:w.map((a,r)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-gray-200 dark:border-slate-800 shadow-sm p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3 pb-2 border-b border-gray-100 dark:border-slate-800",children:[e.jsx("span",{className:"font-mono font-black text-xs bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-slate-600 dark:text-slate-300",children:a.clauseId}),e.jsx("span",{className:`text-[10px] font-bold uppercase px-2 py-0.5 rounded-full ${a.status==="COMPLIANT"?"bg-emerald-100 text-emerald-700":"bg-orange-100 text-orange-700"}`,children:a.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1 group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Evidence"}),e.jsx("button",{onClick:()=>v(a.evidence,"Evidence"),className:"p-1 rounded hover:bg-indigo-50 text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(s,{name:"Copy",size:12})})]}),e.jsx("div",{className:"p-2 bg-gray-50 dark:bg-slate-950 rounded text-xs text-slate-700 dark:text-slate-300 h-20 overflow-y-auto border border-transparent group-hover:border-indigo-200 transition-colors whitespace-pre-wrap font-mono",children:a.evidence})]}),e.jsxs("div",{className:"space-y-1 group",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Conclusion / Finding"}),e.jsx("button",{onClick:()=>v(a.reason,"Finding"),className:"p-1 rounded hover:bg-indigo-50 text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(s,{name:"Copy",size:12})})]}),e.jsx("div",{className:"p-2 bg-gray-50 dark:bg-slate-950 rounded text-xs text-slate-700 dark:text-slate-300 h-20 overflow-y-auto border border-transparent group-hover:border-indigo-200 transition-colors",children:a.reason})]})]})]},r))})})]}),e.jsxs("div",{className:"flex-shrink-0 flex flex-row items-center md:justify-end gap-2 md:gap-3 w-full pt-2",children:[e.jsxs("label",{className:`flex-none md:w-auto px-4 h-[52px] border rounded-xl text-xs font-bold flex items-center justify-center gap-2 cursor-pointer transition-all duration-300 active:scale-95 shadow-sm group whitespace-nowrap dark:shadow-md ${l?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-700 dark:text-emerald-400":"bg-white dark:bg-slate-900 border-gray-200 dark:border-slate-700 hover:border-indigo-500 text-slate-700 dark:text-slate-200"}`,title:l||"Upload Template",children:[n?e.jsx(s,{name:"Loader",size:20,className:"animate-spin text-indigo-500"}):e.jsx(s,{name:l?"CheckCircle2":"UploadCloud",size:20,className:l?"text-emerald-500":""}),e.jsx("span",{className:"hidden lg:inline",children:n?"Processing...":l?"Template Loaded":"Upload Template"}),e.jsx("input",{type:"file",accept:".txt,.docx",className:"hidden",onChange:y,disabled:n})]}),e.jsxs("button",{onClick:C,disabled:!m||t,className:`flex-1 md:flex-none md:w-auto md:px-6 h-[52px] rounded-xl font-bold transition-all duration-300 flex items-center justify-center gap-2 shadow-lg whitespace-nowrap ${m&&!t?"btn-shrimp text-white active:scale-95 border-indigo-700 hover:shadow-indigo-500/40":"bg-gray-200 dark:bg-slate-800 text-slate-400 dark:text-slate-600 opacity-70 cursor-not-allowed border-transparent"}`,title:"Synthesize Report",children:[t?e.jsx(s,{name:"Loader",className:"animate-spin text-white",size:20}):e.jsx(s,{name:"Wand2",size:20,className:"hidden md:block"}),e.jsx("span",{className:"inline text-xs uppercase tracking-wider",children:t?"Processing...":"Synthesize"})]}),e.jsxs("button",{onClick:()=>z("report",i),disabled:!o,className:"flex-none md:w-auto px-3 md:px-4 h-[52px] bg-white dark:bg-slate-900 border border-gray-200 dark:border-slate-950 hover:border-indigo-500 text-slate-700 dark:text-slate-200 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all duration-300 active:scale-95 shadow-sm disabled:opacity-50 whitespace-nowrap dark:shadow-md",children:[e.jsx(s,{name:"Download"}),e.jsx("span",{className:"hidden md:inline",children:"Export"}),e.jsxs("div",{className:"lang-pill-container",children:[e.jsx("span",{onClick:a=>{a.stopPropagation(),p("en")},className:`lang-pill-btn ${i==="en"?"lang-pill-active":"lang-pill-inactive"}`,children:"EN"}),e.jsx("span",{onClick:a=>{a.stopPropagation(),p("vi")},className:`lang-pill-btn ${i==="vi"?"lang-pill-active":"lang-pill-inactive"}`,children:"VI"})]})]})]})]})};export{M as ReportView};
